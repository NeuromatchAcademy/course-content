
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tutorial 2: Wilson-Cowan Model &#8212; Neuromatch Computational Neuroscience</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Outro Video" href="../outro_vid.html" />
    <link rel="prev" title="Tutorial 1: Neural Rate Models" href="W2D4_Tutorial1.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      <img src="../../../_static/nma-logo-square-4xp.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Neuromatch Computational Neuroscience</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../intro.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Pre-reqs Refresher
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W0D1_PythonWorkshop1/intro_text.html">
   Python Workshop 1 (W0D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W0D1_PythonWorkshop1/student/W0D1_Tutorial1.html">
     Tutorial: LIF Neuron - Part I
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W0D2_PythonWorkshop2/intro_text.html">
   Python Workshop 2 (W0D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W0D2_PythonWorkshop2/student/W0D2_Tutorial1.html">
     Tutorial 1: LIF Neuron Part II
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W0D3_LinearAlgebra/intro_text.html">
   Linear Algebra (W0D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W0D3_LinearAlgebra/student/W0D3_Tutorial1.html">
     Tutorial 1: Vectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W0D3_LinearAlgebra/student/W0D3_Tutorial2.html">
     Tutorial 2: Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W0D3_LinearAlgebra/student/W0D3_Tutorial3.html">
     Bonus Tutorial: Discrete Dynamical Systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W0D4_Calculus/intro_text.html">
   Calculus (W0D4)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W0D4_Calculus/student/W0D4_Tutorial1.html">
     Tutorial 1: Basics of Differential and Integral Calculus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W0D4_Calculus/student/W0D4_Tutorial2.html">
     Tutorial 2: Differential Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W0D4_Calculus/student/W0D4_Tutorial3.html">
     Tutorial 3: Numerical Methods
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W0D5_Statistics/intro_text.html">
   Statistics (W0D5)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W0D5_Statistics/student/W0D5_Tutorial1.html">
     Neuromatch Academy: Precourse Week, Day 5, Tutorial 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W0D5_Statistics/student/W0D5_Tutorial2.html">
     Tutorial 2: Statistical Inference
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Intro to Modeling
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D1_ModelTypes/intro_text.html">
   Model Types (W1D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D1_ModelTypes/intro_vid.html">
     Intro Video
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D1_ModelTypes/student/W1D1_Tutorial1.html">
     Tutorial 1: “What” models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D1_ModelTypes/student/W1D1_Tutorial2.html">
     Tutorial 2: “How” models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D1_ModelTypes/student/W1D1_Tutorial3.html">
     Tutorial 3: “Why” models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D1_ModelTypes/outro_vid.html">
     Outro Video
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D2_ModelingPractice/intro_text.html">
   Modeling Practice (W1D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D2_ModelingPractice/intro_vid.html">
     Intro Video
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D2_ModelingPractice/student/W1D2_Tutorial1.html">
     Tutorial: Framing the Question
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D2_ModelingPractice/outro_vid.html">
     Outro Video
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D3_ModelFitting/intro_text.html">
   Model Fitting (W1D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_ModelFitting/intro_vid.html">
     Intro Video
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial1.html">
     Tutorial 1: Linear regression with MSE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial2.html">
     Tutorial 2: Linear regression with MLE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial3.html">
     Tutorial 3: Confidence intervals and bootstrapping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial4.html">
     Tutorial 4: Multiple linear regression and polynomial regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial5.html">
     Tutorial 5: Model Selection: Bias-variance trade-off
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial6.html">
     Tutorial 6: Model Selection: Cross-validation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_ModelFitting/outro_vid.html">
     Outro Video
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D4_MachineLearning/intro_text.html">
   Machine Learning (W1D4)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D4_MachineLearning/intro_vid.html">
     Intro Video
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D4_MachineLearning/student/W1D4_Tutorial1.html">
     Tutorial 1: GLMs for Encoding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D4_MachineLearning/student/W1D4_Tutorial2.html">
     Tutorial 2: Classifiers and regularizers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D4_MachineLearning/outro_vid.html">
     Outro Video
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D5_DimensionalityReduction/intro_text.html">
   Dimensionality Reduction (W1D5)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D5_DimensionalityReduction/intro_vid.html">
     Intro Video
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D5_DimensionalityReduction/student/W1D5_Tutorial1.html">
     Tutorial 1: Geometric view of data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D5_DimensionalityReduction/student/W1D5_Tutorial2.html">
     Tutorial 2: Principal Component Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D5_DimensionalityReduction/student/W1D5_Tutorial3.html">
     Tutorial 3: Dimensionality Reduction &amp; Reconstruction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D5_DimensionalityReduction/student/W1D5_Tutorial4.html">
     Tutorial 4:  Nonlinear Dimensionality Reduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D5_DimensionalityReduction/outro_vid.html">
     Outro Video
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D1_DeepLearning/intro_text.html">
   Deep Learning (W2D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D1_DeepLearning/intro_vid.html">
     Intro Video
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D1_DeepLearning/student/W2D1_Tutorial1.html">
     Tutorial 1: Decoding Neural Responses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D1_DeepLearning/student/W2D1_Tutorial2.html">
     Tutorial 2: Convolutional Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D1_DeepLearning/student/W2D1_Tutorial3.html">
     Tutorial 2: Building and Evaluating Normative Encoding Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D1_DeepLearning/outro_vid.html">
     Outro Video
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Dynamical Systems
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D2_LinearSystems/intro_text.html">
   Linear Systems (W2D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_LinearSystems/intro_vid.html">
     Intro Video
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_LinearSystems/student/W2D2_Tutorial1.html">
     Tutorial 1: Linear dynamical systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_LinearSystems/student/W2D2_Tutorial2.html">
     Tutorial 2: Markov Processes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_LinearSystems/student/W2D2_Tutorial3.html">
     Tutorial 3: Combining determinism and stochasticity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_LinearSystems/student/W2D2_Tutorial4.html">
     Tutorial 4: Autoregressive models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_LinearSystems/outro_vid.html">
     Outro Video
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D3_RealNeurons/intro_text.html">
   Real Neurons (W2D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D3_RealNeurons/intro_vid.html">
     Intro Video
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D3_RealNeurons/student/W2D3_Tutorial1.html">
     Tutorial 1: The Leaky Integrate-and-Fire (LIF) Neuron Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D3_RealNeurons/student/W2D3_Tutorial2.html">
     Tutorial 2: Effects of Input Correlation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D3_RealNeurons/student/W2D3_Tutorial3.html">
     Tutorial 3: Synaptic transmission - Models of static and dynamic synapses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D3_RealNeurons/student/W2D3_Tutorial4.html">
     Tutorial 4: Spike-timing dependent plasticity (STDP)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D3_RealNeurons/outro_vid.html">
     Outro Video
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../intro_text.html">
   Dynamic Networks (W2D4)
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_vid.html">
     Intro Video
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="W2D4_Tutorial1.html">
     Tutorial 1: Neural Rate Models
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Tutorial 2: Wilson-Cowan Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../outro_vid.html">
     Outro Video
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Stochastic Processes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D1_BayesianDecisions/intro_text.html">
   Bayesian Decisions (W3D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_BayesianDecisions/intro_vid.html">
     Intro Video
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_BayesianDecisions/student/W3D1_Tutorial1.html">
     Tutorial 1: Bayes with a binary hidden state
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_BayesianDecisions/student/W3D1_Tutorial2.html">
     Tutorial 2: Bayesian inference and decisions with continuous hidden state
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_BayesianDecisions/student/W3D1_Tutorial3.html">
     Bonus Tutorial:Fitting to data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_BayesianDecisions/outro_vid.html">
     Outro Video
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D2_HiddenDynamics/intro_text.html">
   Hidden Dynamics (W3D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D2_HiddenDynamics/intro_vid.html">
     Intro Video
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D2_HiddenDynamics/student/W3D2_Tutorial1.html">
     Tutorial 1: Sequential Probability Ratio Test
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D2_HiddenDynamics/student/W3D2_Tutorial2.html">
     Tutorial 2: Hidden Markov Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D2_HiddenDynamics/student/W3D2_Tutorial3.html">
     Tutorial 3: 1D Kalman Filter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D2_HiddenDynamics/student/W3D2_Tutorial4.html">
     Tutorial 4: 2D Kalman Filter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D2_HiddenDynamics/outro_vid.html">
     Outro Video
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D3_OptimalControl/intro_text.html">
   Optimal Control (W3D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D3_OptimalControl/intro_vid.html">
     Intro Video
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D3_OptimalControl/student/W3D3_Tutorial1.html">
     Tutorial 1: Optimal Control for Discrete States
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D3_OptimalControl/student/W3D3_Tutorial2.html">
     Tutorial 2: Optimal Control for Continuous State
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D3_OptimalControl/outro_vid.html">
     Outro Video
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D4_ReinforcementLearning/intro_text.html">
   Reinforcement Learning (W3D4)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D4_ReinforcementLearning/intro_vid.html">
     Intro Video
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D4_ReinforcementLearning/student/W3D4_Tutorial1.html">
     Tutorial 1: Learning to Predict
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D4_ReinforcementLearning/student/W3D4_Tutorial2.html">
     Tutorial 2: Learning to Act: Multi-Armed Bandits
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D4_ReinforcementLearning/student/W3D4_Tutorial3.html">
     Tutorial 3: Learning to Act: Q-Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D4_ReinforcementLearning/student/W3D4_Tutorial4.html">
     Tutorial 4: From Reinforcement Learning to Planning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D4_ReinforcementLearning/outro_vid.html">
     Outro Video
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D5_NetworkCausality/intro_text.html">
   Network Causality (W3D5)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_NetworkCausality/intro_vid.html">
     Intro Video
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_NetworkCausality/student/W3D5_Tutorial1.html">
     Tutorial 1: Interventions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_NetworkCausality/student/W3D5_Tutorial2.html">
     Tutorial 2: Correlations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_NetworkCausality/student/W3D5_Tutorial3.html">
     Tutorial 3: Simultaneous fitting/regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_NetworkCausality/student/W3D5_Tutorial4.html">
     Tutorial 4: Instrumental Variables
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_NetworkCausality/outro_vid.html">
     Outro Video
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/tutorials/W2D4_DynamicNetworks/student/W2D4_Tutorial2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/NeuromatchAcademy/course_content/blob/master/book/tutorials/W2D4_DynamicNetworks/student/W2D4_Tutorial2.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Tutorial 2: Wilson-Cowan Model
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-1-wilson-cowan-model-of-excitatory-and-inhibitory-populations">
   Section 1: Wilson-Cowan model of excitatory and inhibitory populations
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-1-1-mathematical-description-of-the-wc-model">
     Section 1.1: Mathematical description of the WC model
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise-1-plot-out-the-f-i-curves-for-the-e-and-i-populations">
       Exercise 1: Plot out the F-I curves for the E and I populations
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-1-2-simulation-scheme-for-the-wilson-cowan-model">
     Section 1.2: Simulation scheme for the Wilson-Cowan model
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise-2-numerically-integrate-the-wilson-cowan-equations">
       Exercise 2: Numerically integrate the Wilson-Cowan equations
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#interactive-demo-population-trajectories-with-different-initial-values">
       Interactive Demo: population trajectories with different initial values
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#think">
     Think!
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-2-phase-plane-analysis">
   Section 2: Phase plane analysis
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interactive-demo-from-the-activity-time-plane-to-the-r-i-r-e-phase-plane">
     Interactive Demo: From the Activity - time plane to the
     <strong>
      <span class="math notranslate nohighlight">
       \(r_I\)
      </span>
      -
      <span class="math notranslate nohighlight">
       \(r_E\)
      </span>
     </strong>
     phase plane
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-2-1-nullclines-of-the-wilson-cowan-equations">
     Section 2.1: Nullclines of the Wilson-Cowan Equations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise-3-compute-the-nullclines-of-the-wilson-cowan-model">
       Exercise 3: Compute the nullclines of the Wilson-Cowan model
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-2-2-vector-field">
     Section 2.2: Vector field
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise-4-compute-and-plot-the-vector-field-displaystyle-big-frac-dr-e-dt-frac-dr-i-dt-big">
       Exercise 4: Compute and plot the vector field
       <span class="math notranslate nohighlight">
        \(\displaystyle{\Big{(}\frac{dr_E}{dt}, \frac{dr_I}{dt} \Big{)}}\)
       </span>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Think!
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bonus-1-fixed-points-stability-analysis-and-limit-cycles-in-the-wilson-cowan-model">
   Bonus 1: Fixed points, stability analysis, and limit cycles in the Wilson-Cowan model
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fixed-points-of-the-e-i-system">
     Fixed Points of the E/I system
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise-5-find-the-fixed-points-of-the-wilson-cowan-model">
       Exercise 5: Find the fixed points of the Wilson-Cowan model
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stability-of-a-fixed-point-and-eigenvalues-of-the-jacobian-matrix">
     Stability of a fixed point and eigenvalues of the Jacobian Matrix
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise-6-compute-the-jacobian-matrix-for-the-wilson-cowan-model">
       Exercise 6: Compute the Jacobian Matrix for the Wilson-Cowan model
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#effect-of-wee-on-the-nullclines-and-the-eigenvalues">
     Effect of
     <code class="docutils literal notranslate">
      <span class="pre">
       wEE
      </span>
     </code>
     on the nullclines and the eigenvalues
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interactive-demo-nullclines-position-in-the-phase-plane-changes-with-parameter-values">
     Interactive Demo: Nullclines position in the phase plane changes with parameter values
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#limit-cycle-oscillations">
     Limit cycle - Oscillations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise-7-plot-the-phase-plane">
       Exercise 7: Plot the phase plane
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interactive-demo-limit-cycle-and-oscillations">
     Interactive Demo: Limit cycle and oscillations.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bonus-2-inhibition-stabilized-network-isn">
   Bonus 2: Inhibition-stabilized network (ISN)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-8-compute-displaystyle-frac-partial-g-e-partial-r-e">
     Exercise 8: Compute
     <span class="math notranslate nohighlight">
      \(\displaystyle{\frac{\partial G_E}{\partial r_E}}\)
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nullcline-analysis-of-the-isn">
     Nullcline analysis of the ISN
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interactive-demo-nullclines-of-example-isn-and-non-isn">
     Interactive Demo: Nullclines of Example
     <strong>
      ISN
     </strong>
     and
     <strong>
      non-ISN
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bonus-3-fixed-point-and-working-memory">
   Bonus 3: Fixed point and working memory
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interactive-demo-short-pulse-induced-persistent-activity">
     Interactive Demo: Short pulse induced persistent activity
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p><a href="https://colab.research.google.com/github/NeuromatchAcademy/course-content/blob/master/tutorials/W2D4_DynamicNetworks/student/W2D4_Tutorial2.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<div class="section" id="tutorial-2-wilson-cowan-model">
<h1>Tutorial 2: Wilson-Cowan Model<a class="headerlink" href="#tutorial-2-wilson-cowan-model" title="Permalink to this headline">¶</a></h1>
<p><strong>Week 2, Day 4: Dynamic Networks</strong></p>
<p><strong>By Neuromatch Academy</strong></p>
<p><strong>Content creators:</strong> Qinglong Gu, Songtin Li, Arvind Kumar, John Murray, Julijana Gjorgjieva</p>
<p><strong>Content reviewers:</strong> Maryam Vaziri-Pashkam, Ella Batty, Lorenzo Fontolan, Richard Gao, Spiros Chavlis, Michael Waskom</p>
</div>
<hr class="docutils" />
<div class="section" id="tutorial-objectives">
<h1>Tutorial Objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this headline">¶</a></h1>
<p>In the previous tutorial, you became familiar with a neuronal network consisting of only an excitatory population. Here, we extend the approach we used to include both excitatory and inhibitory neuronal populations in our network. A simple, yet powerful model to study the dynamics of two interacting populations of excitatory and inhibitory neurons, is the so-called <strong>Wilson-Cowan</strong> rate model, which will be the subject of this tutorial.</p>
<p>The objectives of this tutorial are to:</p>
<ul class="simple">
<li><p>Write the <strong>Wilson-Cowan</strong> equations for the firing rate dynamics of a 2D system composed of an excitatory (E) and an inhibitory (I) population of neurons</p></li>
<li><p>Simulate the dynamics of the system, i.e., Wilson-Cowan model.</p></li>
<li><p>Plot the frequency-current (F-I) curves for both populations (i.e., E and I).</p></li>
<li><p>Visualize and inspect the behavior of the system using <strong>phase plane analysis</strong>, <strong>vector fields</strong>, and <strong>nullclines</strong>.</p></li>
</ul>
<p>Bonus steps:</p>
<ul class="simple">
<li><p>Find and plot the <strong>fixed points</strong> of the Wilson-Cowan model.</p></li>
<li><p>Investigate the stability of the Wilson-Cowan model by linearizing its dynamics and examining the <strong>Jacobian matrix</strong>.</p></li>
<li><p>Learn how the Wilson-Cowan model can reach an oscillatory state.</p></li>
</ul>
<p>Bonus steps (applications):</p>
<ul class="simple">
<li><p>Visualize the behavior of an Inhibition-stabilized network.</p></li>
<li><p>Simulate working memory using the Wilson-Cowan model.</p></li>
</ul>
<p>\
Reference paper:</p>
<p><em><a class="reference external" href="https://doi.org/10.1016/S0006-3495(72)86068-5">Wilson H and Cowan J (1972) Excitatory and inhibitory interactions in localized populations of model neurons. Biophysical Journal 12</a></em></p>
</div>
<hr class="docutils" />
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">opt</span>       <span class="c1"># root-finding algorithm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Figure Settings</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>       <span class="c1"># interactive display</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/nma.mplstyle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper functions</span>


<span class="k">def</span> <span class="nf">default_pars</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
  <span class="n">pars</span> <span class="o">=</span> <span class="p">{}</span>

  <span class="c1"># Excitatory parameters</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;tau_E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>     <span class="c1"># Timescale of the E population [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;a_E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.2</span>      <span class="c1"># Gain of the E population</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;theta_E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.8</span>  <span class="c1"># Threshold of the E population</span>

  <span class="c1"># Inhibitory parameters</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;tau_I&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span>    <span class="c1"># Timescale of the I population [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;a_I&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>      <span class="c1"># Gain of the I population</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;theta_I&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.0</span>  <span class="c1"># Threshold of the I population</span>

  <span class="c1"># Connection strength</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wEE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">9.</span>   <span class="c1"># E to E</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wEI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.</span>   <span class="c1"># I to E</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wIE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">13.</span>  <span class="c1"># E to I</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wII&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">11.</span>  <span class="c1"># I to I</span>

  <span class="c1"># External input</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;I_ext_E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;I_ext_I&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>

  <span class="c1"># simulation parameters</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">50.</span>        <span class="c1"># Total duration of simulation [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">.1</span>        <span class="c1"># Simulation time step [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rE_init&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># Initial value of E</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rI_init&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># Initial value of I</span>

  <span class="c1"># External parameters if any</span>
  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
      <span class="n">pars</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

  <span class="c1"># Vector of discretized time points [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">])</span>

  <span class="k">return</span> <span class="n">pars</span>


<span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Population activation function, F-I curve</span>

<span class="sd">  Args:</span>
<span class="sd">    x     : the population input</span>
<span class="sd">    a     : the gain of the function</span>
<span class="sd">    theta : the threshold of the function</span>

<span class="sd">  Returns:</span>
<span class="sd">    f     : the population activation response f(x) for input x</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="c1"># add the expression of f = F(x)</span>
  <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)))</span><span class="o">**-</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">theta</span><span class="p">))</span><span class="o">**-</span><span class="mi">1</span>

  <span class="k">return</span> <span class="n">f</span>


<span class="k">def</span> <span class="nf">dF</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Derivative of the population activation function.</span>

<span class="sd">  Args:</span>
<span class="sd">    x     : the population input</span>
<span class="sd">    a     : the gain of the function</span>
<span class="sd">    theta : the threshold of the function</span>

<span class="sd">  Returns:</span>
<span class="sd">    dFdx  :  Derivative of the population activation function.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="n">dFdx</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">theta</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)))</span><span class="o">**-</span><span class="mi">2</span>

  <span class="k">return</span> <span class="n">dFdx</span>


<span class="k">def</span> <span class="nf">plot_FI_inverse</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
  <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">F_inv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="n">theta</span><span class="p">))</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$F^{-1}(x)$&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_FI_EI</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">FI_exc</span><span class="p">,</span> <span class="n">FI_inh</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">FI_exc</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E population&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">FI_inh</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I population&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x (a.u.)&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;F(x)&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">my_test_plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">rE1</span><span class="p">,</span> <span class="n">rI1</span><span class="p">,</span> <span class="n">rE2</span><span class="p">,</span> <span class="n">rI2</span><span class="p">):</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rE1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E population&#39;</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rI1</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I population&#39;</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Activity&#39;</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

  <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rE2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E population&#39;</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rI2</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I population&#39;</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t (ms)&#39;</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Activity&#39;</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">plot_nullclines</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="n">Exc_null_rI</span><span class="p">,</span> <span class="n">Inh_null_rE</span><span class="p">,</span> <span class="n">Inh_null_rI</span><span class="p">):</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="n">Exc_null_rI</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E nullcline&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Inh_null_rE</span><span class="p">,</span> <span class="n">Inh_null_rI</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I nullcline&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_E$&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_I$&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">my_plot_nullcline</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
  <span class="n">Exc_null_rE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
  <span class="n">Exc_null_rI</span> <span class="o">=</span> <span class="n">get_E_nullcline</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
  <span class="n">Inh_null_rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">.01</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
  <span class="n">Inh_null_rE</span> <span class="o">=</span> <span class="n">get_I_nullcline</span><span class="p">(</span><span class="n">Inh_null_rI</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="n">Exc_null_rI</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E nullcline&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Inh_null_rE</span><span class="p">,</span> <span class="n">Inh_null_rI</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I nullcline&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_E$&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_I$&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">my_plot_vector</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">my_n_skip</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">myscale</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
  <span class="n">EI_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">EI_grid</span><span class="p">,</span> <span class="n">EI_grid</span><span class="p">)</span>
  <span class="n">drEdt</span><span class="p">,</span> <span class="n">drIdt</span> <span class="o">=</span> <span class="n">EIderivs</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">rI</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">n_skip</span> <span class="o">=</span> <span class="n">my_n_skip</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">rE</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span> <span class="n">rI</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span>
             <span class="n">drEdt</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span> <span class="n">drIdt</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span>
             <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">myscale</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_E$&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_I$&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">my_plot_trajectory</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mycolor</span><span class="p">,</span> <span class="n">x_init</span><span class="p">,</span> <span class="n">mylabel</span><span class="p">):</span>
  <span class="n">pars</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rE_init&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rI_init&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_init</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_init</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">rE_tj</span><span class="p">,</span> <span class="n">rI_tj</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rE_tj</span><span class="p">,</span> <span class="n">rI_tj</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">mycolor</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">mylabel</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_init</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_init</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">mycolor</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_E$&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_I$&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">my_plot_trajectories</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">mylabel</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Solve for I along the E_grid from dE/dt = 0.</span>

<span class="sd">  Expects:</span>
<span class="sd">  pars    : Parameter dictionary</span>
<span class="sd">  dx      : increment of initial values</span>
<span class="sd">  n       : n*n trjectories</span>
<span class="sd">  mylabel : label for legend</span>

<span class="sd">  Returns:</span>
<span class="sd">    figure of trajectory</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">pars</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">ie</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
      <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rE_init&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rI_init&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">ie</span><span class="p">,</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">ii</span>
      <span class="n">rE_tj</span><span class="p">,</span> <span class="n">rI_tj</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ie</span> <span class="o">==</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ii</span> <span class="o">==</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
          <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rE_tj</span><span class="p">,</span> <span class="n">rI_tj</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">mylabel</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rE_tj</span><span class="p">,</span> <span class="n">rI_tj</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_E$&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_I$&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_complete_analysis</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">7.7</span><span class="p">,</span> <span class="mf">6.</span><span class="p">))</span>

  <span class="c1"># plot example trajectories</span>
  <span class="n">my_plot_trajectories</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
                       <span class="s1">&#39;Sample trajectories </span><span class="se">\n</span><span class="s1">for different init. conditions&#39;</span><span class="p">)</span>
  <span class="n">my_plot_trajectory</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
                     <span class="s1">&#39;Sample trajectory for </span><span class="se">\n</span><span class="s1">low activity&#39;</span><span class="p">)</span>
  <span class="n">my_plot_trajectory</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span>
                     <span class="s1">&#39;Sample trajectory for </span><span class="se">\n</span><span class="s1">high activity&#39;</span><span class="p">)</span>

  <span class="c1"># plot nullclines</span>
  <span class="n">my_plot_nullcline</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span>

  <span class="c1"># plot vector field</span>
  <span class="n">EI_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">EI_grid</span><span class="p">,</span> <span class="n">EI_grid</span><span class="p">)</span>
  <span class="n">drEdt</span><span class="p">,</span> <span class="n">drIdt</span> <span class="o">=</span> <span class="n">EIderivs</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">rI</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
  <span class="n">n_skip</span> <span class="o">=</span> <span class="mi">2</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">rE</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span> <span class="n">rI</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span>
             <span class="n">drEdt</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span> <span class="n">drIdt</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span>
             <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">[</span><span class="mf">1.02</span><span class="p">,</span> <span class="mf">0.57</span><span class="p">],</span> <span class="n">handlelength</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">plot_fp</span><span class="p">(</span><span class="n">x_fp</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_fp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_fp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x_fp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_fp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
           <span class="sa">f</span><span class="s1">&#39;Fixed Point1=</span><span class="se">\n</span><span class="s1">(</span><span class="si">{</span><span class="n">x_fp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">x_fp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
           <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
           <span class="n">rotation</span><span class="o">=</span><span class="n">rotation</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The helper functions included:</p>
<ul class="simple">
<li><p>Parameter dictionary: <code class="docutils literal notranslate"><span class="pre">default_pars(**kwargs)</span></code>. You can use:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">pars</span> <span class="pre">=</span> <span class="pre">default_pars()</span></code> to get all the parameters, and then you can execute <code class="docutils literal notranslate"><span class="pre">print(pars)</span></code> to check these parameters.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pars</span> <span class="pre">=</span> <span class="pre">default_pars(T=T_sim,</span> <span class="pre">dt=time_step)</span></code> to set a different simulation time and time step</p></li>
<li><p>After <code class="docutils literal notranslate"><span class="pre">pars</span> <span class="pre">=</span> <span class="pre">default_pars()</span></code>, use <code class="docutils literal notranslate"><span class="pre">par['New_para']</span> <span class="pre">=</span> <span class="pre">value</span></code> to add a new parameter with its value</p></li>
<li><p>Pass to functions that accept individual parameters with <code class="docutils literal notranslate"><span class="pre">func(**pars)</span></code></p></li>
</ul>
</li>
<li><p>F-I curve: <code class="docutils literal notranslate"><span class="pre">F(x,</span> <span class="pre">a,</span> <span class="pre">theta)</span></code></p></li>
<li><p>Derivative of the F-I curve: <code class="docutils literal notranslate"><span class="pre">dF(x,</span> <span class="pre">a,</span> <span class="pre">theta)</span></code></p></li>
<li><p>Plotting utilities</p></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="section-1-wilson-cowan-model-of-excitatory-and-inhibitory-populations">
<h1>Section 1: Wilson-Cowan model of excitatory and inhibitory populations<a class="headerlink" href="#section-1-wilson-cowan-model-of-excitatory-and-inhibitory-populations" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Video 1: Phase analysis of the Wilson-Cowan E-I model</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">video</span> <span class="o">=</span> <span class="n">YouTubeVideo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;GCpQmh45crM&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">854</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">480</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Video available at https://youtube.com/watch?v=&quot;</span> <span class="o">+</span> <span class="n">video</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="n">video</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="section-1-1-mathematical-description-of-the-wc-model">
<h2>Section 1.1: Mathematical description of the WC model<a class="headerlink" href="#section-1-1-mathematical-description-of-the-wc-model" title="Permalink to this headline">¶</a></h2>
<p>Many of the rich dynamics recorded in the brain are generated by the interaction of excitatory and inhibitory subtype neurons. Here, similar to what we did in the previous tutorial, we will model two coupled populations of E and I neurons (<strong>Wilson-Cowan</strong> model). We can write two coupled differential equations, each representing the dynamics of the excitatory or inhibitory population:</p>
<div class="amsmath math notranslate nohighlight" id="equation-78c3ad4e-972a-40ae-8656-f666a7d55708">
<span class="eqno">(148)<a class="headerlink" href="#equation-78c3ad4e-972a-40ae-8656-f666a7d55708" title="Permalink to this equation">¶</a></span>\[\begin{align}
\tau_E \frac{dr_E}{dt} &amp;= -r_E + F_E(w_{EE}r_E -w_{EI}r_I + I^{\text{ext}}_E;a_E,\theta_E)\\
\tau_I \frac{dr_I}{dt} &amp;= -r_I + F_I(w_{IE}r_E -w_{II}r_I + I^{\text{ext}}_I;a_I,\theta_I)    \qquad (1)
\end{align}\]</div>
<p><span class="math notranslate nohighlight">\(r_E(t)\)</span> represents the average activation (or firing rate) of the excitatory population at time <span class="math notranslate nohighlight">\(t\)</span>, and <span class="math notranslate nohighlight">\(r_I(t)\)</span> the activation (or firing rate) of the inhibitory population. The parameters <span class="math notranslate nohighlight">\(\tau_E\)</span> and <span class="math notranslate nohighlight">\(\tau_I\)</span> control the timescales of the dynamics of each population. Connection strengths are given by: <span class="math notranslate nohighlight">\(w_{EE}\)</span> (E <span class="math notranslate nohighlight">\(\rightarrow\)</span> E), <span class="math notranslate nohighlight">\(w_{EI}\)</span> (I <span class="math notranslate nohighlight">\(\rightarrow\)</span> E), <span class="math notranslate nohighlight">\(w_{IE}\)</span> (E <span class="math notranslate nohighlight">\(\rightarrow\)</span> I), and <span class="math notranslate nohighlight">\(w_{II}\)</span> (I <span class="math notranslate nohighlight">\(\rightarrow\)</span> I). The terms <span class="math notranslate nohighlight">\(w_{EI}\)</span> and <span class="math notranslate nohighlight">\(w_{IE}\)</span> represent connections from inhibitory to excitatory population and vice versa, respectively. The transfer functions (or F-I curves) <span class="math notranslate nohighlight">\(F_E(x;a_E,\theta_E)\)</span> and <span class="math notranslate nohighlight">\(F_I(x;a_I,\theta_I)\)</span> can be different for the excitatory and the inhibitory populations.</p>
<div class="section" id="exercise-1-plot-out-the-f-i-curves-for-the-e-and-i-populations">
<h3>Exercise 1: Plot out the F-I curves for the E and I populations<a class="headerlink" href="#exercise-1-plot-out-the-f-i-curves-for-the-e-and-i-populations" title="Permalink to this headline">¶</a></h3>
<p>Let’s first plot out the F-I curves for the E and I populations using the function defined above with default parameter values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">.1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;a_E&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;theta_E&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;a_I&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;theta_I&#39;</span><span class="p">])</span>

<span class="c1">###################################################################</span>
<span class="c1"># TODO for students: compute and plot the F-I curve here          #</span>
<span class="c1"># Note: aE, thetaE, aI and theta_I are in the dictionray &#39;pars&#39;   #</span>
<span class="c1">###################################################################</span>

<span class="c1"># Compute the F-I curve of the excitatory population</span>
<span class="n">FI_exc</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1"># Compute the F-I curve of the inhibitory population</span>
<span class="n">FI_inh</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1"># Uncomment when you fill the (...)</span>
<span class="c1"># plot_FI_EI(x, FI_exc, FI_inh)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D4_DynamicNetworks/solutions/W2D4_Tutorial2_Solution_b3a0ec15.py"><em>Click for solution</em></a></p>
<p><em>Example output:</em></p>
<img alt='Solution hint' align='left' width=560 height=416 src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/tutorials/W2D4_DynamicNetworks/static/W2D4_Tutorial2_Solution_b3a0ec15_1.png>
</div>
</div>
<div class="section" id="section-1-2-simulation-scheme-for-the-wilson-cowan-model">
<h2>Section 1.2: Simulation scheme for the Wilson-Cowan model<a class="headerlink" href="#section-1-2-simulation-scheme-for-the-wilson-cowan-model" title="Permalink to this headline">¶</a></h2>
<p>Equation <span class="math notranslate nohighlight">\(1\)</span> can be integrated numerically. Using the Euler method, the dynamics of E and I populations can be simulated on a time-grid of stepsize <span class="math notranslate nohighlight">\(\Delta t\)</span>. The updates for the activity of the excitatory and the inhibitory populations can be written as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-c1a5554a-e8cb-42cb-b4df-afded31119d7">
<span class="eqno">(149)<a class="headerlink" href="#equation-c1a5554a-e8cb-42cb-b4df-afded31119d7" title="Permalink to this equation">¶</a></span>\[\begin{align}
r_E[k+1] &amp;= r_E[k] + \Delta r_E[k]\\
r_I[k+1] &amp;= r_I[k] + \Delta r_I[k] 
\end{align}\]</div>
<p>with the increments</p>
<div class="amsmath math notranslate nohighlight" id="equation-65f8e3cc-1d6c-4f8a-8e54-01aa9812cf09">
<span class="eqno">(150)<a class="headerlink" href="#equation-65f8e3cc-1d6c-4f8a-8e54-01aa9812cf09" title="Permalink to this equation">¶</a></span>\[\begin{align}
\Delta r_E[k] &amp;= \frac{\Delta t}{\tau_E}[-r_E[k] + F_E(w_{EE}r_E[k] -w_{EI}r_I[k] + I^{\text{ext}}_E[k];a_E,\theta_E)]\\
\Delta r_I[k] &amp;= \frac{\Delta t}{\tau_I}[-r_I[k] + F_I(w_{IE}r_E[k] -w_{II}r_I[k] + I^{\text{ext}}_I[k];a_I,\theta_I)] 
\end{align}\]</div>
<div class="section" id="exercise-2-numerically-integrate-the-wilson-cowan-equations">
<h3>Exercise 2: Numerically integrate the Wilson-Cowan equations<a class="headerlink" href="#exercise-2-numerically-integrate-the-wilson-cowan-equations" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simulate_wc</span><span class="p">(</span><span class="n">tau_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">,</span> <span class="n">tau_I</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">,</span>
                <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span><span class="p">,</span> <span class="n">wIE</span><span class="p">,</span> <span class="n">wII</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="p">,</span> <span class="n">I_ext_I</span><span class="p">,</span>
                <span class="n">rE_init</span><span class="p">,</span> <span class="n">rI_init</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span><span class="p">,</span> <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Simulate the Wilson-Cowan equations</span>

<span class="sd">  Args:</span>
<span class="sd">    Parameters of the Wilson-Cowan model</span>

<span class="sd">  Returns:</span>
<span class="sd">    rE, rI (arrays) : Activity of excitatory and inhibitory populations</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c1"># Initialize activity arrays</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>
  <span class="n">rE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rE_init</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
  <span class="n">rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rI_init</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
  <span class="n">I_ext_E</span> <span class="o">=</span> <span class="n">I_ext_E</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">I_ext_I</span> <span class="o">=</span> <span class="n">I_ext_I</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>

  <span class="c1"># Simulate the Wilson-Cowan equations</span>
  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Lt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="c1">########################################################################</span>
    <span class="c1"># TODO for students: compute drE and drI and remove the error</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student exercise: compute the change in E/I&quot;</span><span class="p">)</span>
    <span class="c1">########################################################################</span>
    <span class="c1"># Calculate the derivative of the E population</span>
    <span class="n">drE</span> <span class="o">=</span> <span class="o">...</span>
    <span class="c1"># Calculate the derivative of the I population</span>
    <span class="n">drI</span> <span class="o">=</span> <span class="o">...</span>

    <span class="c1"># Update using Euler&#39;s method</span>
    <span class="n">rE</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rE</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">drE</span>
    <span class="n">rI</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rI</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">drI</span>

  <span class="k">return</span> <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span>


<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>

<span class="c1"># Here are two trajectories with close intial values</span>
<span class="c1"># Uncomment these lines to test your function</span>
<span class="c1"># rE1, rI1 = simulate_wc(**default_pars(rE_init=.32, rI_init=.15))</span>
<span class="c1"># rE2, rI2 = simulate_wc(**default_pars(rE_init=.33, rI_init=.15))</span>
<span class="c1"># my_test_plot(pars[&#39;range_t&#39;], rE1, rI1, rE2, rI2)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D4_DynamicNetworks/solutions/W2D4_Tutorial2_Solution_af0bd722.py"><em>Click for solution</em></a></p>
<p><em>Example output:</em></p>
<img alt='Solution hint' align='left' width=560 height=416 src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/tutorials/W2D4_DynamicNetworks/static/W2D4_Tutorial2_Solution_af0bd722_0.png>
<p>The two plots above show the temporal evolution of excitatory (<span class="math notranslate nohighlight">\(r_E\)</span>, blue) and inhibitory (<span class="math notranslate nohighlight">\(r_I\)</span>, red) activity for two different sets of initial conditions.</p>
</div>
<div class="section" id="interactive-demo-population-trajectories-with-different-initial-values">
<h3>Interactive Demo: population trajectories with different initial values<a class="headerlink" href="#interactive-demo-population-trajectories-with-different-initial-values" title="Permalink to this headline">¶</a></h3>
<p>In this interactive demo, we will simulate the Wilson-Cowan model and plot the trajectories of each population. What happens to the E and I population trajectories with different initial conditions?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>


<span class="k">def</span> <span class="nf">plot_EI_diffinitial</span><span class="p">(</span><span class="n">rE_init</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>

  <span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">rE_init</span><span class="o">=</span><span class="n">rE_init</span><span class="p">,</span> <span class="n">rI_init</span><span class="o">=</span><span class="mf">.15</span><span class="p">)</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rE</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E population&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I population&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t (ms)&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Activity&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">_</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">plot_EI_diffinitial</span><span class="p">,</span> <span class="n">rE_init</span><span class="o">=</span><span class="p">(</span><span class="mf">0.30</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">.01</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="think">
<h2>Think!<a class="headerlink" href="#think" title="Permalink to this headline">¶</a></h2>
<p>It is evident that the steady states of the neuronal response can be different when different initial states are chosen. Why is that?</p>
<p>We will discuss this in the next section but try to think about it first.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="section-2-phase-plane-analysis">
<h1>Section 2: Phase plane analysis<a class="headerlink" href="#section-2-phase-plane-analysis" title="Permalink to this headline">¶</a></h1>
<p>Just like we used a graphical method to study the dynamics of a 1-D system in the previous tutorial, here we will learn a  graphical approach called <strong>phase plane analysis</strong> to study the dynamics of a 2-D system like the Wilson-Cowan model.</p>
<p>So far, we have plotted the activities of the two populations as a function of time, i.e., in the <code class="docutils literal notranslate"><span class="pre">Activity-t</span></code> plane, either the <span class="math notranslate nohighlight">\((t, r_E(t))\)</span> plane or the <span class="math notranslate nohighlight">\((t, r_I(t))\)</span> one. Instead, we can plot the two activities <span class="math notranslate nohighlight">\(r_E(t)\)</span> and <span class="math notranslate nohighlight">\(r_I(t)\)</span> against each other at any time point <span class="math notranslate nohighlight">\(t\)</span>. This characterization in the <code class="docutils literal notranslate"><span class="pre">rI-rE</span></code> plane <span class="math notranslate nohighlight">\((r_I(t), r_E(t))\)</span> is called the <strong>phase plane</strong>. Each line in the phase plane indicates how both <span class="math notranslate nohighlight">\(r_E\)</span> and <span class="math notranslate nohighlight">\(r_I\)</span> evolve with time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Video 2: Nullclines and Vector Fields</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">video</span> <span class="o">=</span> <span class="n">YouTubeVideo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;V2SBAK2Xf8Y&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">854</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">480</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Video available at https://youtube.com/watch?v=&quot;</span> <span class="o">+</span> <span class="n">video</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="n">video</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="interactive-demo-from-the-activity-time-plane-to-the-r-i-r-e-phase-plane">
<h2>Interactive Demo: From the Activity - time plane to the <strong><span class="math notranslate nohighlight">\(r_I\)</span> - <span class="math notranslate nohighlight">\(r_E\)</span></strong> phase plane<a class="headerlink" href="#interactive-demo-from-the-activity-time-plane-to-the-r-i-r-e-phase-plane" title="Permalink to this headline">¶</a></h2>
<p>In this demo, we will visualize the system dynamics using both the <code class="docutils literal notranslate"><span class="pre">Activity-time</span></code> and the <code class="docutils literal notranslate"><span class="pre">(rE,</span> <span class="pre">rI)</span></code> phase plane. The circles indicate the activities at a given time <span class="math notranslate nohighlight">\(t\)</span>, while the lines represent the evolution of the system for the entire duration of the simulation.</p>
<p>Move the time slider to better understand how the top plot relates to the bottom plot. Does the bottom plot have explicit information about time? What information does it give us?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">rE_init</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">rI_init</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_activity_phase</span><span class="p">(</span><span class="n">n_t</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rE</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$r_E$&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$r_I$&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">][</span><span class="n">n_t</span><span class="p">],</span> <span class="n">rE</span><span class="p">[</span><span class="n">n_t</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">][</span><span class="n">n_t</span><span class="p">],</span> <span class="n">rI</span><span class="p">[</span><span class="n">n_t</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">][</span><span class="n">n_t</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t (ms)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Activity&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rE</span><span class="p">[</span><span class="n">n_t</span><span class="p">],</span> <span class="n">rI</span><span class="p">[</span><span class="n">n_t</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_E$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_I$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">_</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">plot_activity_phase</span><span class="p">,</span> <span class="n">n_t</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D4_DynamicNetworks/solutions/W2D4_Tutorial2_Solution_222c9db1.py"><em>Click for solution</em></a></p>
</div>
<div class="section" id="section-2-1-nullclines-of-the-wilson-cowan-equations">
<h2>Section 2.1: Nullclines of the Wilson-Cowan Equations<a class="headerlink" href="#section-2-1-nullclines-of-the-wilson-cowan-equations" title="Permalink to this headline">¶</a></h2>
<p>An important concept in the phase plane analysis is the “nullcline” which is defined as the set of points in the phase plane where the activity of one population (but not necessarily the other) does not change.</p>
<p>In other words, the <span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(I\)</span> nullclines of Equation <span class="math notranslate nohighlight">\((1)\)</span> are defined as the points where <span class="math notranslate nohighlight">\(\displaystyle{\frac{dr_E}{dt}}=0\)</span>, for the excitatory nullcline, or <span class="math notranslate nohighlight">\(\displaystyle\frac{dr_I}{dt}=0\)</span> for the inhibitory nullcline. That is:</p>
<div class="amsmath math notranslate nohighlight" id="equation-14e0928f-1967-441d-89b2-8803ca44d08e">
<span class="eqno">(151)<a class="headerlink" href="#equation-14e0928f-1967-441d-89b2-8803ca44d08e" title="Permalink to this equation">¶</a></span>\[\begin{align}
-r_E + F_E(w_{EE}r_E -w_{EI}r_I + I^{\text{ext}}_E;a_E,\theta_E) &amp;= 0  \qquad (2)\\[1mm]
-r_I + F_I(w_{IE}r_E -w_{II}r_I + I^{\text{ext}}_I;a_I,\theta_I) &amp;= 0    \qquad (3)
\end{align}\]</div>
<div class="section" id="exercise-3-compute-the-nullclines-of-the-wilson-cowan-model">
<h3>Exercise 3: Compute the nullclines of the Wilson-Cowan model<a class="headerlink" href="#exercise-3-compute-the-nullclines-of-the-wilson-cowan-model" title="Permalink to this headline">¶</a></h3>
<p>In the next exercise, we will compute and plot the nullclines of the E and I population.</p>
<p>Along the nullcline of excitatory population Equation <span class="math notranslate nohighlight">\(2\)</span>, you can calculate the inhibitory activity by rewriting Equation <span class="math notranslate nohighlight">\(2\)</span> into</p>
<div class="amsmath math notranslate nohighlight" id="equation-68346587-fe1e-46ef-9f2b-d9e6ecbab428">
<span class="eqno">(152)<a class="headerlink" href="#equation-68346587-fe1e-46ef-9f2b-d9e6ecbab428" title="Permalink to this equation">¶</a></span>\[\begin{align}
r_I = \frac{1}{w_{EI}}\big{[}w_{EE}r_E - F_E^{-1}(r_E; a_E,\theta_E) + I^{\text{ext}}_E \big{]}. \qquad(4)
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(F_E^{-1}(r_E; a_E,\theta_E)\)</span> is the inverse of the excitatory transfer function (defined below). Equation <span class="math notranslate nohighlight">\(4\)</span> defines the <span class="math notranslate nohighlight">\(r_E\)</span> nullcline.</p>
<p>Along the nullcline of inhibitory population Equation <span class="math notranslate nohighlight">\(3\)</span>, you can calculate the excitatory activity by rewriting Equation <span class="math notranslate nohighlight">\(3\)</span> into</p>
<div class="amsmath math notranslate nohighlight" id="equation-5bba049f-65cd-46b6-b461-16850c6cc946">
<span class="eqno">(153)<a class="headerlink" href="#equation-5bba049f-65cd-46b6-b461-16850c6cc946" title="Permalink to this equation">¶</a></span>\[\begin{align}
r_E = \frac{1}{w_{IE}} \big{[} w_{II}r_I + F_I^{-1}(r_I;a_I,\theta_I) - I^{\text{ext}}_I \big{]}.  \qquad (5)  
\end{align}\]</div>
<p>shere <span class="math notranslate nohighlight">\(F_I^{-1}(r_I; a_I,\theta_I)\)</span> is the inverse of the inhibitory transfer function (defined below). Equation <span class="math notranslate nohighlight">\(5\)</span> defines the <span class="math notranslate nohighlight">\(I\)</span> nullcline.</p>
<p>Note that, when computing the nullclines with Equations 4-5, we also need to calculate the inverse of the transfer functions. \</p>
<p>The inverse of the sigmoid shaped <strong>f-I</strong> function that we have been using is:</p>
<div class="math notranslate nohighlight">
\[F^{-1}(x; a, \theta) = -\frac{1}{a} \ln \left[ \frac{1}{x + \displaystyle \frac{1}{1+\text{e}^{a\theta}}} - 1 \right] + \theta \qquad (6)\]</div>
<p>The first step is to implement the inverse transfer function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">F_inv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Args:</span>
<span class="sd">    x         : the population input</span>
<span class="sd">    a         : the gain of the function</span>
<span class="sd">    theta     : the threshold of the function</span>

<span class="sd">  Returns:</span>
<span class="sd">    F_inverse : value of the inverse function</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="c1">#########################################################################</span>
  <span class="c1"># TODO for students: compute F_inverse</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student exercise: compute the inverse of F(x)&quot;</span><span class="p">)</span>
  <span class="c1">#########################################################################</span>
  <span class="c1"># Calculate Finverse (ln(x) can be calculated as np.log(x))</span>
  <span class="n">F_inverse</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">F_inverse</span>


<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Uncomment the next line to test your function</span>
<span class="c1"># plot_FI_inverse(x, a=1, theta=3)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D4_DynamicNetworks/solutions/W2D4_Tutorial2_Solution_937a4040.py"><em>Click for solution</em></a></p>
<p><em>Example output:</em></p>
<img alt='Solution hint' align='left' width=558 height=414 src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/tutorials/W2D4_DynamicNetworks/static/W2D4_Tutorial2_Solution_937a4040_1.png>
<p>Now you can compute the nullclines, using Equations 4-5:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_E_nullcline</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">,</span> <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="p">,</span> <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Solve for rI along the rE from drE/dt = 0.</span>

<span class="sd">  Args:</span>
<span class="sd">    rE    : response of excitatory population</span>
<span class="sd">    a_E, theta_E, wEE, wEI, I_ext_E : Wilson-Cowan excitatory parameters</span>
<span class="sd">    Other parameters are ignored</span>

<span class="sd">  Returns:</span>
<span class="sd">    rI    : values of inhibitory population along the nullcline on the rE</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c1">#########################################################################</span>
  <span class="c1"># TODO for students: compute rI for rE nullcline and disable the error</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student exercise: compute the E nullcline&quot;</span><span class="p">)</span>
  <span class="c1">#########################################################################</span>
  <span class="c1"># calculate rI for E nullclines on rI</span>
  <span class="n">rI</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">rI</span>


<span class="k">def</span> <span class="nf">get_I_nullcline</span><span class="p">(</span><span class="n">rI</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">,</span> <span class="n">wIE</span><span class="p">,</span> <span class="n">wII</span><span class="p">,</span> <span class="n">I_ext_I</span><span class="p">,</span> <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Solve for E along the rI from dI/dt = 0.</span>

<span class="sd">  Args:</span>
<span class="sd">    rI    : response of inhibitory population</span>
<span class="sd">    a_I, theta_I, wIE, wII, I_ext_I : Wilson-Cowan inhibitory parameters</span>
<span class="sd">    Other parameters are ignored</span>

<span class="sd">  Returns:</span>
<span class="sd">    rE    : values of the excitatory population along the nullcline on the rI</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c1">#########################################################################</span>
  <span class="c1"># TODO for students: compute rI for rE nullcline and disable the error</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student exercise: compute the I nullcline&quot;</span><span class="p">)</span>
  <span class="c1">#########################################################################</span>
  <span class="c1"># calculate rE for I nullclines on rI</span>
  <span class="n">rE</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">rE</span>


<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>
<span class="n">Exc_null_rE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">Inh_null_rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">.01</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Uncomment these lines to test your functions</span>
<span class="c1"># Exc_null_rI = get_E_nullcline(Exc_null_rE, **pars)</span>
<span class="c1"># Inh_null_rE = get_I_nullcline(Inh_null_rI, **pars)</span>

<span class="c1"># plot_nullclines(Exc_null_rE, Exc_null_rI, Inh_null_rE, Inh_null_rI)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D4_DynamicNetworks/solutions/W2D4_Tutorial2_Solution_2366ea57.py"><em>Click for solution</em></a></p>
<p><em>Example output:</em></p>
<img alt='Solution hint' align='left' width=560 height=416 src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/tutorials/W2D4_DynamicNetworks/static/W2D4_Tutorial2_Solution_2366ea57_0.png>
<p>Note that by definition along the blue line in the phase-plane spanned by <span class="math notranslate nohighlight">\(r_E, r_I\)</span>, <span class="math notranslate nohighlight">\(\displaystyle{\frac{dr_E(t)}{dt}} = 0\)</span>, therefore, it is called a nullcline.</p>
<p>That is, the blue nullcline divides the phase-plane spanned by <span class="math notranslate nohighlight">\(r_E, r_I\)</span> into two regions: on one side of the nullcline <span class="math notranslate nohighlight">\(\displaystyle{\frac{dr_E(t)}{dt}} &gt; 0\)</span> and on the other side <span class="math notranslate nohighlight">\(\displaystyle{\frac{dr_E(t)}{dt}} &lt; 0\)</span>.</p>
<p>The same is true for the red line along which <span class="math notranslate nohighlight">\(\displaystyle{\frac{dr_I(t)}{dt}} = 0\)</span>. That is, the red nullcline divides the phase-plane spanned by <span class="math notranslate nohighlight">\(r_E, r_I\)</span> into two regions: on one side of the nullcline <span class="math notranslate nohighlight">\(\displaystyle{\frac{dr_I(t)}{dt}} &gt; 0\)</span> and on the other side <span class="math notranslate nohighlight">\(\displaystyle{\frac{dr_I(t)}{dt}} &lt; 0\)</span>.</p>
</div>
</div>
<div class="section" id="section-2-2-vector-field">
<h2>Section 2.2: Vector field<a class="headerlink" href="#section-2-2-vector-field" title="Permalink to this headline">¶</a></h2>
<p>How can the phase plane and the nullcline curves help us understand the behavior of the Wilson-Cowan model?</p>
<p>The activities of the <span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(I\)</span> populations <span class="math notranslate nohighlight">\(r_E(t)\)</span> and <span class="math notranslate nohighlight">\(r_I(t)\)</span> at each time point <span class="math notranslate nohighlight">\(t\)</span> correspond to a single point in the phase plane, with coordinates <span class="math notranslate nohighlight">\((r_E(t),r_I(t))\)</span>. Therefore, the time-dependent trajectory of the system can be described as a continuous curve in the phase plane, and the tangent vector to the trajectory, which is defined as the vector <span class="math notranslate nohighlight">\(\bigg{(}\displaystyle{\frac{dr_E(t)}{dt},\frac{dr_I(t)}{dt}}\bigg{)}\)</span>, indicates the direction towards which the activity is evolving and how fast is the activity changing along each axis. In fact, for each point <span class="math notranslate nohighlight">\((E,I)\)</span> in the phase plane, we can compute the tangent vector <span class="math notranslate nohighlight">\(\bigg{(}\displaystyle{\frac{dr_E}{dt},\frac{dr_I}{dt}}\bigg{)}\)</span>, which  indicates the behavior of the system when it traverses that point.</p>
<p>The map of tangent vectors in the phase plane is called <strong>vector field</strong>. The behavior of any trajectory in the phase plane is determined by i) the initial conditions <span class="math notranslate nohighlight">\((r_E(0),r_I(0))\)</span>, and ii) the vector field <span class="math notranslate nohighlight">\(\bigg{(}\displaystyle{\frac{dr_E(t)}{dt},\frac{dr_I(t)}{dt}}\bigg{)}\)</span>.</p>
<p>In general, the value of the vector field at a particular point in the phase plane is represented by an arrow. The orientation and the size of the arrow reflect the direction and the norm of the vector, respectively.</p>
<div class="section" id="exercise-4-compute-and-plot-the-vector-field-displaystyle-big-frac-dr-e-dt-frac-dr-i-dt-big">
<h3>Exercise 4: Compute and plot the vector field <span class="math notranslate nohighlight">\(\displaystyle{\Big{(}\frac{dr_E}{dt}, \frac{dr_I}{dt} \Big{)}}\)</span><a class="headerlink" href="#exercise-4-compute-and-plot-the-vector-field-displaystyle-big-frac-dr-e-dt-frac-dr-i-dt-big" title="Permalink to this headline">¶</a></h3>
<p>Note that</p>
<div class="amsmath math notranslate nohighlight" id="equation-c31f9e88-e362-40d3-99cd-272b37113893">
<span class="eqno">(154)<a class="headerlink" href="#equation-c31f9e88-e362-40d3-99cd-272b37113893" title="Permalink to this equation">¶</a></span>\[\begin{align}
\frac{dr_E}{dt} &amp;= [-r_E + F_E(w_{EE}r_E -w_{EI}r_I + I^{\text{ext}}_E;a_E,\theta_E)]\frac{1}{\tau_E}\\
\frac{dr_I}{dt} &amp;= [-r_I + F_I(w_{IE}r_E -w_{II}r_I + I^{\text{ext}}_I;a_I,\theta_I)]\frac{1}{\tau_I}    
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">EIderivs</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">rI</span><span class="p">,</span>
             <span class="n">tau_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">,</span> <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="p">,</span>
             <span class="n">tau_I</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">,</span> <span class="n">wIE</span><span class="p">,</span> <span class="n">wII</span><span class="p">,</span> <span class="n">I_ext_I</span><span class="p">,</span>
             <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Time derivatives for E/I variables (dE/dt, dI/dt).&quot;&quot;&quot;</span>
  <span class="c1">######################################################################</span>
  <span class="c1"># TODO for students: compute drEdt and drIdt and disable the error</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student exercise: compute the vector field&quot;</span><span class="p">)</span>
  <span class="c1">######################################################################</span>
  <span class="c1"># Compute the derivative of rE</span>
  <span class="n">drEdt</span> <span class="o">=</span> <span class="o">...</span>
  <span class="c1"># Compute the derivative of rI</span>
  <span class="n">drIdt</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">drEdt</span><span class="p">,</span> <span class="n">drIdt</span>


<span class="c1"># Uncomment below to test your function</span>
<span class="c1"># plot_complete_analysis(default_pars())</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D4_DynamicNetworks/solutions/W2D4_Tutorial2_Solution_5a629797.py"><em>Click for solution</em></a></p>
<p><em>Example output:</em></p>
<img alt='Solution hint' align='left' width=535 height=416 src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/tutorials/W2D4_DynamicNetworks/static/W2D4_Tutorial2_Solution_5a629797_0.png>
<p>The last phase plane plot shows us that:</p>
<ul class="simple">
<li><p>Trajectories seem to follow the direction of the vector field</p></li>
<li><p>Different trajectories eventually always reach one of two points depending on the initial conditions.</p></li>
<li><p>The two points where the trajectories converge are the intersection of the two nullcline curves.</p></li>
</ul>
</div>
</div>
<div class="section" id="id1">
<h2>Think!<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>There are, in total, three intersection points, meaning that the system has three fixed points.</p>
<ul class="simple">
<li><p>One of the fixed points (the one in the middle) is never the final state of a trajectory. Why is that?</p></li>
<li><p>Why the arrows tend to get smaller as they approach the fixed points?</p></li>
</ul>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D4_DynamicNetworks/solutions/W2D4_Tutorial2_Solution_3d37729b.py"><em>Click for solution</em></a></p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h1>
<p>Congratulations! You have finished the second day of the last week of the neuromatch academy! Here, you learned how to simulate a rate based model consisting of excitatory and inhibitory population of neurons.</p>
<p>In the last tutorial on dynamical neuronal networks you learned to:</p>
<ul class="simple">
<li><p>Implement and simulate a 2D system composed of an E and an I population of neurons using the <strong>Wilson-Cowan</strong> model</p></li>
<li><p>Plot the frequency-current (F-I) curves for both populations</p></li>
<li><p>Examine the behavior of the system using phase <strong>plane analysis</strong>, <strong>vector fields</strong>, and <strong>nullclines</strong>.</p></li>
</ul>
<p>Do you have more time? Have you finished early? We have more fun material for you!</p>
<p>Below are some, more advanced concepts on dynamical systems:</p>
<ul class="simple">
<li><p>You will learn how to find the fixed points on such a system, and to investigate its stability by linearizing its dynamics and examining the <strong>Jacobian matrix</strong>.</p></li>
<li><p>You will see identify conditions under which the Wilson-Cowan model can exhibit oscillations.</p></li>
</ul>
<p>If you need even more, there are two applications of the Wilson-Cowan model:</p>
<ul class="simple">
<li><p>Visualization of an Inhibition-stabilized network</p></li>
<li><p>Simulation of working memory</p></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="bonus-1-fixed-points-stability-analysis-and-limit-cycles-in-the-wilson-cowan-model">
<h1>Bonus 1: Fixed points, stability analysis, and limit cycles in the Wilson-Cowan model<a class="headerlink" href="#bonus-1-fixed-points-stability-analysis-and-limit-cycles-in-the-wilson-cowan-model" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Video 3: Fixed points and their stability</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">video</span> <span class="o">=</span> <span class="n">YouTubeVideo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;jIx26iQ69ps&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">854</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">480</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Video available at https://youtube.com/watch?v=&quot;</span> <span class="o">+</span> <span class="n">video</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="n">video</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="fixed-points-of-the-e-i-system">
<h2>Fixed Points of the E/I system<a class="headerlink" href="#fixed-points-of-the-e-i-system" title="Permalink to this headline">¶</a></h2>
<p>Clearly, the intersection points of the two nullcline curves are the fixed points of the Wilson-Cowan model in Equation <span class="math notranslate nohighlight">\((1)\)</span>.</p>
<p>In the next exercise, we will find the coordinate of all fixed points for a given set of parameters.</p>
<p>We’ll make use of two functions, similar to ones we saw in the previous tutorial, which use a root-finding algorithm to find the fixed points of the system with Excitatory and Inhibitory populations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown *Execute the cell to define `my_fp` and `check_fp`*</span>

<span class="k">def</span> <span class="nf">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">rE_init</span><span class="p">,</span> <span class="n">rI_init</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Use opt.root function to solve Equations (2)-(3) from initial values</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="n">tau_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;tau_E&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;a_E&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;theta_E&#39;</span><span class="p">]</span>
  <span class="n">tau_I</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;tau_I&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;a_I&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;theta_I&#39;</span><span class="p">]</span>
  <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wEE&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wEI&#39;</span><span class="p">]</span>
  <span class="n">wIE</span><span class="p">,</span> <span class="n">wII</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wIE&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wII&#39;</span><span class="p">]</span>
  <span class="n">I_ext_E</span><span class="p">,</span> <span class="n">I_ext_I</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;I_ext_E&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;I_ext_I&#39;</span><span class="p">]</span>

  <span class="c1"># define the right hand of wilson-cowan equations</span>
  <span class="k">def</span> <span class="nf">my_WCr</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>

    <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">drEdt</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">rE</span> <span class="o">+</span> <span class="n">F</span><span class="p">(</span><span class="n">wEE</span> <span class="o">*</span> <span class="n">rE</span> <span class="o">-</span> <span class="n">wEI</span> <span class="o">*</span> <span class="n">rI</span> <span class="o">+</span> <span class="n">I_ext_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">))</span> <span class="o">/</span> <span class="n">tau_E</span>
    <span class="n">drIdt</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">rI</span> <span class="o">+</span> <span class="n">F</span><span class="p">(</span><span class="n">wIE</span> <span class="o">*</span> <span class="n">rE</span> <span class="o">-</span> <span class="n">wII</span> <span class="o">*</span> <span class="n">rI</span> <span class="o">+</span> <span class="n">I_ext_I</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">))</span> <span class="o">/</span> <span class="n">tau_I</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">drEdt</span><span class="p">,</span> <span class="n">drIdt</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">y</span>

  <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rE_init</span><span class="p">,</span> <span class="n">rI_init</span><span class="p">])</span>
  <span class="n">x_fp</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">my_WCr</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span><span class="o">.</span><span class="n">x</span>

  <span class="k">return</span> <span class="n">x_fp</span>


<span class="k">def</span> <span class="nf">check_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">x_fp</span><span class="p">,</span> <span class="n">mytol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Verify (drE/dt)^2 + (drI/dt)^2&lt; mytol</span>

<span class="sd">  Args:</span>
<span class="sd">    pars    : Parameter dictionary</span>
<span class="sd">    fp      : value of fixed point</span>
<span class="sd">    mytol   : tolerance, default as 10^{-6}</span>

<span class="sd">  Returns :</span>
<span class="sd">    Whether it is a correct fixed point: True/False</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="n">drEdt</span><span class="p">,</span> <span class="n">drIdt</span> <span class="o">=</span> <span class="n">EIderivs</span><span class="p">(</span><span class="n">x_fp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_fp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">drEdt</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">drIdt</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">mytol</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="exercise-5-find-the-fixed-points-of-the-wilson-cowan-model">
<h3>Exercise 5: Find the fixed points of the Wilson-Cowan model<a class="headerlink" href="#exercise-5-find-the-fixed-points-of-the-wilson-cowan-model" title="Permalink to this headline">¶</a></h3>
<p>From the above nullclines, we notice that the system features  three fixed points with the parameters we used. To find their coordinates, we need to choose proper initial value to give to the <code class="docutils literal notranslate"><span class="pre">opt.root</span></code> function inside of the function <code class="docutils literal notranslate"><span class="pre">my_fp</span></code> we just defined, since the algorithm can only find fixed points in the vicinity of the initial value.</p>
<p>In this exercise, you will use the function <code class="docutils literal notranslate"><span class="pre">my_fp</span></code> to find each of the fixed points by varying the initial values. Note that you can choose the values near the intersections of the nullclines as the initial values to calculate the fixed points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>

<span class="c1">######################################################################</span>
<span class="c1"># TODO: Provide initial values to calculate the fixed points</span>
<span class="c1"># Check if x_fp&#39;s are the correct with the function check_fp(x_fp)</span>
<span class="c1"># Hint: vary different initial values to find the correct fixed points                                #</span>
<span class="c1">######################################################################</span>

<span class="c1"># my_plot_nullcline(pars)</span>

<span class="c1"># Find the first fixed point</span>
<span class="c1"># x_fp_1 = my_fp(pars, ..., ...)</span>
<span class="c1"># if check_fp(pars, x_fp_1):</span>
<span class="c1">#   plot_fp(x_fp_1)</span>

<span class="c1"># Find the second fixed point</span>
<span class="c1"># x_fp_2 = my_fp(pars, ..., ...)</span>
<span class="c1"># if check_fp(pars, x_fp_2):</span>
<span class="c1">#   plot_fp(x_fp_2)</span>

<span class="c1"># Find the third fixed point</span>
<span class="c1"># x_fp_3 = my_fp(pars, ..., ...)</span>
<span class="c1"># if check_fp(pars, x_fp_3):</span>
<span class="c1">#   plot_fp(x_fp_3)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D4_DynamicNetworks/solutions/W2D4_Tutorial2_Solution_0dd7ba5a.py"><em>Click for solution</em></a></p>
<p><em>Example output:</em></p>
<img alt='Solution hint' align='left' width=557 height=412 src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/tutorials/W2D4_DynamicNetworks/static/W2D4_Tutorial2_Solution_0dd7ba5a_0.png>
</div>
</div>
<div class="section" id="stability-of-a-fixed-point-and-eigenvalues-of-the-jacobian-matrix">
<h2>Stability of a fixed point and eigenvalues of the Jacobian Matrix<a class="headerlink" href="#stability-of-a-fixed-point-and-eigenvalues-of-the-jacobian-matrix" title="Permalink to this headline">¶</a></h2>
<p>First, let’s first rewrite the system <span class="math notranslate nohighlight">\(1\)</span> as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-bae7c07b-4517-426e-a462-653002bf1759">
<span class="eqno">(155)<a class="headerlink" href="#equation-bae7c07b-4517-426e-a462-653002bf1759" title="Permalink to this equation">¶</a></span>\[\begin{align}
&amp;\frac{dr_E}{dt} = G_E(r_E,r_I)\\[0.5mm]
&amp;\frac{dr_I}{dt} = G_I(r_E,r_I)
\end{align}\]</div>
<p>where</p>
<div class="amsmath math notranslate nohighlight" id="equation-010d409a-f2fb-4f5b-8481-5c2c1d33d133">
<span class="eqno">(156)<a class="headerlink" href="#equation-010d409a-f2fb-4f5b-8481-5c2c1d33d133" title="Permalink to this equation">¶</a></span>\[\begin{align}
&amp;G_E(r_E,r_I) = \frac{1}{\tau_E} [-r_E + F_E(w_{EE}r_E -w_{EI}r_I + I^{\text{ext}}_E;a,\theta)]\\[1mm]
&amp;G_I(r_E,r_I) = \frac{1}{\tau_I} [-r_I + F_I(w_{IE}r_E -w_{II}r_I + I^{\text{ext}}_I;a,\theta)]
\end{align}\]</div>
<p>By definition, <span class="math notranslate nohighlight">\(\displaystyle\frac{dr_E}{dt}=0\)</span> and <span class="math notranslate nohighlight">\(\displaystyle\frac{dr_I}{dt}=0\)</span> at each fixed point. Therefore, if the initial state is exactly at the fixed point, the state of the system will not change as time evolves.</p>
<p>However, if the initial state deviates slightly from the fixed point, there are two possibilities
the trajectory will be attracted back to the</p>
<ol class="simple">
<li><p>The trajectory will be attracted back to the fixed point</p></li>
<li><p>The trajectory will diverge from the fixed point.</p></li>
</ol>
<p>These two possibilities define the type of fixed point, i.e., stable or unstable. Similar to the 1D system studied in the previous tutorial, the stability of a fixed point <span class="math notranslate nohighlight">\((r_E^*, r_I^*)\)</span> can be determined by linearizing the dynamics of the system (can you figure out how?). The linearization will yield a matrix of first-order derivatives called the Jacobian matrix:</p>
<div class="amsmath math notranslate nohighlight" id="equation-5c448d35-aa5e-4458-bd68-822c1ae7d66b">
<span class="eqno">(157)<a class="headerlink" href="#equation-5c448d35-aa5e-4458-bd68-822c1ae7d66b" title="Permalink to this equation">¶</a></span>\[\begin{equation}
   J=
  \left[ {\begin{array}{cc}
   \displaystyle{\frac{\partial}{\partial r_E}}G_E(r_E^*, r_I^*) &amp; \displaystyle{\frac{\partial}{\partial r_I}}G_E(r_E^*, r_I^*)\\[1mm]
   \displaystyle\frac{\partial}{\partial r_E} G_I(r_E^*, r_I^*) &amp; \displaystyle\frac{\partial}{\partial r_I}G_I(r_E^*, r_I^*) \\
  \end{array} } \right] \quad (7)
\end{equation}\]</div>
<p>\</p>
<p>The eigenvalues of the Jacobian matrix calculated at the fixed point will determine whether it is a stable or unstable fixed point.</p>
<p>\</p>
<p>We can now compute the derivatives needed to build the Jacobian matrix. Using the chain and product rules the derivatives for the excitatory population are given by:</p>
<p>\</p>
<div class="amsmath math notranslate nohighlight" id="equation-225c3b1b-b5c0-492e-aab4-d6f97c5224f1">
<span class="eqno">(158)<a class="headerlink" href="#equation-225c3b1b-b5c0-492e-aab4-d6f97c5224f1" title="Permalink to this equation">¶</a></span>\[\begin{align}
&amp;\frac{\partial}{\partial r_E} G_E(r_E^*, r_I^*) = \frac{1}{\tau_E} [-1 + w_{EE} F_E'(w_{EE}r_E^* -w_{EI}r_I^* +  I^{\text{ext}}_E;\alpha_E, \theta_E)] \\[1mm]
&amp;\frac{\partial}{\partial r_I} G_E(r_E^*, r_I^*)= \frac{1}{\tau_E} [-w_{EI} F_E'(w_{EE}r_E^* -w_{EI}r_I^* +  I^{\text{ext}}_E;\alpha_E, \theta_E)]
\end{align}\]</div>
<p>\</p>
<p>The same applies to the inhibitory population.</p>
<div class="section" id="exercise-6-compute-the-jacobian-matrix-for-the-wilson-cowan-model">
<h3>Exercise 6: Compute the Jacobian Matrix for the Wilson-Cowan model<a class="headerlink" href="#exercise-6-compute-the-jacobian-matrix-for-the-wilson-cowan-model" title="Permalink to this headline">¶</a></h3>
<p>Here, you can use <code class="docutils literal notranslate"><span class="pre">dF(x,a,theta)</span></code> defined in the <code class="docutils literal notranslate"><span class="pre">Helper</span> <span class="pre">functions</span></code> to calculate the derivative of the F-I curve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_eig_Jacobian</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span>
                     <span class="n">tau_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">,</span> <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="p">,</span>
                     <span class="n">tau_I</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">,</span> <span class="n">wIE</span><span class="p">,</span> <span class="n">wII</span><span class="p">,</span> <span class="n">I_ext_I</span><span class="p">,</span> <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Compute eigenvalues of the Wilson-Cowan Jacobian matrix at fixed point.&quot;&quot;&quot;</span>
  <span class="c1"># Initialization</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">fp</span>
  <span class="n">J</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

  <span class="c1">###########################################################################</span>
  <span class="c1"># TODO for students: compute J and disable the error</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student excercise: compute the Jacobian matrix&quot;</span><span class="p">)</span>
  <span class="c1">###########################################################################</span>
  <span class="c1"># Compute the four elements of the Jacobian matrix</span>
  <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
  <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
  <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
  <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>

  <span class="c1"># Compute and return the eigenvalues</span>
  <span class="n">evals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">J</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
  <span class="k">return</span> <span class="n">evals</span>


<span class="c1"># Uncomment below to test your function when you get the correct fixed point</span>
<span class="c1"># eig_1 = get_eig_Jacobian(x_fp_1, **pars)</span>
<span class="c1"># eig_2 = get_eig_Jacobian(x_fp_2, **pars)</span>
<span class="c1"># eig_3 = get_eig_Jacobian(x_fp_3, **pars)</span>

<span class="c1"># print(eig_1, &#39;Stable point&#39;)</span>
<span class="c1"># print(eig_2, &#39;Unstable point&#39;)</span>
<span class="c1"># print(eig_3, &#39;Stable point&#39;)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D4_DynamicNetworks/solutions/W2D4_Tutorial2_Solution_e83cfc05.py"><em>Click for solution</em></a></p>
<p>As is evident, the stable fixed points correspond to the negative eigenvalues, while unstable point corresponds to at least one positive eigenvalue.</p>
<p>The sign of the eigenvalues is determined by the connectivity (interaction) between excitatory and inhibitory populations.</p>
<p>Below we investigate the effect of <span class="math notranslate nohighlight">\(w_{EE}\)</span> on the nullclines and the eigenvalues of the dynamical system.</p>
<p>* <em>Critical change is referred to as <strong>pitchfork bifurcation</strong></em>.</p>
</div>
</div>
<div class="section" id="effect-of-wee-on-the-nullclines-and-the-eigenvalues">
<h2>Effect of <code class="docutils literal notranslate"><span class="pre">wEE</span></code> on the nullclines and the eigenvalues<a class="headerlink" href="#effect-of-wee-on-the-nullclines-and-the-eigenvalues" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Make sure you execute this cell to see the plot!</span>

<span class="n">eig_1_M</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">eig_2_M</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">eig_3_M</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>
<span class="n">wEE_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">my_thre</span> <span class="o">=</span> <span class="mf">7.9</span>
<span class="k">for</span> <span class="n">wEE</span> <span class="ow">in</span> <span class="n">wEE_grid</span><span class="p">:</span>
  <span class="n">x_fp_1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>
  <span class="n">x_fp_2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">.4</span><span class="p">,</span> <span class="mf">.1</span><span class="p">]</span>
  <span class="n">x_fp_3</span> <span class="o">=</span> <span class="p">[</span><span class="mf">.8</span><span class="p">,</span> <span class="mf">.1</span><span class="p">]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wEE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wEE</span>
  <span class="k">if</span> <span class="n">wEE</span> <span class="o">&lt;</span> <span class="n">my_thre</span><span class="p">:</span>
    <span class="n">x_fp_1</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">x_fp_1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_fp_1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">eig_1</span> <span class="o">=</span> <span class="n">get_eig_Jacobian</span><span class="p">(</span><span class="n">x_fp_1</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
    <span class="n">eig_1_M</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eig_1</span><span class="p">)))</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">x_fp_1</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">x_fp_1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_fp_1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">eig_1</span> <span class="o">=</span> <span class="n">get_eig_Jacobian</span><span class="p">(</span><span class="n">x_fp_1</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
    <span class="n">eig_1_M</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eig_1</span><span class="p">)))</span>

    <span class="n">x_fp_2</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">x_fp_2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_fp_2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">eig_2</span> <span class="o">=</span> <span class="n">get_eig_Jacobian</span><span class="p">(</span><span class="n">x_fp_2</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
    <span class="n">eig_2_M</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eig_2</span><span class="p">)))</span>

    <span class="n">x_fp_3</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">x_fp_3</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_fp_3</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">eig_3</span> <span class="o">=</span> <span class="n">get_eig_Jacobian</span><span class="p">(</span><span class="n">x_fp_3</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
    <span class="n">eig_3_M</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eig_3</span><span class="p">)))</span>

<span class="n">eig_1_M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">eig_1_M</span><span class="p">)</span>
<span class="n">eig_2_M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">eig_2_M</span><span class="p">)</span>
<span class="n">eig_3_M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">eig_3_M</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wEE_grid</span><span class="p">,</span> <span class="n">eig_1_M</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wEE_grid</span><span class="p">[</span><span class="n">wEE_grid</span> <span class="o">&gt;=</span> <span class="n">my_thre</span><span class="p">],</span> <span class="n">eig_2_M</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wEE_grid</span><span class="p">[</span><span class="n">wEE_grid</span> <span class="o">&gt;=</span> <span class="n">my_thre</span><span class="p">],</span> <span class="n">eig_3_M</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$w_{\mathrm</span><span class="si">{EE}</span><span class="s1">}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;maximum real part of eigenvalue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="interactive-demo-nullclines-position-in-the-phase-plane-changes-with-parameter-values">
<h2>Interactive Demo: Nullclines position in the phase plane changes with parameter values<a class="headerlink" href="#interactive-demo-nullclines-position-in-the-phase-plane-changes-with-parameter-values" title="Permalink to this headline">¶</a></h2>
<p>In this interactive widget, we will explore how the nullclines move for different values of the parameter <span class="math notranslate nohighlight">\(w_{EE}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>


<span class="k">def</span> <span class="nf">plot_nullcline_diffwEE</span><span class="p">(</span><span class="n">wEE</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plot nullclines for different values of wEE</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">wEE</span><span class="o">=</span><span class="n">wEE</span><span class="p">)</span>

  <span class="c1"># plot the E, I nullclines</span>
  <span class="n">Exc_null_rE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">.96</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
  <span class="n">Exc_null_rI</span> <span class="o">=</span> <span class="n">get_E_nullcline</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">Inh_null_rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">.01</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
  <span class="n">Inh_null_rE</span> <span class="o">=</span> <span class="n">get_I_nullcline</span><span class="p">(</span><span class="n">Inh_null_rI</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="n">Exc_null_rI</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E nullcline&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Inh_null_rE</span><span class="p">,</span> <span class="n">Inh_null_rI</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I nullcline&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_E$&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_I$&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rE_init&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rI_init&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rE</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E population&#39;</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I population&#39;</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Activity&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;E/I activity</span><span class="se">\n</span><span class="s1">for different initial conditions&#39;</span><span class="p">,</span>
            <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rE_init&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rI_init&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rE</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E population&#39;</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I population&#39;</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t (ms)&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Activity&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">_</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">plot_nullcline_diffwEE</span><span class="p">,</span> <span class="n">wEE</span><span class="o">=</span><span class="p">(</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">.01</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D4_DynamicNetworks/solutions/W2D4_Tutorial2_Solution_d4eb0391.py"><em>Click for solution</em></a></p>
<p>We can also investigate the effect of different <span class="math notranslate nohighlight">\(w_{EI}\)</span>, <span class="math notranslate nohighlight">\(w_{IE}\)</span>, <span class="math notranslate nohighlight">\(w_{II}\)</span>, <span class="math notranslate nohighlight">\(\tau_{E}\)</span>, <span class="math notranslate nohighlight">\(\tau_{I}\)</span>, and <span class="math notranslate nohighlight">\(I_{E}^{\text{ext}}\)</span> on the stability of fixed points. In addition, we can also consider the perturbation of the parameters of the gain curve <span class="math notranslate nohighlight">\(F(\cdot)\)</span>.</p>
</div>
<div class="section" id="limit-cycle-oscillations">
<h2>Limit cycle - Oscillations<a class="headerlink" href="#limit-cycle-oscillations" title="Permalink to this headline">¶</a></h2>
<p>For some values of interaction terms (<span class="math notranslate nohighlight">\(w_{EE}, w_{IE}, w_{EI}, w_{II}\)</span> the eigenvalues can become complex. When at least one pair of eigenvalues is complex, oscillations arise.
The stability of oscillations is determined by the real part of the eigenvalues (+ve real part oscillations will grow, -ve real part oscillations will die out). The size of the complex part determines the frequency of oscillations.</p>
<p>For instance, if we use a different set of parameters, <span class="math notranslate nohighlight">\(w_{EE}=6.4\)</span>, <span class="math notranslate nohighlight">\(w_{EI}=4.8\)</span>, <span class="math notranslate nohighlight">\(w_{IE}=6.\)</span>, <span class="math notranslate nohighlight">\(w_{II}=1.2\)</span>, and <span class="math notranslate nohighlight">\(I_{E}^{\text{ext}}=0.8\)</span>, then we shall observe that the E and I population activity start to oscillate! Please execute the cell below to check the oscillatory behavior.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Make sure you execute this cell to see the oscillations!</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mf">100.</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wEE&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wEI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wIE&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wII&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">1.2</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;I_ext_E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rE_init&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rI_init&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span>

<span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rE</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$r_E$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$r_I$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t (ms)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Activity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="exercise-7-plot-the-phase-plane">
<h3>Exercise 7: Plot the phase plane<a class="headerlink" href="#exercise-7-plot-the-phase-plane" title="Permalink to this headline">¶</a></h3>
<p>We can also understand the oscillations of the population behavior using the phase plane. By plotting a set of trajectories with different initial states, we can see that these trajectories will move in a circle instead of converging to a fixed point. This circle is called “limit cycle” and shows the periodic oscillations of the <span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(I\)</span> population behavior under some conditions.</p>
<p>Try to plot the phase plane using the previously defined functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mf">100.</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wEE&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wEI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wIE&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wII&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">1.2</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;I_ext_E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.8</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">my_plot_nullcline</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span>
<span class="c1">###############################################################################</span>
<span class="c1"># TODO for students: plot phase plane: nullclines, trajectories, fixed point  #</span>
<span class="c1">###############################################################################</span>

<span class="c1"># Find the correct fixed point</span>
<span class="c1"># x_fp_1 = my_fp(pars, ..., ...)</span>
<span class="c1"># if check_fp(pars, x_fp_1):</span>
<span class="c1">#   plot_fp(x_fp_1, position=(0, 0), rotation=40)</span>


<span class="n">my_plot_trajectories</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
                     <span class="s1">&#39;Sample trajectories </span><span class="se">\n</span><span class="s1">with different initial values&#39;</span><span class="p">)</span>
<span class="n">my_plot_vector</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">[</span><span class="mf">1.01</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D4_DynamicNetworks/solutions/W2D4_Tutorial2_Solution_03c5c8dd.py"><em>Click for solution</em></a></p>
<p><em>Example output:</em></p>
<img alt='Solution hint' align='left' width=486 height=380 src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/tutorials/W2D4_DynamicNetworks/static/W2D4_Tutorial2_Solution_03c5c8dd_0.png>
</div>
</div>
<div class="section" id="interactive-demo-limit-cycle-and-oscillations">
<h2>Interactive Demo: Limit cycle and oscillations.<a class="headerlink" href="#interactive-demo-limit-cycle-and-oscillations" title="Permalink to this headline">¶</a></h2>
<p>From the above examples, the change of model parameters changes the shape of the nullclines and, accordingly, the behavior of the <span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(I\)</span> populations from steady fixed points to oscillations. However, the shape of the nullclines is unable to fully determine the behavior of the network. The vector field also matters. To demonstrate this, here, we will investigate the effect of time constants on the population behavior. By changing the inhibitory time constant <span class="math notranslate nohighlight">\(\tau_I\)</span>, the nullclines do not change, but the network behavior changes substantially from steady state to oscillations with different frequencies.</p>
<p>Such a dramatic change in the system behavior is referred to as a <strong>bifurcation</strong>.</p>
<p>\
Please execute the code below to check this out.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>


<span class="k">def</span> <span class="nf">time_constant_effect</span><span class="p">(</span><span class="n">tau_i</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>

  <span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mf">100.</span><span class="p">)</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wEE&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wEI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wIE&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wII&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">1.2</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;I_ext_E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.8</span>

  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;tau_I&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tau_i</span>

  <span class="n">Exc_null_rE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
  <span class="n">Inh_null_rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">.6</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

  <span class="n">Exc_null_rI</span> <span class="o">=</span> <span class="n">get_E_nullcline</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
  <span class="n">Inh_null_rE</span> <span class="o">=</span> <span class="n">get_I_nullcline</span><span class="p">(</span><span class="n">Inh_null_rI</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">12.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>  <span class="c1"># nullclines</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="n">Exc_null_rI</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E nullcline&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Inh_null_rE</span><span class="p">,</span> <span class="n">Inh_null_rI</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I nullcline&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_E$&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_I$&#39;</span><span class="p">)</span>

  <span class="c1"># fixed point</span>
  <span class="n">x_fp_1</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_fp_1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_fp_1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

  <span class="n">eig_1</span> <span class="o">=</span> <span class="n">get_eig_Jacobian</span><span class="p">(</span><span class="n">x_fp_1</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="c1"># trajectories</span>
  <span class="k">for</span> <span class="n">ie</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
      <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rE_init&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rI_init&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">ie</span><span class="p">,</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">ii</span>
      <span class="n">rE_tj</span><span class="p">,</span> <span class="n">rI_tj</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rE_tj</span><span class="p">,</span> <span class="n">rI_tj</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

  <span class="c1"># vector field</span>
  <span class="n">EI_grid_E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
  <span class="n">EI_grid_I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">EI_grid_E</span><span class="p">,</span> <span class="n">EI_grid_I</span><span class="p">)</span>
  <span class="n">drEdt</span><span class="p">,</span> <span class="n">drIdt</span> <span class="o">=</span> <span class="n">EIderivs</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">rI</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
  <span class="n">n_skip</span> <span class="o">=</span> <span class="mi">2</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">rE</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span> <span class="n">rI</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span>
              <span class="n">drEdt</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span> <span class="n">drIdt</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span>
              <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\tau_I=$&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1"> ms&#39;</span> <span class="o">%</span> <span class="n">tau_i</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>  <span class="c1"># sample E/I trajectories</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rE_init&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rI_init&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rE</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$r_E$&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$r_I$&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t (ms)&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Activity&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\tau_I=$&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1"> ms&#39;</span> <span class="o">%</span> <span class="n">tau_i</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">_</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">time_constant_effect</span><span class="p">,</span> <span class="n">tau_i</span><span class="o">=</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">.1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Both <span class="math notranslate nohighlight">\(\tau_E\)</span> and <span class="math notranslate nohighlight">\(\tau_I\)</span> feature in the Jacobian of the two population network (eq 7). So here is seems that the by increasing <span class="math notranslate nohighlight">\(\tau_I\)</span> the eigenvalues corresponding to the stable fixed point are becoming complex.</p>
<p>Intuitively, when <span class="math notranslate nohighlight">\(\tau_I\)</span> is smaller, inhibitory activity changes faster than excitatory activity. As inhibition exceeds above a certain value, high inhibition inhibits excitatory population but that in turns means that inhibitory population gets smaller input (from the exc. connection). So inhibition decreases rapidly. But this means that excitation recovers – and so on …</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="bonus-2-inhibition-stabilized-network-isn">
<h1>Bonus 2: Inhibition-stabilized network (ISN)<a class="headerlink" href="#bonus-2-inhibition-stabilized-network-isn" title="Permalink to this headline">¶</a></h1>
<p>As described above, one can obtain the linear approximation around the fixed point as</p>
<div class="amsmath math notranslate nohighlight" id="equation-fcdf37bb-d6a5-454e-99d1-6c200fba1226">
<span class="eqno">(159)<a class="headerlink" href="#equation-fcdf37bb-d6a5-454e-99d1-6c200fba1226" title="Permalink to this equation">¶</a></span>\[\begin{equation}
   \frac{d}{dr}  \vec{R}=
  \left[ {\begin{array}{cc}
   \displaystyle{\frac{\partial G_E}{\partial r_E}} &amp; \displaystyle{\frac{\partial G_E}{\partial r_I}}\\[1mm]
   \displaystyle\frac{\partial G_I}{\partial r_E} &amp; \displaystyle\frac{\partial G_I}{\partial r_I} \\
  \end{array} } \right] \vec{R},
\end{equation}\]</div>
<p>\</p>
<p>where <span class="math notranslate nohighlight">\(\vec{R} = [r_E, r_I]^{\rm T}\)</span> is the vector of the E/I activity.</p>
<p>Let’s direct our attention to the excitatory subpopulation which follows:</p>
<p>\</p>
<div class="amsmath math notranslate nohighlight" id="equation-4c674db5-27b6-4f85-86fc-501d933804d5">
<span class="eqno">(160)<a class="headerlink" href="#equation-4c674db5-27b6-4f85-86fc-501d933804d5" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{dr_E}{dt} = \frac{\partial G_E}{\partial r_E}\cdot r_E + \frac{\partial G_E}{\partial r_I} \cdot r_I
\end{equation}\]</div>
<p>\</p>
<p>Recall that, around fixed point <span class="math notranslate nohighlight">\((r_E^*, r_I^*)\)</span>:</p>
<p>\</p>
<div class="amsmath math notranslate nohighlight" id="equation-0e059b00-a0c7-40ac-82ae-f6c3751023d3">
<span class="eqno">(161)<a class="headerlink" href="#equation-0e059b00-a0c7-40ac-82ae-f6c3751023d3" title="Permalink to this equation">¶</a></span>\[\begin{align}
&amp;\frac{\partial}{\partial r_E}G_E(r_E^*, r_I^*) = \frac{1}{\tau_E} [-1 + w_{EE} F'_{E}(w_{EE}r_E^* -w_{EI}r_I^* + I^{\text{ext}}_E; \alpha_E, \theta_E)] \qquad (8)\\[1mm]
&amp;\frac{\partial}{\partial r_I}G_E(r_E^*, r_I^*) = \frac{1}{\tau_E} [-w_{EI} F'_{E}(w_{EE}r_E^* -w_{EI}r_I^* + I^{\text{ext}}_E; \alpha_E, \theta_E)] \qquad (9)\\[1mm]
&amp;\frac{\partial}{\partial r_E}G_I(r_E^*, r_I^*) = \frac{1}{\tau_I} [w_{IE} F'_{I}(w_{IE}r_E^* -w_{II}r_I^* + I^{\text{ext}}_I; \alpha_I, \theta_I)] \qquad (10)\\[1mm]
&amp;\frac{\partial}{\partial r_I}G_I(r_E^*, r_I^*) = \frac{1}{\tau_I} [-1-w_{II} F'_{I}(w_{IE}r_E^* -w_{II}r_I^* + I^{\text{ext}}_I; \alpha_I, \theta_I)] \qquad (11)
\end{align}\]</div>
<p>From Equation. (8), it is clear that <span class="math notranslate nohighlight">\(\displaystyle{\frac{\partial G_E}{\partial r_I}}\)</span> is negative since the <span class="math notranslate nohighlight">\(\displaystyle{\frac{dF}{dx}}\)</span> is always positive. It can be understood by that the recurrent inhibition from the inhibitory activity (<span class="math notranslate nohighlight">\(I\)</span>) can reduce the excitatory (<span class="math notranslate nohighlight">\(E\)</span>) activity. However, as described above, <span class="math notranslate nohighlight">\(\displaystyle{\frac{\partial G_E}{\partial r_E}}\)</span> has negative terms related to the “leak” effect, and positive term related to the recurrent excitation. Therefore, it leads to two different regimes:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\displaystyle{\frac{\partial}{\partial r_E}G_E(r_E^*, r_I^*)}&lt;0\)</span>, <strong>noninhibition-stabilized
network (non-ISN) regime</strong></p></li>
<li><p><span class="math notranslate nohighlight">\(\displaystyle{\frac{\partial}{\partial r_E}G_E(r_E^*, r_I^*)}&gt;0\)</span>, <strong>inhibition-stabilized
network (ISN) regime</strong></p></li>
</ul>
<div class="section" id="exercise-8-compute-displaystyle-frac-partial-g-e-partial-r-e">
<h2>Exercise 8: Compute <span class="math notranslate nohighlight">\(\displaystyle{\frac{\partial G_E}{\partial r_E}}\)</span><a class="headerlink" href="#exercise-8-compute-displaystyle-frac-partial-g-e-partial-r-e" title="Permalink to this headline">¶</a></h2>
<p>Implemet the function to calculate the <span class="math notranslate nohighlight">\(\displaystyle{\frac{\partial G_E}{\partial r_E}}\)</span> for the default parameters, and the parameters of the limit cycle case.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_dGdE</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">tau_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">,</span> <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="p">,</span> <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Simulate the Wilson-Cowan equations</span>

<span class="sd">  Args:</span>
<span class="sd">    fp   : fixed point (E, I), array</span>
<span class="sd">    Other arguments are parameters of the Wilson-Cowan model</span>

<span class="sd">  Returns:</span>
<span class="sd">    J    : the 2x2 Jacobian matrix</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">fp</span>

  <span class="c1">##########################################################################</span>
  <span class="c1"># TODO for students: compute dGdrE and disable the error</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student excercise: compute the dG/dE, Eq. (13)&quot;</span><span class="p">)</span>
  <span class="c1">##########################################################################</span>
  <span class="c1"># Calculate the J[0,0]</span>
  <span class="n">dGdrE</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">dGdrE</span>


<span class="c1"># Uncomment below to test your function</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>
<span class="n">x_fp_1</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">x_fp_2</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="n">x_fp_3</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>

<span class="c1"># dGdrE1 = get_dGdE(x_fp_1, **pars)</span>
<span class="c1"># dGdrE2 = get_dGdE(x_fp_2, **pars)</span>
<span class="c1"># dGdrE3 = get_dGdE(x_fp_3, **pars)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;For the default case:&#39;</span><span class="p">)</span>
<span class="c1"># print(f&#39;dG/drE(fp1) = {dGdrE1:.3f}&#39;)</span>
<span class="c1"># print(f&#39;dG/drE(fp2) = {dGdrE2:.3f}&#39;)</span>
<span class="c1"># print(f&#39;dG/drE(fp3) = {dGdrE3:.3f}&#39;)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">wEE</span><span class="o">=</span><span class="mf">6.4</span><span class="p">,</span> <span class="n">wEI</span><span class="o">=</span><span class="mf">4.8</span><span class="p">,</span> <span class="n">wIE</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">wII</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">x_fp_lc</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>

<span class="c1"># dGdrE_lc = get_dGdE(x_fp_lc, **pars)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;For the limit cycle case:&#39;</span><span class="p">)</span>
<span class="c1"># print(f&#39;dG/drE(fp_lc) = {dGdrE_lc:.3f}&#39;)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>SAMPLE OUTPUT</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">For</span> <span class="n">the</span> <span class="n">default</span> <span class="n">case</span><span class="p">:</span>
<span class="n">dG</span><span class="o">/</span><span class="n">drE</span><span class="p">(</span><span class="n">fp1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.650</span>
<span class="n">dG</span><span class="o">/</span><span class="n">drE</span><span class="p">(</span><span class="n">fp2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.519</span>
<span class="n">dG</span><span class="o">/</span><span class="n">drE</span><span class="p">(</span><span class="n">fp3</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.706</span>


<span class="n">For</span> <span class="n">the</span> <span class="n">limit</span> <span class="n">cycle</span> <span class="n">case</span><span class="p">:</span>
<span class="n">dG</span><span class="o">/</span><span class="n">drE</span><span class="p">(</span><span class="n">fp_lc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.837</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D4_DynamicNetworks/solutions/W2D4_Tutorial2_Solution_1ff7a08c.py"><em>Click for solution</em></a></p>
</div>
<div class="section" id="nullcline-analysis-of-the-isn">
<h2>Nullcline analysis of the ISN<a class="headerlink" href="#nullcline-analysis-of-the-isn" title="Permalink to this headline">¶</a></h2>
<p>Recall that the E nullcline follows</p>
<p>\</p>
<div class="amsmath math notranslate nohighlight" id="equation-b50db40a-1cc2-4c40-a007-7ea24b516e7d">
<span class="eqno">(162)<a class="headerlink" href="#equation-b50db40a-1cc2-4c40-a007-7ea24b516e7d" title="Permalink to this equation">¶</a></span>\[\begin{align}
r_E = F_E(w_{EE}r_E -w_{EI}r_I + I^{\text{ext}}_E;a_E,\theta_E). 
\end{align}\]</div>
<p>\</p>
<p>That is, the firing rate <span class="math notranslate nohighlight">\(r_E\)</span> can be a function of <span class="math notranslate nohighlight">\(r_I\)</span>. Let’s take the derivative of <span class="math notranslate nohighlight">\(r_E\)</span> over <span class="math notranslate nohighlight">\(r_I\)</span>, and obtain</p>
<p>\</p>
<div class="amsmath math notranslate nohighlight" id="equation-db207205-c8d5-46df-be0f-29732e1e6f62">
<span class="eqno">(163)<a class="headerlink" href="#equation-db207205-c8d5-46df-be0f-29732e1e6f62" title="Permalink to this equation">¶</a></span>\[\begin{align}
&amp;\frac{dr_E}{dr_I} = F_E' \cdot (w_{EE}\frac{dr_E}{dr_I} -w_{EI}) \iff \\
&amp;(1-F_E'w_{EE})\frac{dr_E}{dr_I} = -F_E' w_{EI} \iff \\
&amp;\frac{dr_E}{dr_I} = \frac{F_E' w_{EI}}{F_E'w_{EE}-1}.
\end{align}\]</div>
<p>\</p>
<p>That is, in the phase plane <code class="docutils literal notranslate"><span class="pre">rI-rE</span></code>-plane, we can obtain the slope along the E nullcline as</p>
<p>\</p>
<div class="math notranslate nohighlight">
\[\frac{dr_I}{dr_E} = \frac{F_E'w_{EE}-1}{F_E' w_{EI}} \qquad (12)\]</div>
<p>Similarly, we can obtain the slope along the I nullcline as</p>
<p>\</p>
<div class="math notranslate nohighlight">
\[\frac{dr_I}{dr_E} = \frac{F_I'w_{IE}}{F_I' w_{II}+1} \qquad (13)\]</div>
<p>\</p>
<p>Then, we can find that <span class="math notranslate nohighlight">\(\Big{(} \displaystyle{\frac{dr_I}{dr_E}} \Big{)}_{\rm I-nullcline} &gt;0\)</span> in Equation (13).</p>
<p>\</p>
<p>However, in Equation (12), the sign of <span class="math notranslate nohighlight">\(\Big{(} \displaystyle{\frac{dr_I}{dr_E}} \Big{)}_{\rm E-nullcline}\)</span> depends on the sign of <span class="math notranslate nohighlight">\((F_E'w_{EE}-1)\)</span>. Note that, <span class="math notranslate nohighlight">\((F_E'w_{EE}-1)\)</span> is the same as what we show above (Equation (8)). Therefore, we can have the following results:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Big{(} \displaystyle{\frac{dr_I}{dr_E}} \Big{)}_{\rm E-nullcline}&lt;0\)</span>, <strong>noninhibition-stabilized
network (non-ISN) regime</strong></p></li>
<li><p><span class="math notranslate nohighlight">\(\Big{(} \displaystyle{\frac{dr_I}{dr_E}} \Big{)}_{\rm E-nullcline}&gt;0\)</span>, <strong>inhibition-stabilized
network (ISN) regime</strong></p></li>
</ul>
<p>\</p>
<p>In addition, it is important to point out the following two conclusions: \</p>
<p><strong>Conclusion 1:</strong> The stability of a fixed point can determine the relationship between the slopes Equations (12) and (13). As discussed above, the fixed point is stable when the Jacobian matrix (<span class="math notranslate nohighlight">\(J\)</span> in Equation (7)) has two eigenvalues with a negative real part, which indicates a positive determinant of <span class="math notranslate nohighlight">\(J\)</span>, i.e., <span class="math notranslate nohighlight">\(\text{det}(J)&gt;0\)</span>.</p>
<p>From the Jacobian matrix definition and from Equations (8-11), we can obtain:</p>
<p><span class="math notranslate nohighlight">\(   J=
  \left[ {\begin{array}{cc}
   \displaystyle{\frac{1}{\tau_E}(w_{EE}F_E'-1)} &amp; \displaystyle{-\frac{1}{\tau_E}w_{EI}F_E'}\\[1mm]
   \displaystyle {\frac{1}{\tau_I}w_{IE}F_I'}&amp; \displaystyle {\frac{1}{\tau_I}(-w_{II}F_I'-1)} \\
  \end{array} } \right] \)</span></p>
<p>\</p>
<p>Note that, if we let</p>
<p>\</p>
<p><span class="math notranslate nohighlight">\(   T=
  \left[ {\begin{array}{cc}
   \displaystyle{\tau_E} &amp; \displaystyle{0}\\[1mm]
   \displaystyle 0&amp; \displaystyle \tau_I \\
  \end{array} } \right] \)</span>,
<span class="math notranslate nohighlight">\(   F=
  \left[ {\begin{array}{cc}
   \displaystyle{F_E'} &amp; \displaystyle{0}\\[1mm]
   \displaystyle 0&amp; \displaystyle F_I' \\
  \end{array} } \right] \)</span>, and
<span class="math notranslate nohighlight">\(   W=
  \left[ {\begin{array}{cc}
   \displaystyle{w_{EE}} &amp; \displaystyle{-w_{EI}}\\[1mm]
   \displaystyle w_{IE}&amp; \displaystyle -w_{II} \\
  \end{array} } \right] \)</span></p>
<p>\</p>
<p>then, using matrix notation, <span class="math notranslate nohighlight">\(J=T^{-1}(F W - I)\)</span> where <span class="math notranslate nohighlight">\(I\)</span> is the identity matrix, i.e., <span class="math notranslate nohighlight">\(I = \begin{bmatrix} 
1 &amp; 0 \\
0 &amp; 1 
\end{bmatrix}.\)</span></p>
<p>\</p>
<p>Therefore, <span class="math notranslate nohighlight">\(\det{(J)}=\det{(T^{-1}(F W - I))}=(\det{(T^{-1})})(\det{(F W - I)}).\)</span></p>
<p>Since <span class="math notranslate nohighlight">\(\det{(T^{-1})}&gt;0\)</span>, as time constants are positive by definition, the sign of <span class="math notranslate nohighlight">\(\det{(J)}\)</span> is the same as the sign of <span class="math notranslate nohighlight">\(\det{(F W - I)}\)</span>, and so</p>
<div class="math notranslate nohighlight">
\[\det{(FW - I)} = (F_E' w_{EI})(F_I'w_{IE}) - (F_I' w_{II} + 1)(F_E'w_{EE} - 1) &gt; 0.\]</div>
<p>\</p>
<p>Then, combining this with Equations (12) and (13), we can obtain
$<span class="math notranslate nohighlight">\(\frac{\Big{(} \displaystyle{\frac{dr_I}{dr_E}} \Big{)}_{\rm I-nullcline}}{\Big{(} \displaystyle{\frac{dr_I}{dr_E}} \Big{)}_{\rm E-nullcline}} &gt; 1. \)</span>$</p>
<p>Therefore, at the stable fixed point, I nullcline has a steeper slope than the E nullcline.</p>
<p><strong>Conclusion 2:</strong> Effect of adding input to the inhibitory population.</p>
<p>While adding the input <span class="math notranslate nohighlight">\(\delta I^{\rm ext}_I\)</span> into the inhibitory population, we can find that the E nullcline (Equation (5)) stays the same, while the I nullcline has a pure left shift: the original I nullcline equation,</p>
<p>\</p>
<div class="amsmath math notranslate nohighlight" id="equation-2488192c-fbc8-47a7-a261-77f6ce129b11">
<span class="eqno">(164)<a class="headerlink" href="#equation-2488192c-fbc8-47a7-a261-77f6ce129b11" title="Permalink to this equation">¶</a></span>\[\begin{equation}
r_I = F_I(w_{IE}r_E-w_{II}r_I + I^{\text{ext}}_I ; \alpha_I, \theta_I)
\end{equation}\]</div>
<p>\</p>
<p>remains true if we take <span class="math notranslate nohighlight">\(I^{\text{ext}}_I \rightarrow I^{\text{ext}}_I +\delta I^{\rm ext}_I\)</span> and <span class="math notranslate nohighlight">\(r_E\rightarrow r_E'=r_E-\frac{\delta I^{\rm ext}_I}{w_{IE}}\)</span> to obtain</p>
<p>\</p>
<div class="amsmath math notranslate nohighlight" id="equation-5d59505f-8e82-4aee-9a61-23277e8604d5">
<span class="eqno">(165)<a class="headerlink" href="#equation-5d59505f-8e82-4aee-9a61-23277e8604d5" title="Permalink to this equation">¶</a></span>\[\begin{equation}
r_I = F_I(w_{IE}r_E'-w_{II}r_I + I^{\text{ext}}_I +\delta I^{\rm ext}_I; \alpha_I, \theta_I)
\end{equation}\]</div>
<p>\</p>
<p>Putting these points together, we obtain the phase plane pictures shown below. After adding input to the inhibitory population, it can be seen in the trajectories above and the phase plane below that, in an <strong>ISN</strong>, <span class="math notranslate nohighlight">\(r_I\)</span> will increase first but then decay to the new fixed point in which both <span class="math notranslate nohighlight">\(r_I\)</span> and <span class="math notranslate nohighlight">\(r_E\)</span> are decreased compared to the original fixed point. However, by adding <span class="math notranslate nohighlight">\(\delta I^{\rm ext}_I\)</span> into a <strong>non-ISN</strong>, <span class="math notranslate nohighlight">\(r_I\)</span> will increase while <span class="math notranslate nohighlight">\(r_E\)</span> will decrease.</p>
</div>
<div class="section" id="interactive-demo-nullclines-of-example-isn-and-non-isn">
<h2>Interactive Demo: Nullclines of Example <strong>ISN</strong> and <strong>non-ISN</strong><a class="headerlink" href="#interactive-demo-nullclines-of-example-isn-and-non-isn" title="Permalink to this headline">¶</a></h2>
<p>In this interactive widget, we inject excitatory (<span class="math notranslate nohighlight">\(I^{\text{ext}}_I&gt;0\)</span>) or inhibitory (<span class="math notranslate nohighlight">\(I^{\text{ext}}_I&lt;0\)</span>) drive into the inhibitory population when the system is at its equilibrium (with parameters <span class="math notranslate nohighlight">\(w_{EE}=6.4\)</span>, <span class="math notranslate nohighlight">\(w_{EI}=4.8\)</span>, <span class="math notranslate nohighlight">\(w_{IE}=6.\)</span>, <span class="math notranslate nohighlight">\(w_{II}=1.2\)</span>, <span class="math notranslate nohighlight">\(I_{E}^{\text{ext}}=0.8\)</span>, <span class="math notranslate nohighlight">\(\tau_I = 0.8\)</span>, and <span class="math notranslate nohighlight">\(I^{\text{ext}}_I=0\)</span>). How does the firing rate of the <span class="math notranslate nohighlight">\(I\)</span> population changes with excitatory vs inhibitory drive into the inhibitory population?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mf">50.</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wEE&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wEI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wIE&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;wII&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">1.2</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;I_ext_E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;tau_I&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.8</span>


<span class="k">def</span> <span class="nf">ISN_I_perturb</span><span class="p">(</span><span class="n">dI</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">])</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;I_ext_I&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;I_ext_I&#39;</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">Lt</span> <span class="o">/</span> <span class="mi">2</span><span class="p">):]</span> <span class="o">=</span> <span class="n">dI</span>

  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rE_init&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rI_init&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.26</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">))</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;I_ext_I&#39;</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t (ms)&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$I_I^{\mathrm</span><span class="si">{ext}</span><span class="s1">}$&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;I_ext_I&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;I_ext_I&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rE</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$r_E$&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rE</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">Lt</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Lt</span><span class="p">),</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$r_I$&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rI</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">Lt</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Lt</span><span class="p">),</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t (ms)&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Activity&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">_</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">ISN_I_perturb</span><span class="p">,</span> <span class="n">dI</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">,</span> <span class="mf">.05</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D4_DynamicNetworks/solutions/W2D4_Tutorial2_Solution_cec4906e.py"><em>Click for solution</em></a></p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="bonus-3-fixed-point-and-working-memory">
<h1>Bonus 3: Fixed point and working memory<a class="headerlink" href="#bonus-3-fixed-point-and-working-memory" title="Permalink to this headline">¶</a></h1>
<p>The input into the neurons measured in the experiment is often very noisy (<a class="reference external" href="http://www.scholarpedia.org/article/Stochastic_dynamical_systems">links</a>). Here, the noisy synaptic input current is modeled as an Ornstein-Uhlenbeck (OU)process, which has been discussed several times in the previous tutorials.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Make sure you execute this cell to enable the function my_OU and plot the input current!</span>


<span class="k">def</span> <span class="nf">my_OU</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Expects:</span>
<span class="sd">  pars       : parameter dictionary</span>
<span class="sd">  sig        : noise amplitute</span>
<span class="sd">  myseed     : random seed. int or boolean</span>

<span class="sd">  Returns:</span>
<span class="sd">  I          : Ornstein-Uhlenbeck input current</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="c1"># Retrieve simulation parameters</span>
  <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">]</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>
  <span class="n">tau_ou</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;tau_ou&#39;</span><span class="p">]</span>  <span class="c1"># [ms]</span>

  <span class="c1"># set random seed</span>
  <span class="k">if</span> <span class="n">myseed</span><span class="p">:</span>
      <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">myseed</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
      <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">()</span>

  <span class="c1"># Initialize</span>
  <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">I_ou</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">I_ou</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">noise</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">sig</span>

  <span class="c1"># generate OU</span>
  <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Lt</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
      <span class="n">I_ou</span><span class="p">[</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">I_ou</span><span class="p">[</span><span class="n">it</span><span class="p">]</span>
                    <span class="o">+</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">tau_ou</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.</span> <span class="o">-</span> <span class="n">I_ou</span><span class="p">[</span><span class="n">it</span><span class="p">])</span>
                    <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">tau_ou</span><span class="p">)</span> <span class="o">*</span> <span class="n">sig</span> <span class="o">*</span> <span class="n">noise</span><span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
  <span class="k">return</span> <span class="n">I_ou</span>


<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;tau_ou&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>  <span class="c1"># [ms]</span>
<span class="n">sig_ou</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">I_ou</span> <span class="o">=</span> <span class="n">my_OU</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="n">sig_ou</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">I_ou</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$I_{\mathrm</span><span class="si">{OU}</span><span class="s1">}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>With the default parameters, the system fluctuates around a resting state with the noisy input.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Execute this cell to plot activity with noisy input current</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;tau_ou&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>  <span class="c1"># [ms]</span>
<span class="n">sig_ou</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;I_ext_E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_OU</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="n">sig_ou</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="mi">20201</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;I_ext_I&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_OU</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="n">sig_ou</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="mi">20202</span><span class="p">)</span>

<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rE_init&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rI_init&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span>
<span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rE</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E population&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I population&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t (ms)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Activity&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="interactive-demo-short-pulse-induced-persistent-activity">
<h2>Interactive Demo: Short pulse induced persistent activity<a class="headerlink" href="#interactive-demo-short-pulse-induced-persistent-activity" title="Permalink to this headline">¶</a></h2>
<p>Then, let’s use a brief 10-ms positive current to the E population when the system is at its equilibrium. When this amplitude (SE below) is sufficiently large, a persistent activity is produced that outlasts the transient input. What is the firing rate of the persistent activity, and what is the critical input strength? Try to understand the phenomena from the above phase-plane analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>


<span class="k">def</span> <span class="nf">my_inject</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">t_start</span><span class="p">,</span> <span class="n">t_lag</span><span class="o">=</span><span class="mf">10.</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Expects:</span>
<span class="sd">  pars       : parameter dictionary</span>
<span class="sd">  t_start    : pulse starts [ms]</span>
<span class="sd">  t_lag      : pulse lasts  [ms]</span>

<span class="sd">  Returns:</span>
<span class="sd">  I          : extra pulse time</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="c1"># Retrieve simulation parameters</span>
  <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">]</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>

  <span class="c1"># Initialize</span>
  <span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>

  <span class="c1"># pulse timing</span>
  <span class="n">N_start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_start</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
  <span class="n">N_lag</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_lag</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
  <span class="n">I</span><span class="p">[</span><span class="n">N_start</span><span class="p">:</span><span class="n">N_start</span> <span class="o">+</span> <span class="n">N_lag</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

  <span class="k">return</span> <span class="n">I</span>


<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;tau_ou&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>  <span class="c1"># [ms]</span>
<span class="n">sig_ou</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;I_ext_I&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_OU</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="n">sig_ou</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="mi">2021</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rE_init&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;rI_init&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span>

<span class="c1"># pulse</span>
<span class="n">I_pulse</span> <span class="o">=</span> <span class="n">my_inject</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">t_start</span><span class="o">=</span><span class="mf">20.</span><span class="p">,</span> <span class="n">t_lag</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">L_pulse</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">I_pulse</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">WC_with_pulse</span><span class="p">(</span><span class="n">SE</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;I_ext_E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_OU</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="n">sig_ou</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="mi">2022</span><span class="p">)</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;I_ext_E&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">SE</span> <span class="o">*</span> <span class="n">I_pulse</span>

  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
  <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rE</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E population&#39;</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I population&#39;</span><span class="p">)</span>

  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">][</span><span class="n">I_pulse</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">],</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">L_pulse</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">3.</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="s1">&#39;stimulus on&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
          <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t (ms)&#39;</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Activity&#39;</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">_</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">WC_with_pulse</span><span class="p">,</span> <span class="n">SE</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">.05</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D4_DynamicNetworks/solutions/W2D4_Tutorial2_Solution_242e6b8c.py"><em>Click for solution</em></a></p>
<p>Explore what happened when a second, brief current is applied to the inhibitory population.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials/W2D4_DynamicNetworks/student"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="W2D4_Tutorial1.html" title="previous page">Tutorial 1: Neural Rate Models</a>
    <a class='right-next' id="next-link" href="../outro_vid.html" title="next page">Outro Video</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Neuromatch<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>