
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tutorial 3: Numerical Methods &#8212; Neuromatch Computational Neuroscience</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Statistics" href="../../W0D5_Statistics/chapter_title.html" />
    <link rel="prev" title="Tutorial 2: Differential Equations" href="W0D4_Tutorial2.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      <img src="../../../_static/nma-logo-square-4xp.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Neuromatch Computational Neuroscience</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../intro.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Pre-reqs Refresher
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W0D1_PythonWorkshop1/chapter_title.html">
   Python Workshop 1 (W0D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W0D1_PythonWorkshop1/student/W0D1_Tutorial1.html">
     Tutorial: LIF Neuron - Part I
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W0D2_PythonWorkshop2/chapter_title.html">
   Python Workshop 2 (W0D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W0D2_PythonWorkshop2/student/W0D2_Tutorial1.html">
     Tutorial 1: LIF Neuron Part II
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W0D3_LinearAlgebra/chapter_title.html">
   Linear Algebra (W0D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W0D3_LinearAlgebra/student/W0D3_Tutorial1.html">
     Tutorial 1: Vectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W0D3_LinearAlgebra/student/W0D3_Tutorial2.html">
     Tutorial 2: Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W0D3_LinearAlgebra/student/W0D3_Tutorial3.html">
     Bonus Tutorial: Discrete Dynamical Systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../chapter_title.html">
   Calculus (W0D4)
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="W0D4_Tutorial1.html">
     Tutorial 1: Basics of Differential and Integral Calculus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="W0D4_Tutorial2.html">
     Tutorial 2: Differential Equations
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Tutorial 3: Numerical Methods
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W0D5_Statistics/chapter_title.html">
   Statistics (W0D5)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W0D5_Statistics/student/W0D5_Tutorial1.html">
     Neuromatch Academy: Precourse Week, Day 5, Tutorial 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W0D5_Statistics/student/W0D5_Tutorial2.html">
     Tutorial 2: Statistical Inference
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Intro to Modeling
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D1_ModelTypes/chapter_title.html">
   Model Types (W1D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D1_ModelTypes/W1D1_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D1_ModelTypes/student/W1D1_Tutorial1.html">
     Tutorial 1: “What” models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D1_ModelTypes/student/W1D1_Tutorial2.html">
     Tutorial 2: “How” models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D1_ModelTypes/student/W1D1_Tutorial3.html">
     Tutorial 3: “Why” models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D1_ModelTypes/W1D1_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D1_ModelTypes/further_reading.html">
     Suggested further readings
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D2_ModelingPractice/chapter_title.html">
   Modeling Practice (W1D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D2_ModelingPractice/W1D2_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D2_ModelingPractice/student/W1D2_Tutorial1.html">
     Tutorial: Framing the Question
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D2_ModelingPractice/W1D2_Outro.html">
     Outro
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D3_ModelFitting/chapter_title.html">
   Model Fitting (W1D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_ModelFitting/W1D3_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial1.html">
     Tutorial 1: Linear regression with MSE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial2.html">
     Tutorial 2: Linear regression with MLE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial3.html">
     Tutorial 3: Confidence intervals and bootstrapping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial4.html">
     Tutorial 4: Multiple linear regression and polynomial regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial5.html">
     Tutorial 5: Model Selection: Bias-variance trade-off
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial6.html">
     Tutorial 6: Model Selection: Cross-validation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_ModelFitting/W1D3_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_ModelFitting/further_reading.html">
     Suggested further readings
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D4_GeneralizedLinearModels/chapter_title.html">
   Generalized Linear Models (W1D4)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D4_GeneralizedLinearModels/W1D4_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D4_GeneralizedLinearModels/student/W1D4_Tutorial1.html">
     Tutorial 1: GLMs for Encoding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D4_GeneralizedLinearModels/student/W1D4_Tutorial2.html">
     Tutorial 2: Classifiers and regularizers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D4_GeneralizedLinearModels/W1D4_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D4_GeneralizedLinearModels/further_reading.html">
     Suggested further readings
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D5_DimensionalityReduction/chapter_title.html">
   Dimensionality Reduction (W1D5)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D5_DimensionalityReduction/W1D5_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D5_DimensionalityReduction/student/W1D5_Tutorial1.html">
     Tutorial 1: Geometric view of data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D5_DimensionalityReduction/student/W1D5_Tutorial2.html">
     Tutorial 2: Principal Component Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D5_DimensionalityReduction/student/W1D5_Tutorial3.html">
     Tutorial 3: Dimensionality Reduction &amp; Reconstruction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D5_DimensionalityReduction/student/W1D5_Tutorial4.html">
     Tutorial 4:  Nonlinear Dimensionality Reduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D5_DimensionalityReduction/W1D5_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D5_DimensionalityReduction/further_reading.html">
     Suggested further readings
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D1_DeepLearning/chapter_title.html">
   Deep Learning (W2D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D1_DeepLearning/W2D1_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D1_DeepLearning/student/W2D1_Tutorial1.html">
     Tutorial 1: Decoding Neural Responses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D1_DeepLearning/student/W2D1_Tutorial2.html">
     Tutorial 2: Convolutional Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D1_DeepLearning/student/W2D1_Tutorial3.html">
     Tutorial 2: Building and Evaluating Normative Encoding Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D1_DeepLearning/W2D1_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D1_DeepLearning/further_reading.html">
     Suggested further readings
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Dynamical Systems
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D2_LinearSystems/chapter_title.html">
   Linear Systems (W2D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_LinearSystems/W2D2_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_LinearSystems/student/W2D2_Tutorial1.html">
     Tutorial 1: Linear dynamical systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_LinearSystems/student/W2D2_Tutorial2.html">
     Tutorial 2: Markov Processes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_LinearSystems/student/W2D2_Tutorial3.html">
     Tutorial 3: Combining determinism and stochasticity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_LinearSystems/student/W2D2_Tutorial4.html">
     Tutorial 4: Autoregressive models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_LinearSystems/W2D2_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_LinearSystems/further_reading.html">
     Suggested further readings
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D3_BiologicalNeuronModels/chapter_title.html">
   Biological Neuron Models (W2D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D3_BiologicalNeuronModels/W2D3_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D3_BiologicalNeuronModels/student/W2D3_Tutorial1.html">
     Tutorial 1: The Leaky Integrate-and-Fire (LIF) Neuron Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D3_BiologicalNeuronModels/student/W2D3_Tutorial2.html">
     Tutorial 2: Effects of Input Correlation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D3_BiologicalNeuronModels/student/W2D3_Tutorial3.html">
     Tutorial 3: Synaptic transmission - Models of static and dynamic synapses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D3_BiologicalNeuronModels/student/W2D3_Tutorial4.html">
     Tutorial 4: Spike-timing dependent plasticity (STDP)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D3_BiologicalNeuronModels/W2D3_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D3_BiologicalNeuronModels/further_reading.html">
     Suggested further readings
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D4_DynamicNetworks/chapter_title.html">
   Dynamic Networks (W2D4)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D4_DynamicNetworks/W2D4_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D4_DynamicNetworks/student/W2D4_Tutorial1.html">
     Tutorial 1: Neural Rate Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D4_DynamicNetworks/student/W2D4_Tutorial2.html">
     Tutorial 2: Wilson-Cowan Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D4_DynamicNetworks/W2D4_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D4_DynamicNetworks/further_reading.html">
     Suggested further readings
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Stochastic Processes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D1_BayesianDecisions/chapter_title.html">
   Bayesian Decisions (W3D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_BayesianDecisions/W3D1_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_BayesianDecisions/student/W3D1_Tutorial1.html">
     Tutorial 1: Bayes with a binary hidden state
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_BayesianDecisions/student/W3D1_Tutorial2.html">
     Tutorial 2: Bayesian inference and decisions with continuous hidden state
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_BayesianDecisions/student/W3D1_Tutorial3.html">
     Bonus Tutorial:Fitting to data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_BayesianDecisions/W3D1_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_BayesianDecisions/further_reading.html">
     Suggested further readings
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D2_HiddenDynamics/chapter_title.html">
   Hidden Dynamics (W3D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D2_HiddenDynamics/W3D2_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D2_HiddenDynamics/student/W3D2_Tutorial1.html">
     Tutorial 1: Sequential Probability Ratio Test
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D2_HiddenDynamics/student/W3D2_Tutorial2.html">
     Tutorial 2: Hidden Markov Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D2_HiddenDynamics/student/W3D2_Tutorial3.html">
     Tutorial 3: 1D Kalman Filter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D2_HiddenDynamics/student/W3D2_Tutorial4.html">
     Tutorial 4: 2D Kalman Filter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D2_HiddenDynamics/W3D2_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D2_HiddenDynamics/further_reading.html">
     Suggested further readings
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D3_OptimalControl/chapter_title.html">
   Optimal Control (W3D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D3_OptimalControl/W3D3_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D3_OptimalControl/student/W3D3_Tutorial1.html">
     Tutorial 1: Optimal Control for Discrete States
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D3_OptimalControl/student/W3D3_Tutorial2.html">
     Tutorial 2: Optimal Control for Continuous State
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D3_OptimalControl/W3D3_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D3_OptimalControl/further_reading.html">
     Suggested further readings
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D4_ReinforcementLearning/chapter_title.html">
   Reinforcement Learning (W3D4)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D4_ReinforcementLearning/W3D4_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D4_ReinforcementLearning/student/W3D4_Tutorial1.html">
     Tutorial 1: Learning to Predict
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D4_ReinforcementLearning/student/W3D4_Tutorial2.html">
     Tutorial 2: Learning to Act: Multi-Armed Bandits
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D4_ReinforcementLearning/student/W3D4_Tutorial3.html">
     Tutorial 3: Learning to Act: Q-Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D4_ReinforcementLearning/student/W3D4_Tutorial4.html">
     Tutorial 4: From Reinforcement Learning to Planning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D4_ReinforcementLearning/W3D4_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D4_ReinforcementLearning/further_reading.html">
     Suggested further readings
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D5_NetworkCausality/chapter_title.html">
   Network Causality (W3D5)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_NetworkCausality/W3D5_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_NetworkCausality/student/W3D5_Tutorial1.html">
     Tutorial 1: Interventions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_NetworkCausality/student/W3D5_Tutorial2.html">
     Tutorial 2: Correlations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_NetworkCausality/student/W3D5_Tutorial3.html">
     Tutorial 3: Simultaneous fitting/regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_NetworkCausality/student/W3D5_Tutorial4.html">
     Tutorial 4: Instrumental Variables
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_NetworkCausality/W3D5_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_NetworkCausality/further_reading.html">
     Suggested further readings
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/tutorials/W0D4_Calculus/student/W0D4_Tutorial3.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/NeuromatchAcademy/course_content/blob/master/book/tutorials/W0D4_Calculus/student/W0D4_Tutorial3.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Tutorial 3: Numerical Methods
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-1-euler-method">
   Section 1 Euler Method
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-1-1-slope-of-a-line">
     Section 1.1: Slope of a line
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#interactive-demo-1-1-slope-of-a-line">
       Interactive Demo 1.1: Slope of a Line
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#think-1-1-how-does-the-size-of-dt-affect-the-approximation">
       Think! 1.1: How does the size of
       <span class="math notranslate nohighlight">
        \(dt\)
       </span>
       affect the approximation?
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-2-population-differential-equation">
   Section 2: Population Differential Equation
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-2-one-step-of-euler-method">
     Exercise 2: One step of Euler Method
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-3-euler-error">
   Section 3: Euler Error
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interactive-demo-3-euler-error">
     Interactive Demo 3: Euler Error
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#think-3-effect-of-delta-t-on-euler-error">
     Think! 3: Effect of
     <span class="math notranslate nohighlight">
      \(\Delta t\)
     </span>
     on Euler Error
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-3-1-time-steps">
     Section 3.1: Time-Steps
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-3-2-the-difference-equation">
     Section 3.2: The Difference Equation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coding-exercise-3-2-step-step-step">
       Coding Exercise 3.2: Step, step, step
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-4-generalised-euler-method">
   Section 4: Generalised Euler Method
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-5-euler-method-for-the-leaky-integrate-and-fire">
   Section 5: Euler Method for the Leaky Integrate and Fire
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#coding-exercise-5-lif-and-euler">
     Coding Exercise 5: LIF and Euler
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-5-1-sinusoidal-input-to-lif">
     Section 5.1: Sinusoidal Input to LIF
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#section-5-2-random-input-to-the-lif">
       Section 5.2: Random Input to the LIF
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-6-systems-of-differential-equations">
   Section 6: Systems of Differential Equations
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#coding-exercise-6-euler-on-a-simple-system">
     Coding Exercise 6: Euler on a Simple System
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#think-6-simple-euler-solution-to-the-wilson-cowan-model">
       Think! 6: Simple Euler Solution to the Wilson Cowan model
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-6-1-phase-plane-plot-and-nullcline">
     Section 6.1: Phase Plane Plot and Nullcline
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#think-6-1-discuss-the-plots">
       Think! 6.1: Discuss the Plots
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-7-linear-system-of-differential-equations">
   Section 7: Linear System of Differential Equations
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#coding-exercise-7-implement-euler-for-a-system-of-equations">
     Coding Exercise 7: Implement Euler for a System of Equations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#think-7-oscillations">
       Think! 7: Oscillations
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-7-1-phase-plane-and-nullclines">
     Section 7.1: Phase Plane and Nullclines
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#interactive-demo-7-1-a-small-change-changes-everything">
       Interactive Demo 7.1: A small change changes everything
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#take-home">
   Take Home
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#links-to-neuromatch-days">
   Links to Neuromatch Days
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bibliography">
   Bibliography
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#supplemental-popular-reading-list">
     Supplemental Popular Reading List
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#popular-podcast">
     Popular Podcast
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bonus-1-the-4th-order-runge-kutta">
   Bonus 1: The 4th Order Runge Kutta
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bonus-reference-1-a-full-course-on-numerical-methods-in-python">
     Bonus Reference 1: A full course on numerical methods in Python
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bonus-2-neural-oscillations-are-a-start-toward-understanding-brain-activity-rather-than-the-end">
   Bonus 2: Neural oscillations are a start toward understanding brain activity rather than the end
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bonus-2-1-what-is-an-oscillator">
     Bonus 2.1: What is an Oscillator?
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#interactive-demo-bonus-2-1">
       Interactive Demo Bonus 2.1
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bonus-2-2-not-all-oscillators-are-alike">
     Bonus 2.2 : Not all oscillators are alike
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#interactive-demo-bonus-2-stuart-landau-system">
       Interactive Demo Bonus 2: Stuart-Landau System
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bonus-reference-2">
     Bonus Reference 2
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p><a href="https://colab.research.google.com/github/NeuromatchAcademy/course-content/blob/master/tutorials/W0D4_Calculus/student/W0D4_Tutorial3.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a></p>
<div class="section" id="tutorial-3-numerical-methods">
<h1>Tutorial 3: Numerical Methods<a class="headerlink" href="#tutorial-3-numerical-methods" title="Permalink to this headline">¶</a></h1>
<p><strong>Week 0, Day 4: Calculus</strong></p>
<p><strong>By Neuromatch Academy</strong></p>
<p><strong>Content creators:</strong> John S Butler, Arvind Kumar</p>
<p><strong>Content reviewers:</strong></p>
<p><strong>Production editors:</strong></p>
</div>
<hr class="docutils" />
<div class="section" id="tutorial-objectives">
<h1>Tutorial Objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this headline">¶</a></h1>
<p>While a great deal of neuroscience can be describe by mathematics a great deal of the mathematics used cannot be solved exactly. This might seem very odd that you can writing something in mathematics that cannot be immediately solved but that is the beauty and mystery of mathematics. To side step this issue we use Numerical Methods to estimate the solution.</p>
<p>In this tutorial, we will look at the Euler method to estimate the solution of a few different differential equations, the population equation, the Leaky Integrate and Fire model and a simplified version of the Wilson-Cowan model which is a system of differential equations.</p>
<p><strong>Steps:</strong></p>
<ul class="simple">
<li><p>Code the Euler estimate of the Population Equation;</p></li>
<li><p>Investigate the impact of time step on the error of the numerical solution;</p></li>
<li><p>Code the Euler estimate of the Learky Integrate and Fire model for a constant input;</p></li>
<li><p>Visualize and listen to the response of the integrate for different inputs;</p></li>
<li><p>Apply the Euler method to estimate the soluton of a system of differential equations.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@markdown Tutorial slides</span>
<span class="c1"># you should link the slides for all tutorial videos here (we will store pdfs on osf)</span>

<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;&lt;iframe src=&quot;&quot; frameborder=&quot;0&quot; width=&quot;960&quot; height=&quot;569&quot; allowfullscreen=&quot;true&quot; mozallowfullscreen=&quot;true&quot; webkitallowfullscreen=&quot;true&quot;&gt;&lt;/iframe&gt;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Figure Settings</span>
<span class="kn">import</span> <span class="nn">IPython.display</span> <span class="k">as</span> <span class="nn">ipd</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">gridspec</span>

<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>  <span class="c1"># interactive display</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">Label</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;
<span class="c1"># use NMA plot style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/nma.mplstyle&quot;</span><span class="p">)</span>
<span class="n">my_layout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Plotting Functions</span>

<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_slope</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      dt  : time-step</span>
<span class="sd">    Returns:</span>
<span class="sd">      A figure of an exponential, the slope of the exponential and the derivative exponential</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="o">+</span><span class="mf">0.1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

  <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="c1"># Exponential</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="c1"># slope</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="p">))],</span><span class="s1">&#39;:og&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\frac{y(1+\Delta t)-y(1)}{\Delta t}$&#39;</span><span class="p">)</span>
    <span class="c1"># derivative</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="n">dt</span><span class="o">*</span><span class="mf">0.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="p">))],</span><span class="s1">&#39;-k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\frac</span><span class="si">{dy}{dt}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="p">)),</span> <span class="s1">&#39;og&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>



<span class="k">def</span> <span class="nf">plot_StepEuler</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      dt  : time-step</span>
<span class="sd">    Returns:</span>
<span class="sd">      A figure of one step of the Euler method for an exponential growth function</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

  <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,],[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">1</span><span class="p">)],</span><span class="s1">&#39;og&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Known&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">1</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="n">dt</span><span class="o">*</span><span class="mf">0.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">1</span><span class="p">)],</span><span class="s1">&#39;:g&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Euler&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="n">dt</span><span class="o">*</span><span class="mf">0.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;or&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Estimate $p_1$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Exact $p(t_1)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="n">dt</span><span class="o">*</span><span class="mf">0.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">1</span><span class="p">),</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">colors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Error $e$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Population (millions)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time(years)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">## LIF PLOT</span>
<span class="k">def</span> <span class="nf">plot_IF</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">Spike_time</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      t  : time</span>
<span class="sd">      V  : membrane Voltage</span>
<span class="sd">      I  : Input</span>
<span class="sd">      Spike_time : Spike_times</span>
<span class="sd">    Returns:</span>
<span class="sd">      figure with three panels</span>
<span class="sd">      top panel: Input as a function of time</span>
<span class="sd">      middle panel: membrane potential as a function of time</span>
<span class="sd">      bottom panel: Raster plot</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="c1"># PLOT OF INPUT</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$I_e(nA)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="c1">#plt.ylim((2,4))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
    <span class="c1"># PLOT OF ACTIVITY</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$V(t)$(mV)&#39;</span><span class="p">)</span>
    <span class="c1"># PLOT OF SPIKES</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Spike&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Spike_time</span><span class="p">,</span><span class="mi">1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Spike_time</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time(ms)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">plot_rErI</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      t   : time</span>
<span class="sd">      r_E : excitation rate</span>
<span class="sd">      r_I : inhibition rate</span>

<span class="sd">    Returns:</span>
<span class="sd">      figure of r_I and r_E as a function of time</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r_E</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$r_E$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r_I</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$r_I$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time(ms)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Firing Rate (Hz)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">plot_rErI_Simple</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      t   : time</span>
<span class="sd">      r_E : excitation rate</span>
<span class="sd">      r_I : inhibition rate</span>

<span class="sd">    Returns:</span>
<span class="sd">      figure with two panels</span>
<span class="sd">      left panel: r_I and r_E as a function of time</span>
<span class="sd">      right panel: r_I as a function of r_E with Nullclines</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="c1"># LEFT PANEL</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r_E</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$r_E$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r_I</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$r_I$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time(ms)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Firing Rate (Hz)&#39;</span><span class="p">)</span>
    <span class="c1"># RIGHT PANEL</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_E</span><span class="p">,</span><span class="n">r_I</span><span class="p">,</span><span class="s1">&#39;k:&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_E</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">r_I</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;go&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">r_E</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">r_E</span><span class="p">),</span><span class="n">linestyles</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\frac</span><span class="si">{d}{dt}</span><span class="s1">r_E=0$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">r_I</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">r_I</span><span class="p">),</span><span class="n">linestyles</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\frac</span><span class="si">{d}{dt}</span><span class="s1">r_I=0$&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_E$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_I$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">plot_rErI_Matrix</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">,</span> <span class="n">Null_rE</span><span class="p">,</span> <span class="n">Null_rI</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      t   : time</span>
<span class="sd">      r_E : excitation firing rate</span>
<span class="sd">      r_I : inhibition firing rate</span>
<span class="sd">      Null_rE: Nullclines excitation firing rate</span>
<span class="sd">      Null_rI: Nullclines inhibition firing rate</span>
<span class="sd">    Returns:</span>
<span class="sd">      figure with two panels</span>
<span class="sd">      left panel: r_I and r_E as a function of time</span>
<span class="sd">      right panel: r_I as a function of r_E with Nullclines</span>

<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r_E</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$r_E$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r_I</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$r_I$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time(ms)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Firing Rate (Hz)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_E</span><span class="p">,</span><span class="n">r_I</span><span class="p">,</span><span class="s1">&#39;k:&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_E</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">r_I</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;go&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_E</span><span class="p">,</span><span class="n">Null_rE</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\frac</span><span class="si">{d}{dt}</span><span class="s1">r_E=0$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_E</span><span class="p">,</span><span class="n">Null_rI</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\frac</span><span class="si">{d}{dt}</span><span class="s1">r_I=0$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_E$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r_I$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="section-1-euler-method">
<h1>Section 1 Euler Method<a class="headerlink" href="#section-1-euler-method" title="Permalink to this headline">¶</a></h1>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Video 1: Intro to Numerical Methods and the Euler Method</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">video</span> <span class="o">=</span> <span class="n">YouTubeVideo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;ORbqe7TamVI&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">854</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">480</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Video available at https://youtu.be/&quot;</span> <span class="o">+</span> <span class="n">video</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="n">video</span>
</pre></div>
</div>
</div>
</div>
<p>The Euler method is one of the most simple and elegant methods to approximate a differential. It was designed by <a class="reference external" href="https://en.wikipedia.org/wiki/Leonhard_Euler">Leonhard Euler</a> (1707-1783).
Simply put we just replace the derivative in the differential equation by the formula for a line and re-arrange.</p>
<div class="section" id="section-1-1-slope-of-a-line">
<h2>Section 1.1: Slope of a line<a class="headerlink" href="#section-1-1-slope-of-a-line" title="Permalink to this headline">¶</a></h2>
<p>The slope is the rate of change between two points. The formula for the slope of a line between the points <span class="math notranslate nohighlight">\((t_0,y(t_0))\)</span> and <span class="math notranslate nohighlight">\((t_1,y(t_1))\)</span> is given by:
$<span class="math notranslate nohighlight">\( m=\frac{y(t_1)-y(t_0)}{t_1-t_0}, \)</span><span class="math notranslate nohighlight">\(
which can be written as 
\)</span><span class="math notranslate nohighlight">\( m=\frac{y_1-y_0}{t_1-t_0}, \)</span><span class="math notranslate nohighlight">\(
or as
\)</span><span class="math notranslate nohighlight">\( m=\frac{\Delta y_0}{\Delta t_0}, \)</span><span class="math notranslate nohighlight">\(
where \)</span>\Delta y_0=y_1-y_0<span class="math notranslate nohighlight">\( and \)</span>\Delta t_0=t_1-t_0<span class="math notranslate nohighlight">\( or in words as
\)</span><span class="math notranslate nohighlight">\( m=\frac{\text{ Change in y} }{\text{Change in t}}. \)</span><span class="math notranslate nohighlight">\(
The slope can be used an approximation of the derivative such that
\)</span><span class="math notranslate nohighlight">\( \frac{d}{dt}y(t)\approx \frac{y(t_0+\Delta t)-y(t_0)}{t_0+\Delta t-t_0}=\frac{y(t_0+dt)-y(t_0)}{\Delta t}\)</span><span class="math notranslate nohighlight">\(
where \)</span>\Delta t$ is a time-step.</p>
<div class="section" id="interactive-demo-1-1-slope-of-a-line">
<h3>Interactive Demo 1.1: Slope of a Line<a class="headerlink" href="#interactive-demo-1-1-slope-of-a-line" title="Permalink to this headline">¶</a></h3>
<p>The plot below shows a function <span class="math notranslate nohighlight">\(y(t)\)</span> in blue, its exact derivative <span class="math notranslate nohighlight">\( \frac{d}{dt}y(t)\)</span> at <span class="math notranslate nohighlight">\(t_0=1\)</span> in black and the approximate derivative calculated using the slope formula <span class="math notranslate nohighlight">\(=\frac{y(1+\Delta t)-y(1)}{\Delta t}\)</span> for different time-steps sizes <span class="math notranslate nohighlight">\(\Delta t\)</span> in green.</p>
<p>Interact with the widget to see how time-step impacts the accuracy of the slope which is the estimate of the derivative.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>
<span class="n">my_layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">&#39;450px&#39;</span>
<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>

    <span class="n">dt</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">4.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span>
                                <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">)</span>

<span class="p">)</span>

<span class="k">def</span> <span class="nf">Pop_widget</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
  <span class="n">plot_slope</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="think-1-1-how-does-the-size-of-dt-affect-the-approximation">
<h3>Think! 1.1: How does the size of <span class="math notranslate nohighlight">\(dt\)</span> affect the approximation?<a class="headerlink" href="#think-1-1-how-does-the-size-of-dt-affect-the-approximation" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W0D4_Calculus/solutions/W0D4_Tutorial3_Solution_a4085ae8.py"><em>Click for solution</em></a></p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="section-2-population-differential-equation">
<h1>Section 2: Population Differential Equation<a class="headerlink" href="#section-2-population-differential-equation" title="Permalink to this headline">¶</a></h1>
<p>Linking with the differential equation tutorial, we will use the population to get an intuitive feel of Euler method to approximate the solution of a differential equation. We start with the population because it has an exact solution with no discontinuities unlike the Leaky Integrate and Fire model.</p>
<p>The population differential equation is</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\\
\frac{d}{dt}\,p(t) &amp;= \alpha p(t)\\\\
p(0)&amp;=p_0 \quad \text{Initial Condition}
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(p(t)\)</span> is the population of the world and <span class="math notranslate nohighlight">\(\alpha\)</span> is a parameter representing birth rate, with
the exact solution
$<span class="math notranslate nohighlight">\( p(t)=p_0e^{\alpha}.\)</span>$</p>
<p>To numerically approximate the population differential equation we replace the derivate with the slope of the line to get the discrete (not continuous) equation:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\\
\frac{p_1-p_0}{t_1-t_0} &amp;= \alpha p_0\\\\
p(0)&amp;=p_0 \quad \text{Initial Condition}
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(p_1\)</span> is the approximate of <span class="math notranslate nohighlight">\(p(t_1)\)</span>. Let <span class="math notranslate nohighlight">\(\Delta t=t_1-t_0\)</span> be the time step and re-arrange the equation gives</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\color{red}{p_1}&amp;=\color{green}{p_0}+\color{blue}{\Delta t} (\color{blue}{\alpha} \color{green}{p_0})
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(\color{red}{p_1}\)</span> is the unknown future, <span class="math notranslate nohighlight">\(\color{green}{p_0}\)</span> is the known current population, <span class="math notranslate nohighlight">\(\color{blue}{\Delta t}\)</span> is the chosen time-step parameter and <span class="math notranslate nohighlight">\(\color{blue}{\alpha}\)</span> is the given birth rate parameter.
Another way to read the re-agranged discrete equation is:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\color{red}{\text{&quot;Future Population&quot;}}&amp;=\color{green}{\text{ &quot;Current Population&quot;}}+\color{blue}{\text{ time-step}} \times (\color{blue}{\text{ &quot;Birth rate}}\text{ times } \color{green}{\text{ Current Population&quot;}}).
\end{align*}\]</div>
<p>So pretty much we can use the current population and add a bit of the dynamics of the differential equation to predict the future. We will make millions, but wait there is always an error.</p>
<div class="section" id="exercise-2-one-step-of-euler-method">
<h2>Exercise 2: One step of Euler Method<a class="headerlink" href="#exercise-2-one-step-of-euler-method" title="Permalink to this headline">¶</a></h2>
<p>Given the population differential equation</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\\
\frac{d}{dt}\,p(t) &amp;= 0.3 p(t),\\\\
p(t_0=1)&amp;=e^{0.3},\quad \text{Initial Condition}
\end{align*}\]</div>
<p>code the Euler method to estimate the population <span class="math notranslate nohighlight">\(p_1\)</span> at <span class="math notranslate nohighlight">\(t_1=2\)</span> given the time-step <span class="math notranslate nohighlight">\(\Delta t=1\)</span> (for brevity, <span class="math notranslate nohighlight">\(\Delta t\)</span> is <code class="docutils literal notranslate"><span class="pre">dt</span></code> in the code).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span>    <span class="c1"># time-step</span>
<span class="n">t_0</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># initial time</span>
<span class="n">p_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t_0</span><span class="p">)</span>    <span class="c1"># initial population</span>

<span class="c1">########################################################################</span>
<span class="c1">## TODO for students: calculate the estimate solution of p at t_1</span>
<span class="c1">## Complete line of code and remove</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student exercise: calculate the estimate solution of p at t_1&quot;</span><span class="p">)</span>
<span class="c1">########################################################################</span>

<span class="n">dp</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">p_1</span> <span class="o">=</span> <span class="o">...</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W0D4_Calculus/solutions/W0D4_Tutorial3_Solution_a7d8b707.py"><em>Click for solution</em></a></p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="section-3-euler-error">
<h1>Section 3: Euler Error<a class="headerlink" href="#section-3-euler-error" title="Permalink to this headline">¶</a></h1>
<p>The solution of the Euler method <span class="math notranslate nohighlight">\(p_1\)</span> is an estimate of the exact solution <span class="math notranslate nohighlight">\(p(t_1)\)</span> at <span class="math notranslate nohighlight">\(t_1\)</span> which means there is a bit of error <span class="math notranslate nohighlight">\(e_1\)</span> which gives the equation</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
p(t_1)&amp;=p_1+e_1\\\\
\text{Rearranging}\\\\
e_1&amp;=p(t_1)-p_1.
\end{align*}\]</div>
<p>Most of the time we do not know the exact answer <span class="math notranslate nohighlight">\(p(t_1)\)</span> but in the population equation we have the exact solution</p>
<div class="math notranslate nohighlight">
\[ p(t)=p_0e^{\alpha}.\]</div>
<p>This means we can explore what the error looks like.</p>
<div class="section" id="interactive-demo-3-euler-error">
<h2>Interactive Demo 3: Euler Error<a class="headerlink" href="#interactive-demo-3-euler-error" title="Permalink to this headline">¶</a></h2>
<p>Interact with the widget to see how the time-step <span class="math notranslate nohighlight">\(dt\)</span> impacts the estimate <span class="math notranslate nohighlight">\(p_1\)</span> and the error <span class="math notranslate nohighlight">\(e_1\)</span> of the Euler method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>
<span class="n">my_layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">&#39;450px&#39;</span>
<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
    <span class="n">dt</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mf">.3</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">4.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span>
                                <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">Pop_widget</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
  <span class="n">plot_StepEuler</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="think-3-effect-of-delta-t-on-euler-error">
<h2>Think! 3: Effect of <span class="math notranslate nohighlight">\(\Delta t\)</span> on Euler Error<a class="headerlink" href="#think-3-effect-of-delta-t-on-euler-error" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>What happens to the estimate <span class="math notranslate nohighlight">\(p_1\)</span> as the time-step <span class="math notranslate nohighlight">\(\Delta t\)</span> increases?</p></li>
<li><p>Is there a relationship between the size of <span class="math notranslate nohighlight">\(\Delta t\)</span> and <span class="math notranslate nohighlight">\(e_1\)</span>?</p></li>
<li><p>How would you improve the error <span class="math notranslate nohighlight">\(e_1\)</span>?</p></li>
</ol>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W0D4_Calculus/solutions/W0D4_Tutorial3_Solution_6376082e.py"><em>Click for solution</em></a></p>
<p>The error <span class="math notranslate nohighlight">\(e_1\)</span> from one timestep is known as the <strong>local error</strong>. For the Euler method the local error is linear, that means that the error decreases linearly as a function of timestep <span class="math notranslate nohighlight">\(O(\Delta t)\)</span>.</p>
</div>
<div class="section" id="section-3-1-time-steps">
<h2>Section 3.1: Time-Steps<a class="headerlink" href="#section-3-1-time-steps" title="Permalink to this headline">¶</a></h2>
<p>In the above exercise we saw that by increasing the step size <span class="math notranslate nohighlight">\(dt\)</span> the error between the estimate <span class="math notranslate nohighlight">\(p_1\)</span> and the exact <span class="math notranslate nohighlight">\(p(t_1)\)</span> increased with the largest error in the example above was for <span class="math notranslate nohighlight">\(\Delta t=4\)</span> which gave the interval <span class="math notranslate nohighlight">\([1, 5]\)</span>,
$<span class="math notranslate nohighlight">\(n=\frac{5-1}{\Delta t}=\frac{5-1}{4}=1,\)</span><span class="math notranslate nohighlight">\(
hence only \)</span>1<span class="math notranslate nohighlight">\( time-step of size \)</span>dt=4<span class="math notranslate nohighlight">\(, giving
\)</span><span class="math notranslate nohighlight">\( t_0=1,\ \text{ and } t_1=5. \)</span>$</p>
<p>To address decrease the error we divide the interval <span class="math notranslate nohighlight">\([1, 5]\)</span> into more steps using a smaller <span class="math notranslate nohighlight">\(\Delta t\)</span>.
In the plot below we use <span class="math notranslate nohighlight">\(\Delta t=1\)</span>, which divides the interval into four segments
$<span class="math notranslate nohighlight">\(n=\frac{5-1}{1}=4,\)</span><span class="math notranslate nohighlight">\(
giving
\)</span><span class="math notranslate nohighlight">\( t_0=1, \ t_1=2, \ t_2=3, \ t_3=4 \ \text{ and } t_4=5. \)</span><span class="math notranslate nohighlight">\(
This can be written as
\)</span><span class="math notranslate nohighlight">\( t_i=1+i\times1, \text{ for } i=0,\cdots 4, \)</span><span class="math notranslate nohighlight">\(
and more generally as 
\)</span><span class="math notranslate nohighlight">\( t_i=t_0+i\times dt, \text{ for } i=0,\cdots n. \)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown *Execute this cell to visualize time steps*</span>
<span class="n">dt</span>  <span class="o">=</span><span class="mi">1</span>
<span class="n">t</span>  <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="o">+</span><span class="n">dt</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span> <span class="c1"># Time from 1 to 5 years in 0.1 steps</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;:o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">,</span><span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;:go&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Initial Condition&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t_0$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t_1$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t_2$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t_3$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$t_4$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Delta t$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Delta t$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Delta t$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Delta t$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span><span class="c1">#plt.ylabel(&#39;Population (millions)&#39;)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time(years)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="section-3-2-the-difference-equation">
<h2>Section 3.2: The Difference Equation<a class="headerlink" href="#section-3-2-the-difference-equation" title="Permalink to this headline">¶</a></h2>
<p>Using the Euler method the differential equation is written as a series of difference equations of the form:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\color{red}{p_{i+1}}&amp;=\color{green}{p_i}+\color{blue}{\Delta t} (\color{blue}{\alpha} \color{green}{p_i})\\
&amp;\text{for } i=0,1,\cdots n-1
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(\color{red}{p_{i+1}}\)</span> is the unknown estimate of the future population at <span class="math notranslate nohighlight">\(t_{i+1}\)</span>, <span class="math notranslate nohighlight">\(\color{green}{p_i}\)</span> is the known current population estimate at <span class="math notranslate nohighlight">\(t_i\)</span>, <span class="math notranslate nohighlight">\(\color{blue}{\Delta t}\)</span> is the chosen time-step parameter and <span class="math notranslate nohighlight">\(\color{blue}{\alpha}\)</span> is the given birth rate parameter.</p>
<div class="section" id="coding-exercise-3-2-step-step-step">
<h3>Coding Exercise 3.2: Step, step, step<a class="headerlink" href="#coding-exercise-3-2-step-step-step" title="Permalink to this headline">¶</a></h3>
<p>Given the population differential equation</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\\
\frac{d}{dt}\,p(t) &amp;= 0.3 p(t),\\
p(t_0=1)&amp;=e^{0.3},\quad \text{Initial Condition,}
\end{align*}\]</div>
<p>code the difference equation</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\color{red}{p_{i+1}}&amp;=\color{green}{p_i}+\color{blue}{dt} (\color{blue}{0.3} \color{green}{p_i}),\\
\color{green}{p_0}&amp;=e^{0.3},\quad \text{Initial Condition,}\\
&amp;\text{for } i=0,1,\cdots 4,\\
\end{align*}\]</div>
<p>to estimate the population on the interval <span class="math notranslate nohighlight">\([1,5]\)</span> with a time-step <span class="math notranslate nohighlight">\(dt=1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="o">+</span><span class="n">dt</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span> <span class="c1"># Time from 0 to 10 years in 0.1 steps</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># Initial Condition</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exact Solution&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
  <span class="c1">########################################################################</span>
  <span class="c1">## TODO for students: calculate the population step for each time point</span>
  <span class="c1">## Complete line of code and remove</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student exercise: calculate the population step for each time point&quot;</span><span class="p">)</span>
  <span class="c1">########################################################################</span>

  <span class="n">dp</span> <span class="o">=</span> <span class="o">...</span>
  <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span><span class="s1">&#39;:o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Euler Estimate&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t</span><span class="p">),</span>
           <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Error $e_i$&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Population (millions)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (years)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W0D4_Calculus/solutions/W0D4_Tutorial3_Solution_92263c87.py"><em>Click for solution</em></a></p>
<p>The error is smaller for 4 time-step than taking one large time step from 1 to 5 but do note that the error is increasing for each step, this is known as <strong>global error</strong> so the futher in time you want to predicted the larger the error.
You can read the theorems <a class="reference external" href="https://colab.research.google.com/github/john-s-butler-dit/Numerical-Analysis-Python/blob/master/Chapter%2001%20-%20Euler%20Methods/102_Euler_method_with_Theorems_nonlinear_Growth_function.ipynb">here.</a></p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="section-4-generalised-euler-method">
<h1>Section 4: Generalised Euler Method<a class="headerlink" href="#section-4-generalised-euler-method" title="Permalink to this headline">¶</a></h1>
<p>The Euler method can be applied to all first order differential equations of the form</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{d}{dt}y(t)&amp;=f(t,y(t)),\\
y(t_{0})&amp;=y_0,\\
\end{align*}\]</div>
<p>on an interval <span class="math notranslate nohighlight">\([a,b]\)</span>.</p>
<p>The differential equation can be written using the Euler method as</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{\color{red}{y_{i+1}}-\color{green}{y_i}}{\color{blue}{\Delta t}}&amp;=f(\color{blue}{t_i},\color{green}{y_i}),\\
\color{red}{y_{i+1}}&amp;=\color{green}{y_i}+\color{blue}{\Delta t}f(\color{blue}{t_i},\color{green}{y_i}),\\
&amp;\text{ for } i=0, \cdots n-1,\\
y(\color{blue}{t_{0}})&amp;=\color{green}{y_0},\\
\end{align*}\]</div>
<p>where  <span class="math notranslate nohighlight">\(\color{red}{y_{i+1}}\)</span> is the unknown estimate at <span class="math notranslate nohighlight">\(t_{i+1}\)</span>, <span class="math notranslate nohighlight">\(\color{green}{y_i}\)</span> is the known at <span class="math notranslate nohighlight">\(t_i\)</span>, <span class="math notranslate nohighlight">\(\color{blue}{\Delta t}\)</span> is the chosen time-step parameter, <span class="math notranslate nohighlight">\(\color{blue}{t_i}\)</span> is the time point and <span class="math notranslate nohighlight">\(f\)</span> is the right handside of the differential equation.
The time discrete time stesp are:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\color{blue}{t_{i}}&amp;=\color{blue}{t_0}+\color{blue}{i}\color{blue}{\Delta t},\\
n&amp;=\frac{b-a}{\Delta t}\\
&amp;\text{ for } i=0, \cdots n.\\
\end{align*}\]</div>
<p>Once again this can be simply put into words:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\color{red}{\text{ &quot;Future&quot; }}&amp;=\color{green}{\text{ &quot;Current Info&quot; }}+\color{blue}{\text{ time-step } }\times\text{ &quot;Dynamics of the system which is a function of } \color{blue}{ \text{ time }} \text{ and }\color{green}{ \text{ Current Info.&quot; }}
\end{align*}\]</div>
</div>
<hr class="docutils" />
<div class="section" id="section-5-euler-method-for-the-leaky-integrate-and-fire">
<h1>Section 5: Euler Method for the Leaky Integrate and Fire<a class="headerlink" href="#section-5-euler-method-for-the-leaky-integrate-and-fire" title="Permalink to this headline">¶</a></h1>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Video 2: Leaky Integrate and Fire Model</span>
<span class="n">video</span> <span class="o">=</span> <span class="n">YouTubeVideo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;JWI2msDBZ7o&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">854</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">480</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Video available at https://youtu.be/&quot;</span> <span class="o">+</span> <span class="n">video</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="n">video</span>
</pre></div>
</div>
</div>
</div>
<p>The Leaky Integrare and Fire differential equation is:</p>
<div class="amsmath math notranslate nohighlight" id="equation-2b7c7e81-1d24-4b35-b9d4-7bdb78899544">
<span class="eqno">(15)<a class="headerlink" href="#equation-2b7c7e81-1d24-4b35-b9d4-7bdb78899544" title="Permalink to this equation">¶</a></span>\[\begin{align}
\frac{dV}{dt} = \frac{-(V-E_L) + R_mI(t)}{\tau_m}\,
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau_m\)</span> is the time constant, <span class="math notranslate nohighlight">\(V\)</span> is the membrane potential, <span class="math notranslate nohighlight">\(E_L\)</span> is the resting potential, <span class="math notranslate nohighlight">\(R_m\)</span> is leak resistance and <span class="math notranslate nohighlight">\(I(t)\)</span> is the external input current.</p>
<p>The solution can be estimated by applyting the Euler method to give the difference equation:</p>
<div class="amsmath math notranslate nohighlight" id="equation-e69e06f6-efa4-4aed-8951-b00fb912b89b">
<span class="eqno">(16)<a class="headerlink" href="#equation-e69e06f6-efa4-4aed-8951-b00fb912b89b" title="Permalink to this equation">¶</a></span>\[\begin{align}
\frac{\color{red}{V_{i+1}}-\color{green}{V_{i}}}{\color{blue}{\Delta t}}=\big(\frac{-(\color{green}{V_i}-\color{blue}{E_L}) + \color{blue}{R_m}I_i}{\color{blue}{\tau_m}}\big),\\
\end{align}\]</div>
<p>Re-arranging gives:</p>
<div class="amsmath math notranslate nohighlight" id="equation-379d6bdb-2a95-4c6a-9eaa-6b3559647f7b">
<span class="eqno">(17)<a class="headerlink" href="#equation-379d6bdb-2a95-4c6a-9eaa-6b3559647f7b" title="Permalink to this equation">¶</a></span>\[\begin{align}
\color{red}{V_{i+1}}=\color{green}{V_{i}}+\color{blue}{\Delta t}\big(\frac{-(\color{green}{V_i}-\color{blue}{E_L}) + \color{blue}{R_m}I_i}{\color{blue}{\tau_m}}\big),\\
\text{for } i=0\cdots n-1,
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\color{red}{V_{i+1}}\)</span> is unknown, <span class="math notranslate nohighlight">\(\color{green}{V_{i}} \)</span> is known, <span class="math notranslate nohighlight">\(\color{blue}{E_L}\)</span>, <span class="math notranslate nohighlight">\(\color{blue}{R_m}\)</span> and <span class="math notranslate nohighlight">\(\color{blue}{\tau_m}\)</span> are known parameters, <span class="math notranslate nohighlight">\(\color{blue}{\Delta t}\)</span> is a chosen time-step and  <span class="math notranslate nohighlight">\(I(t_i)\)</span> is a function for an external input current.</p>
<div class="section" id="coding-exercise-5-lif-and-euler">
<h2>Coding Exercise 5: LIF and Euler<a class="headerlink" href="#coding-exercise-5-lif-and-euler" title="Permalink to this headline">¶</a></h2>
<p>Code the difference equation for the LIF:</p>
<div class="amsmath math notranslate nohighlight" id="equation-411fb217-02e1-41f4-babd-503de71e0f31">
<span class="eqno">(18)<a class="headerlink" href="#equation-411fb217-02e1-41f4-babd-503de71e0f31" title="Permalink to this equation">¶</a></span>\[\begin{align}
\color{red}{V_{i+1}}=\color{green}{V_{i}}+\color{blue}{\Delta t}\big(\frac{-(\color{green}{V_i}-\color{blue}{E_L}) + \color{blue}{R_m}I_i}{\color{blue}{\tau_m}}\big),\\
\text{for } i=0\cdots n-1,
\end{align}\]</div>
<p>with the given parameters set as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">V_reset</span> <span class="pre">=</span> <span class="pre">-75,</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">E_L</span> <span class="pre">=</span> <span class="pre">-75,</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tau_m</span> <span class="pre">=</span> <span class="pre">10,</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">R_m</span> <span class="pre">=</span> <span class="pre">10.</span></code></p></li>
</ul>
<p>The plot below is a figure with with three panels;</p>
<ul class="simple">
<li><p>the top panel is the sinusoidal input, <span class="math notranslate nohighlight">\(I\)</span>,</p></li>
<li><p>the middle panel is the estimate membrane potential <span class="math notranslate nohighlight">\(V_i\)</span> to illustrative the spike <span class="math notranslate nohighlight">\(V_i\)</span> is set to <span class="math notranslate nohighlight">\(0\)</span> and then reset,</p></li>
<li><p>the bottom panel is the raster plot with each dot indicating a spike.</p></li>
</ul>
<p>As electrophysiologists normally listen to spikes when conducting experiments,  listen to the music of different firing rates by changing the input value <span class="math notranslate nohighlight">\(I\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Euler_Integrate_and_Fire</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Args:</span>
<span class="sd">    I: Input</span>
<span class="sd">    time: time</span>
<span class="sd">    dt: time-step</span>
<span class="sd">  Returns:</span>
<span class="sd">    Spike: Spike count</span>
<span class="sd">    Spike_time: Spike times</span>
<span class="sd">    V: membrane potential esitmated by the Euler method</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="n">Spike</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">tau_m</span> <span class="o">=</span> <span class="mi">10</span>
  <span class="n">R_m</span> <span class="o">=</span> <span class="mi">10</span>
  <span class="n">t_isi</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">V_reset</span> <span class="o">=</span> <span class="n">E_L</span> <span class="o">=</span> <span class="o">-</span><span class="mi">75</span>
  <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
  <span class="n">V</span> <span class="o">=</span> <span class="n">V_reset</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="n">V_th</span> <span class="o">=</span> <span class="o">-</span><span class="mi">50</span>
  <span class="n">Spike_time</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1">#######################################################################</span>
    <span class="c1">## TODO for students: calculate the estimate solution of V at t[i+1]</span>
    <span class="c1">## Complete line of codes for dV and remove</span>
    <span class="c1">## Run the code in Section 5.1 or 5.2 to see the output!</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student exercise: calculate the estimate solution of V at t[i+1]&quot;</span><span class="p">)</span>
    <span class="c1">########################################################################</span>

    <span class="n">dV</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">dV</span>

    <span class="c1"># Discontinuity for Spike</span>
    <span class="k">if</span> <span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">V_th</span><span class="p">:</span>
      <span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_reset</span>
      <span class="n">t_isi</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
      <span class="n">Spike</span> <span class="o">=</span> <span class="n">Spike</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="n">Spike_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Spike_time</span><span class="p">,</span> <span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

  <span class="k">return</span> <span class="n">Spike</span><span class="p">,</span> <span class="n">Spike_time</span><span class="p">,</span> <span class="n">V</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W0D4_Calculus/solutions/W0D4_Tutorial3_Solution_c27085de.py"><em>Click for solution</em></a></p>
</div>
<div class="section" id="section-5-1-sinusoidal-input-to-lif">
<h2>Section 5.1: Sinusoidal Input to LIF<a class="headerlink" href="#section-5-1-sinusoidal-input-to-lif" title="Permalink to this headline">¶</a></h2>
<p>The plot below shows the estimated solution of the LIF using the Euler method for a sinusoidal input.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
<span class="n">Spike</span><span class="p">,</span> <span class="n">Spike_time</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">Euler_Integrate_and_Fire</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">plot_IF</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">Spike_time</span><span class="p">)</span>
<span class="n">ipd</span><span class="o">.</span><span class="n">Audio</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="mi">1000</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="section-5-2-random-input-to-the-lif">
<h3>Section 5.2: Random Input to the LIF<a class="headerlink" href="#section-5-2-random-input-to-the-lif" title="Permalink to this headline">¶</a></h3>
<p>The plot below shows a figure with with three panels;</p>
<ul class="simple">
<li><p>the top panel is the noisy input, <span class="math notranslate nohighlight">\(I_i\)</span>,</p></li>
<li><p>the middle panel is the estimate membrane potential <span class="math notranslate nohighlight">\(V_i\)</span> to illustrative the spike <span class="math notranslate nohighlight">\(V_i\)</span> is set to <span class="math notranslate nohighlight">\(0\)</span> and then reset,</p></li>
<li><p>the bottom panel is the raster plot with each dot indicating a spike.</p></li>
</ul>
<p>Listen to the music of different firing rates for a noisy input <span class="math notranslate nohighlight">\(I\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="o">+</span> <span class="mf">2.5</span>
<span class="n">Spike</span><span class="p">,</span> <span class="n">Spike_time</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">Euler_Integrate_and_Fire</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">plot_IF</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">Spike_time</span><span class="p">)</span>
<span class="n">ipd</span><span class="o">.</span><span class="n">Audio</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="mi">1000</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="section-6-systems-of-differential-equations">
<h1>Section 6: Systems of Differential Equations<a class="headerlink" href="#section-6-systems-of-differential-equations" title="Permalink to this headline">¶</a></h1>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Video 3: Systems of Differential Equations</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">video</span> <span class="o">=</span> <span class="n">YouTubeVideo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;0rTYV7g0edM&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">854</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">480</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Video available at https://youtu.be/&quot;</span> <span class="o">+</span> <span class="n">video</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="n">video</span>
</pre></div>
</div>
</div>
</div>
<p>To get to grips with solving a system of differential equations using the Euler method, we will simplify the Wilson Cowan model, a set of equations that will be exploted in more detail on W?D?. The next few sections will apply the Euler method to a system of equations and will also give you a feel of a how to investigate a system of differential equations.</p>
<p>We will start with a linear version of the Wilson Cowan model. Consider the equations,</p>
<div class="amsmath math notranslate nohighlight" id="equation-d44ae354-52cc-441d-98bd-119cb0dcf3df">
<span class="eqno">(19)<a class="headerlink" href="#equation-d44ae354-52cc-441d-98bd-119cb0dcf3df" title="Permalink to this equation">¶</a></span>\[\begin{align}
\tau_E \frac{dr_E}{dt} &amp;= w_{EE}r_E+w_{EI}r_I \\
\tau_I \frac{dr_I}{dt} &amp;= w_{IE}r_E+w_{II}r_I
\end{align}\]</div>
<p><span class="math notranslate nohighlight">\(r_E(t)\)</span> represents the average activation (or firing rate) of the excitatory population at time <span class="math notranslate nohighlight">\(t\)</span>, and <span class="math notranslate nohighlight">\(r_I(t)\)</span> the activation (or firing rate) of the inhibitory population. The parameters <span class="math notranslate nohighlight">\(\tau_E\)</span> and <span class="math notranslate nohighlight">\(\tau_I\)</span> control the timescales of the dynamics of each population. Connection strengths are given by: <span class="math notranslate nohighlight">\(w_{EE}\)</span> (E <span class="math notranslate nohighlight">\(\rightarrow\)</span> E), <span class="math notranslate nohighlight">\(w_{EI}\)</span> (I <span class="math notranslate nohighlight">\(\rightarrow\)</span> E), <span class="math notranslate nohighlight">\(w_{IE}\)</span> (E <span class="math notranslate nohighlight">\(\rightarrow\)</span> I), and <span class="math notranslate nohighlight">\(w_{II}\)</span> (I <span class="math notranslate nohighlight">\(\rightarrow\)</span> I). The terms <span class="math notranslate nohighlight">\(w_{EI}\)</span> and <span class="math notranslate nohighlight">\(w_{IE}\)</span> represent connections from inhibitory to excitatory population and vice versa, respectively.</p>
<div class="section" id="coding-exercise-6-euler-on-a-simple-system">
<h2>Coding Exercise 6: Euler on a Simple System<a class="headerlink" href="#coding-exercise-6-euler-on-a-simple-system" title="Permalink to this headline">¶</a></h2>
<p>We will further simplify the equations by setting <span class="math notranslate nohighlight">\(w_{EE}\)</span> and <span class="math notranslate nohighlight">\(w_{II}\)</span> to zero, we now have the equations</p>
<div class="amsmath math notranslate nohighlight" id="equation-774fce9a-84c9-4232-b2f2-d8c21e61a4a4">
<span class="eqno">(20)<a class="headerlink" href="#equation-774fce9a-84c9-4232-b2f2-d8c21e61a4a4" title="Permalink to this equation">¶</a></span>\[\begin{align}
\tau_E \frac{dr_E}{dt} &amp;= w_{EI}r_I, \\
\tau_I \frac{dr_I}{dt} &amp;= w_{IE}r_E, \qquad (1)
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau_E=100\)</span> and <span class="math notranslate nohighlight">\(\tau_I=120\)</span>, no internal connection <span class="math notranslate nohighlight">\(w_{EE}=w_{II}=0\)</span>, and <span class="math notranslate nohighlight">\(w_{EI}=-1\)</span> and <span class="math notranslate nohighlight">\(w_{IE}=1\)</span>,
with the initial conditions</p>
<div class="amsmath math notranslate nohighlight" id="equation-2454e5a0-3bdf-4a0a-9d12-2fba80a83f30">
<span class="eqno">(21)<a class="headerlink" href="#equation-2454e5a0-3bdf-4a0a-9d12-2fba80a83f30" title="Permalink to this equation">¶</a></span>\[\begin{align}
r_E(0)=30, \\ 
r_I(0)=20.
\end{align}\]</div>
<p>The solution can be approximated using the Euler method such that we have the difference equations:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{\color{red}{rE_{i+1}}-\color{green}{rE_i}}{\color{blue}{\Delta t}}&amp;=\big(\frac{\color{blue}{w_{EI}}\color{green}{rI_i}}{\color{blue}{\tau_E}}\big),\\
\frac{\color{red}{rI_{i+1}}-\color{green}{rI_i}}{\color{blue}{\Delta t}}&amp;=\big(\frac{\color{blue}{w_{IE}}\color{green}{rE_i}}{\color{blue}{\tau_I}}\big),\\
\end{align*}\]</div>
<p>Re-arranging:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\color{red}{rE_{i+1}}&amp;=\color{green}{rE_i}+\color{blue}{\Delta t}\big(\frac{\color{blue}{w_{EI}}\color{green}{rI_i}}{\color{blue}{\tau_E}}\big),\\
\color{red}{rI_{i+1}}&amp;=\color{green}{rI_i}+\color{blue}{\Delta t}\big(\frac{\color{blue}{w_{IE}}\color{green}{rE_i}}{\color{blue}{\tau_I}}\big),\\
&amp;\text{ for  } i=0, \cdots , n-1,\\\\
rE_0&amp;=30,\\
rI_0&amp;=20.\\
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(\color{red}{rE_{i+1}}\)</span> and  <span class="math notranslate nohighlight">\(\color{red}{rI_{i+1}}\)</span> are unknown, <span class="math notranslate nohighlight">\(\color{green}{rE_{i}} \)</span> and  <span class="math notranslate nohighlight">\(\color{green}{rI_{i}} \)</span> are known, <span class="math notranslate nohighlight">\(\color{blue}{w_{EI}}=-1\)</span>, <span class="math notranslate nohighlight">\(\color{blue}{w_{IE}}=1\)</span> and <span class="math notranslate nohighlight">\(\color{blue}{\tau_E}=100\)</span> and <span class="math notranslate nohighlight">\(\color{blue}{\tau_I}=120\)</span>  are known parameters and <span class="math notranslate nohighlight">\(\color{blue}{\Delta t}\)</span> is a chosen time-step.</p>
<p><strong>Code the difference equations to estimate <span class="math notranslate nohighlight">\(r_{E}\)</span> and <span class="math notranslate nohighlight">\(r_{I}\)</span>.</strong></p>
<p>Note that the equations have to estimated in the same <code class="docutils literal notranslate"><span class="pre">for</span></code> loop as they depend on each other.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Euler_Simple_Linear_System</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Args:</span>
<span class="sd">    time: time</span>
<span class="sd">  dt  : time-step</span>
<span class="sd">  Returns:</span>
<span class="sd">    r_E : Excitation Firing Rate</span>
<span class="sd">    r_I : Inhibition Firing Rate</span>

<span class="sd">  &quot;&quot;&quot;</span>

  <span class="n">tau_E</span> <span class="o">=</span> <span class="mi">100</span>
  <span class="n">tau_I</span> <span class="o">=</span> <span class="mi">120</span>
  <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
  <span class="n">r_I</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="n">r_E</span> <span class="o">=</span> <span class="mi">30</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

  <span class="c1">#######################################################################</span>
  <span class="c1">## TODO for students: calculate the estimate solutions of r_E and r_I at t[i+1]</span>
  <span class="c1">## Complete line of codes for dr_E and dr_I and remove</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student exercise: calculate the estimate solutions of r_E and r_I at t[i+1]&quot;</span><span class="p">)</span>
  <span class="c1">########################################################################</span>

  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">dr_E</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">r_E</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">dr_E</span>

    <span class="n">dr_I</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">r_I</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_I</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">dr_I</span>

  <span class="k">return</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span>


<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># time-step</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span> <span class="o">=</span> <span class="n">Euler_Simple_Linear_System</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">plot_rErI</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W0D4_Calculus/solutions/W0D4_Tutorial3_Solution_cce398e8.py"><em>Click for solution</em></a></p>
<p><em>Example output:</em></p>
<img alt='Solution hint' align='left' width=416 height=272 src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/tutorials/W0D4_Calculus/static/W0D4_Tutorial3_Solution_cce398e8_0.png>
<div class="section" id="think-6-simple-euler-solution-to-the-wilson-cowan-model">
<h3>Think! 6: Simple Euler Solution to the Wilson Cowan model<a class="headerlink" href="#think-6-simple-euler-solution-to-the-wilson-cowan-model" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Is the simulation biologically plausible?</p></li>
<li><p>What is the effect of combined excitation and inhibition?</p></li>
</ol>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W0D4_Calculus/solutions/W0D4_Tutorial3_Solution_13ffd604.py"><em>Click for solution</em></a></p>
</div>
</div>
<div class="section" id="section-6-1-phase-plane-plot-and-nullcline">
<h2>Section 6.1: Phase Plane Plot and Nullcline<a class="headerlink" href="#section-6-1-phase-plane-plot-and-nullcline" title="Permalink to this headline">¶</a></h2>
<p>When there are two differential equations describing the interaction of two processes like excitation <span class="math notranslate nohighlight">\(r_{E}\)</span> and inhibition <span class="math notranslate nohighlight">\(r_{I}\)</span> that are both dependent on each other one way of plotting them is as a function of each other which is called a phase plane plot. The phase plane plot can give insight give insight into the state of the system but more about that later in Neuromatch Academy.</p>
<p>An addition to the phase plane plot are the “nullcline”. These lines plot when the rate of change <span class="math notranslate nohighlight">\(\frac{d}{dt}\)</span> of the variables is equation to <span class="math notranslate nohighlight">\(0\)</span>. We saw a variation of this for a single differential equation in the differential equation tutorial.</p>
<p>As we have have two differential equations we set <span class="math notranslate nohighlight">\(\frac{dr_E}{dt}=0\)</span> and <span class="math notranslate nohighlight">\(\frac{dr_I}{dt}=0\)</span> which gives the equations,</p>
<div class="amsmath math notranslate nohighlight" id="equation-fbfaeb2a-bd41-4e91-bdc6-bb7d83562be5">
<span class="eqno">(22)<a class="headerlink" href="#equation-fbfaeb2a-bd41-4e91-bdc6-bb7d83562be5" title="Permalink to this equation">¶</a></span>\[\begin{align}
0&amp;= w_{EI}r_I, \\
0&amp;= w_{IE}r_E,\\
\end{align}\]</div>
<p>these are a unique example as they are a vertical and horizontal line. Where the lines cross is the stable point which the <span class="math notranslate nohighlight">\(r_E(t)\)</span> excitatory population and <span class="math notranslate nohighlight">\(r_I(t)\)</span> the inhibitory population orbit around.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Excute the code to plot the solution to the system</span>
<span class="n">plot_rErI_Simple</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="think-6-1-discuss-the-plots">
<h3>Think! 6.1: Discuss the Plots<a class="headerlink" href="#think-6-1-discuss-the-plots" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Which representation is more intuitive (and useful), the time plot or the phase plane plot?</p></li>
<li><p>Why do we only see one circle?</p></li>
<li><p>What do the quadrants represent?</p></li>
</ol>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W0D4_Calculus/solutions/W0D4_Tutorial3_Solution_92736bfb.py"><em>Click for solution</em></a></p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="section-7-linear-system-of-differential-equations">
<h1>Section 7: Linear System of Differential Equations<a class="headerlink" href="#section-7-linear-system-of-differential-equations" title="Permalink to this headline">¶</a></h1>
<p>Building up the equations in the previous section we re-introduce internal connections <span class="math notranslate nohighlight">\(w_{EE}\)</span>, <span class="math notranslate nohighlight">\(w_{II}\)</span>. The two coupled differential equations, each representing the dynamics of the excitatory or inhibitory population are now:</p>
<div class="amsmath math notranslate nohighlight" id="equation-20b79214-fe22-4c54-8c16-3e8f065dd8bd">
<span class="eqno">(23)<a class="headerlink" href="#equation-20b79214-fe22-4c54-8c16-3e8f065dd8bd" title="Permalink to this equation">¶</a></span>\[\begin{align}
\tau_E \frac{dr_E}{dt} &amp;=w_{EE}r_E +w_{EI}r_I, \\
\tau_I \frac{dr_I}{dt} &amp;=w_{IE}r_E +w_{II}r_I ,
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau_E=100\)</span> and <span class="math notranslate nohighlight">\(\tau_I=120\)</span>, <span class="math notranslate nohighlight">\(w_{EE}=1\)</span> and <span class="math notranslate nohighlight">\(w_{II}=-1\)</span>, and <span class="math notranslate nohighlight">\(w_{EI}=-5\)</span> and <span class="math notranslate nohighlight">\(w_{IE}=0.6\)</span>,
with the initial conditions</p>
<div class="amsmath math notranslate nohighlight" id="equation-92d2b425-5a5b-44e4-8351-1c86aa876aeb">
<span class="eqno">(24)<a class="headerlink" href="#equation-92d2b425-5a5b-44e4-8351-1c86aa876aeb" title="Permalink to this equation">¶</a></span>\[\begin{align}
r_E(0)=30, \\ 
r_I(0)=20.
\end{align}\]</div>
<p>The solution can be approximated using the Euler method such that the equations become:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{\color{red}{rE_{i+1}}-\color{green}{rE_i}}{\color{blue}{\Delta t}}&amp;=\big(\frac{\color{blue}{w_{EE}}\color{green}{rE_i}+\color{blue}{w_{EI}}\color{green}{rI_i}}{\color{blue}{\tau_E}}\big),\\
\frac{\color{red}{rI_{i+1}}-\color{green}{rI_i}}{\color{blue}{\Delta t}}&amp;=\big(\frac{\color{blue}{w_{II}}\color{green}{rI_i}+\color{blue}{w_{IE}}\color{green}{rE_i}}{\color{blue}{\tau_I}}\big),\\
\end{align*}\]</div>
<p>Re-arranging:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\color{red}{rE_{i+1}}&amp;=\color{green}{rE_i}+\color{blue}{\Delta t}\big(\frac{\color{blue}{w_{EE}}\color{green}{rE_i}+\color{blue}{w_{EI}}\color{green}{rI_i}}{\color{blue}{\tau_E}}\big),\\
\color{red}{rI_{i+1}}&amp;=\color{green}{rI_i}+\color{blue}{\Delta t}\big(\frac{\color{blue}{w_{II}}\color{green}{rI_i}+\color{blue}{w_{IE}}\color{green}{rE_i}}{\color{blue}{\tau_I}}\big),\\
&amp;\text{ for } i=0, \cdots n-1,\\\\
rE_0&amp;=30,\\
rI_0&amp;=20.\\
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(\color{red}{rE_{i+1}}\)</span> and  <span class="math notranslate nohighlight">\(\color{red}{rI_{i+1}}\)</span> are unknown, <span class="math notranslate nohighlight">\(\color{green}{rE_{i}} \)</span> and  <span class="math notranslate nohighlight">\(\color{green}{rI_{i}} \)</span> are known, <span class="math notranslate nohighlight">\(\color{blue}{w_{EI}}=-1\)</span>, <span class="math notranslate nohighlight">\(\color{blue}{w_{IE}}=1\)</span> and <span class="math notranslate nohighlight">\(\color{blue}{\tau_E}=100\)</span> and <span class="math notranslate nohighlight">\(\color{blue}{\tau_I}=120\)</span>  are known parameters and <span class="math notranslate nohighlight">\(\color{blue}{\Delta t}=0.1\)</span> is a chosen time-step.</p>
<div class="section" id="coding-exercise-7-implement-euler-for-a-system-of-equations">
<h2>Coding Exercise 7: Implement Euler for a System of Equations<a class="headerlink" href="#coding-exercise-7-implement-euler-for-a-system-of-equations" title="Permalink to this headline">¶</a></h2>
<p>Code the Euler method for the linear system,</p>
<div class="amsmath math notranslate nohighlight" id="equation-780dbfc4-bbb5-463e-8479-0a410692265a">
<span class="eqno">(25)<a class="headerlink" href="#equation-780dbfc4-bbb5-463e-8479-0a410692265a" title="Permalink to this equation">¶</a></span>\[\begin{align}
\tau_E \frac{dr_E}{dt} &amp;=w_{EE}r_E +w_{EI}r_I, \\
\tau_I \frac{dr_I}{dt} &amp;=w_{IE}r_E +w_{II}r_I,
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau_E=100\)</span> and <span class="math notranslate nohighlight">\(\tau_I=120\)</span>, <span class="math notranslate nohighlight">\(w_{EE}=1\)</span> and <span class="math notranslate nohighlight">\(w_{II}=-1\)</span>, and <span class="math notranslate nohighlight">\(w_{EI}=-5\)</span> and <span class="math notranslate nohighlight">\(w_{IE}=0.6\)</span>,
with the initial conditions,</p>
<div class="amsmath math notranslate nohighlight" id="equation-bda0788a-8264-432d-8db7-332e8d0bf701">
<span class="eqno">(26)<a class="headerlink" href="#equation-bda0788a-8264-432d-8db7-332e8d0bf701" title="Permalink to this equation">¶</a></span>\[\begin{align}
r_E(0)=30, \\ 
r_I(0)=20.
\end{align}\]</div>
<p>While this might seem very repititive to an exercise above, it just shows how straightforward it is to convert a system of differential equations into simple pluses and minuses and a bit of multiplication.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Euler_Linear_System_Matrix</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w_EE</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Args:</span>
<span class="sd">    time: time</span>
<span class="sd">    dt: time-step</span>
<span class="sd">    w_EE: Excitation to excitation weight</span>
<span class="sd">  Returns:</span>
<span class="sd">    r_E: Excitation Firing Rate</span>
<span class="sd">    r_I: Inhibition Firing Rate</span>
<span class="sd">    N_Er: Nullclines for drE/dt=0</span>
<span class="sd">    N_Ir: Nullclines for drI/dt=0</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="n">tau_E</span> <span class="o">=</span> <span class="mi">100</span>
  <span class="n">tau_I</span> <span class="o">=</span> <span class="mi">120</span>
  <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
  <span class="n">r_I</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="n">r_E</span> <span class="o">=</span> <span class="mi">30</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="n">w_EI</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
  <span class="n">w_IE</span> <span class="o">=</span> <span class="mf">0.6</span>
  <span class="n">w_II</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>

    <span class="c1">########################################################################</span>
    <span class="c1"># TODO for students: compute drE and drI and remove</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student exercise: compute drE and drI&quot;</span><span class="p">)</span>
    <span class="c1">########################################################################</span>

    <span class="c1"># Calculate the derivatives of the E and I populations</span>
    <span class="n">drE</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">r_E</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">drE</span>

    <span class="n">drI</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">r_I</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_I</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">drI</span>

  <span class="n">N_Er</span> <span class="o">=</span> <span class="o">-</span><span class="n">w_EE</span> <span class="o">/</span> <span class="n">w_EI</span><span class="o">*</span><span class="n">r_E</span>
  <span class="n">N_Ir</span> <span class="o">=</span> <span class="o">-</span><span class="n">w_IE</span> <span class="o">/</span> <span class="n">w_II</span><span class="o">*</span><span class="n">r_E</span>

  <span class="k">return</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">,</span> <span class="n">N_Er</span><span class="p">,</span> <span class="n">N_Ir</span>

<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># time-step</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">Euler_Linear_System_Matrix</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">plot_rErI</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W0D4_Calculus/solutions/W0D4_Tutorial3_Solution_e9b2af6f.py"><em>Click for solution</em></a></p>
<p><em>Example output:</em></p>
<img alt='Solution hint' align='left' width=416 height=272 src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/tutorials/W0D4_Calculus/static/W0D4_Tutorial3_Solution_e9b2af6f_0.png>
<div class="section" id="think-7-oscillations">
<h3>Think! 7: Oscillations<a class="headerlink" href="#think-7-oscillations" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>What will happen to the oscillations if the time period is extended?</p></li>
<li><p>How would you control or predict the oscillations?</p></li>
</ol>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W0D4_Calculus/solutions/W0D4_Tutorial3_Solution_5929a354.py"><em>Click for solution</em></a></p>
</div>
</div>
<div class="section" id="section-7-1-phase-plane-and-nullclines">
<h2>Section 7.1: Phase Plane and Nullclines<a class="headerlink" href="#section-7-1-phase-plane-and-nullclines" title="Permalink to this headline">¶</a></h2>
<p>Like before, we have two differential equations so we cane plot the results on a phase plane. We can also calculate the Nullclines when we set <span class="math notranslate nohighlight">\(\frac{dr_E}{dt}=0\)</span> and <span class="math notranslate nohighlight">\(\frac{dr_I}{dt}=0\)</span> which gives,</p>
<div class="amsmath math notranslate nohighlight" id="equation-d533fc1f-af19-4b06-b5ea-7aff0eb9a5da">
<span class="eqno">(27)<a class="headerlink" href="#equation-d533fc1f-af19-4b06-b5ea-7aff0eb9a5da" title="Permalink to this equation">¶</a></span>\[\begin{align}
0&amp;= w_{EE}r_E+w_{EI}r_I, \\
0&amp;= w_{IE}r_E+w_{II}r_I,
\end{align}\]</div>
<p>re-arranging as two lines</p>
<div class="amsmath math notranslate nohighlight" id="equation-79001aa6-6fb8-4747-83e4-886d9aca022d">
<span class="eqno">(28)<a class="headerlink" href="#equation-79001aa6-6fb8-4747-83e4-886d9aca022d" title="Permalink to this equation">¶</a></span>\[\begin{align}
r_I&amp;= -\frac{w_{EE}}{w_{EI}}r_E, \\
r_I&amp;= -\frac{w_{IE}}{w_{II}}r_E, 
\end{align}\]</div>
<p>which crosses at the stable point.</p>
<p>The panel on the left shows excitation firing rate <span class="math notranslate nohighlight">\(r_E\)</span> and inhibition firing rate  <span class="math notranslate nohighlight">\(r_I\)</span> as a function of time. On the rightside the phase plane plot shows inhibition firing rate <span class="math notranslate nohighlight">\(r_I\)</span> as a function of excitiation firing rate <span class="math notranslate nohighlight">\(r_E\)</span> with the Nullclines for <span class="math notranslate nohighlight">\(\frac{dr_E}{dt}=0\)</span> and <span class="math notranslate nohighlight">\(\frac{dr_I}{dt}=0.\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown *Run this cell to visualize the phase plane*</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># time-step</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">,</span> <span class="n">N_Er</span><span class="p">,</span> <span class="n">N_Ir</span> <span class="o">=</span> <span class="n">Euler_Linear_System_Matrix</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">plot_rErI_Matrix</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">,</span> <span class="n">N_Er</span><span class="p">,</span> <span class="n">N_Ir</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="interactive-demo-7-1-a-small-change-changes-everything">
<h3>Interactive Demo 7.1: A small change changes everything<a class="headerlink" href="#interactive-demo-7-1-a-small-change-changes-everything" title="Permalink to this headline">¶</a></h3>
<p>To illustrate that even changing one parameter in system of differential equations has a large impact on the solutions of the excitation firing rate <span class="math notranslate nohighlight">\(r_E\)</span> and inhibition firing rate <span class="math notranslate nohighlight">\(r_I\)</span>.
Take note of:</p>
<ol class="simple">
<li><p>How the solution changes for positive and negative of <span class="math notranslate nohighlight">\(w_{EE}\)</span> pay close attention to the axis.</p></li>
<li><p>How would you maintain a stable oscillation.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>
<span class="n">my_layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">&#39;450px&#39;</span>
<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
    <span class="n">w_EE</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span>
                                <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">Pop_widget</span><span class="p">(</span><span class="n">w_EE</span><span class="p">):</span>
  <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># time-step</span>
  <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
  <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">,</span> <span class="n">N_Er</span><span class="p">,</span> <span class="n">N_Ir</span> <span class="o">=</span> <span class="n">Euler_Linear_System_Matrix</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w_EE</span><span class="p">)</span>
  <span class="n">plot_rErI_Matrix</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">,</span> <span class="n">N_Er</span><span class="p">,</span> <span class="n">N_Ir</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="take-home">
<h1>Take Home<a class="headerlink" href="#take-home" title="Permalink to this headline">¶</a></h1>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Video 4: Numerical Methods - Take Home and Bonus Materials</span>
<span class="n">video</span> <span class="o">=</span> <span class="n">YouTubeVideo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;NDXcNZXeLsw&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">854</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">480</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Video available at https://youtu.be/&quot;</span> <span class="o">+</span> <span class="n">video</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="n">video</span>
</pre></div>
</div>
</div>
</div>
<p>Using pretty much the formula for the slope of a line, the solution of differential equation can be estimated with reasonable accuracy.
This will be much more relevant when dealing with more complicated (non-linear) differential equations where there is no known exact solution.</p>
</div>
<hr class="docutils" />
<div class="section" id="links-to-neuromatch-days">
<h1>Links to Neuromatch Days<a class="headerlink" href="#links-to-neuromatch-days" title="Permalink to this headline">¶</a></h1>
<p>The Euler method is used to estimate differential equations in a number of different Neuromatch days:</p>
<ul class="simple">
<li><p>The LIF model is discussed in more details in Model Types (Week 1 Day 1) and Real Neurons (Week 2 Day 3).</p></li>
<li><p>Drift Diffusion model which is a differential equation for decision making is discussed in Linear Systems (Week 2 Day 2).</p></li>
<li><p>Phase-plane plots are discussed in Linear Systems (Week 2 Day 2) and Dynamic Networks (Week 2 Day 4).</p></li>
<li><p>The Wilson-Cowan model is discussed in Dynamic Networks (Week 2 Day 4).</p></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="references">
<h1>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h1>
<ol class="simple">
<li><p>Lotka, A. L, (1920)   Analytical note on certain rhythmic  relations inorganic  systems.Proceedings of the National Academy of Sciences,6(7):410–415,1920.</p></li>
<li><p>Brunel N, van Rossum MC. Lapicque’s 1907 paper: from frogs to integrate-and-fire. Biol Cybern. 2007 Dec;97(5-6):337-9. doi: 10.1007/s00422-007-0190-0. Epub 2007 Oct 30. PMID: 17968583.</p></li>
</ol>
</div>
<div class="section" id="bibliography">
<h1>Bibliography<a class="headerlink" href="#bibliography" title="Permalink to this headline">¶</a></h1>
<ol class="simple">
<li><p>Dayan, P., &amp; Abbott, L. F. (2001). Theoretical neuroscience: computational and mathematical modeling of neural systems. Computational Neuroscience Series.</p></li>
<li><p>Strogatz, S. Nonlinear dynamics and chaos: with applications to physics, biology, chemistry, and engineering (studies in nonlinearity), Westview Press; 2 edition (29 July 2014)</p></li>
</ol>
<div class="section" id="supplemental-popular-reading-list">
<h2>Supplemental Popular Reading List<a class="headerlink" href="#supplemental-popular-reading-list" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Lindsay, G. (2021). Models of the Mind: How Physics, Engineering and Mathematics Have Shaped Our Understanding of the Brain. Bloomsbury Publishing.</p></li>
<li><p>Strogatz, S. (2004). Sync: The emerging science of spontaneous order. Penguin UK.</p></li>
</ol>
</div>
<div class="section" id="popular-podcast">
<h2>Popular Podcast<a class="headerlink" href="#popular-podcast" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Strogatz, S. (Host). (2020-), Joy of X  https://www.quantamagazine.org/tag/the-joy-of-x/ Quanta Magazine</p></li>
</ol>
</div>
</div>
<hr class="docutils" />
<div class="section" id="bonus-1-the-4th-order-runge-kutta">
<h1>Bonus 1: The 4th Order Runge Kutta<a class="headerlink" href="#bonus-1-the-4th-order-runge-kutta" title="Permalink to this headline">¶</a></h1>
<p>Another popular numerical method to estimate the solution of a differential equations of the general form:
$<span class="math notranslate nohighlight">\( \frac{d}{dt}y=f(t,y)\)</span><span class="math notranslate nohighlight">\(
is the 4th Order Runge Kutta: 
\)</span><span class="math notranslate nohighlight">\(k_1=f(t,y),\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(k_2=f(t+\frac{\Delta t}{2},y+\frac{\Delta t}{2}k_1),\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(k_3=f(t+\frac{\Delta t}{2},y+\frac{\Delta t}{2}k_2),\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(k_4=f(t+dt,y+\Delta tk_3),\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(y_{i+1}=y_{i}+\frac{\Delta t}{6}(k_1+2k_2+2k_3+k_4),\)</span>$
which is more accurate than the Euler method.</p>
<p>Given the population differential equation</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\\
\frac{d}{dt}\,p(t) &amp;= 0.3 p(t)\\
p(t_0=1)&amp;=e^{0.3}\quad \text{Initial Condition}
\end{align*}\]</div>
<p>the 4th Runge Kutta difference equation is</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
k_1&amp;=0.3\color{green}{p_i},\\
k_2&amp;=0.3(\color{green}{p_i}+\frac{\Delta t}{2}k_1),\\
k_3&amp;=0.3(\color{green}{p_i}+\frac{\Delta t}{2}k_2),\\
k_4&amp;=0.3(\color{green}{p_i}+k_3),\\
\color{red}{p_{i+1}}&amp;=\color{green}{p_i}+\frac{\color{blue}{\Delta t}}{6}( \color{green}{k_1+2k_2+2k_3+k_4})\\
&amp;\text{for } i=0,1,\cdots 4
\end{align*}\]</div>
<p>to estimate the population for <span class="math notranslate nohighlight">\(\Delta t=0.5\)</span>.</p>
<p>The code is implemented below. Note how much more accurate the 4th Order Runge Kutta (yellow) is compared to the Euler Method (blue).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span><span class="o">=</span><span class="mf">0.5</span>

<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="o">+</span><span class="n">dt</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">pRK4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">pRK4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="c1"># Initial Condition</span>

<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>

  <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exact Solution&#39;</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">dp</span> <span class="o">=</span> <span class="n">dt</span><span class="o">*</span><span class="mf">0.3</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dp</span> <span class="c1"># Euler</span>
    <span class="n">k1</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="n">pRK4</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">k2</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="n">pRK4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k1</span><span class="p">)</span>
    <span class="n">k3</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="n">pRK4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k2</span><span class="p">)</span>
    <span class="n">k4</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="n">pRK4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">k3</span><span class="p">)</span>
    <span class="n">pRK4</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pRK4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">/</span><span class="mi">6</span> <span class="o">*</span><span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k3</span> <span class="o">+</span> <span class="n">k4</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span><span class="s1">&#39;:o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Euler Estimate&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">pRK4</span><span class="p">,</span><span class="s1">&#39;:o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;4th Order Runge Kutta Estimate&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t</span><span class="p">),</span><span class="n">colors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Error $e_i$&#39;</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Intial Condition&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Population (millions)&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (years)&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="bonus-reference-1-a-full-course-on-numerical-methods-in-python">
<h2>Bonus Reference 1: A full course on numerical methods in Python<a class="headerlink" href="#bonus-reference-1-a-full-course-on-numerical-methods-in-python" title="Permalink to this headline">¶</a></h2>
<p>For a full course on Numerical Methods you can look here https://github.com/john-s-butler-dit/Numerical-Analysis-Python</p>
</div>
</div>
<div class="section" id="bonus-2-neural-oscillations-are-a-start-toward-understanding-brain-activity-rather-than-the-end">
<h1>Bonus 2: Neural oscillations are a start toward understanding brain activity rather than the end<a class="headerlink" href="#bonus-2-neural-oscillations-are-a-start-toward-understanding-brain-activity-rather-than-the-end" title="Permalink to this headline">¶</a></h1>
<p>In an essay from May 2021 in PLOS Biology by Keith Dowling (a past Neuromatch TA) and M. Florencia Assaneo discussed a mathematical way of thinking about what should be defined as an oscillation.
This is an important question as a good deal of research has investigated oscillations of the brain, and as we saw earlier, a good deal of the equations we use to model neuronal activity result in an oscillation.</p>
<p>They motivated their approach using the Stuart–Landau equations which is a system of differential equations of the form</p>
<div class="amsmath math notranslate nohighlight" id="equation-c4abbb10-d299-4c67-9838-c3b422f845e6">
<span class="eqno">(29)<a class="headerlink" href="#equation-c4abbb10-d299-4c67-9838-c3b422f845e6" title="Permalink to this equation">¶</a></span>\[\begin{align}
 \frac{dx}{dt} &amp;=\lambda x-\omega y -\gamma (x^2+y^2)x+s\\
 \frac{dy}{dt} &amp;=\lambda y+\omega x -\gamma (x^2+y^2)y 
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(s\)</span> is input to the system, and <span class="math notranslate nohighlight">\(\lambda\)</span>, <span class="math notranslate nohighlight">\(\omega\)</span> and <span class="math notranslate nohighlight">\(\gamma\)</span> are parameters.
The Stuart–Landau equations are a well described system of differential equations that generates oscillations. For their purpose, they used the equations to illustrate what people should expect when conducting experiments looking for oscilations.
In their paper, using the Stuart–Landau equations, they outline</p>
<ul class="simple">
<li><p>“What is an oscillator?”</p></li>
<li><p>“What an oscillator is not”</p></li>
<li><p>“Not all that oscillates is oscillator”</p></li>
<li><p>“Not all oscillators are alike.”</p></li>
</ul>
<p>The Euler form of the Stuart–Landau system of equations is:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\color{red}{x_{i+1}}&amp;=\color{green}{x_i}+\color{blue}{\Delta t}\big(\lambda \color{green}{x_i}-\omega \color{green}{y_i} -\gamma (\color{green}{x_i}^2+\color{green}{y_i}^2)\color{green}{x_i}+s\big),\\
\color{red}{y_{i+1}}&amp;=\color{green}{y_i}+\color{blue}{\Delta t}\big(\lambda \color{green}{y_i}+\omega \color{green}{x_i} -\gamma (\color{green}{x_i}^2+\color{green}{y_i}^2)\color{green}{y_i} \big),\\
&amp;\text{ for } i=0, \cdots n-1,\\
x_0&amp;=1,\\
y_0&amp;=1,\\
\end{align*}\]</div>
<p>with <span class="math notranslate nohighlight">\( \Delta t=0.1/1000\)</span> ms.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper functions</span>
<span class="k">def</span> <span class="nf">plot_Stuart_Landa</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      t  : time</span>
<span class="sd">      x  : x</span>
<span class="sd">      y  : y</span>
<span class="sd">      s : input</span>
<span class="sd">    Returns:</span>
<span class="sd">      figure with two panels</span>
<span class="sd">      top panel: Input as a function of time</span>
<span class="sd">      bottom panel: x</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>  <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

    <span class="c1"># PLOT OF INPUT</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$s$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="c1">#plt.ylim((2,4))</span>

    <span class="c1"># PLOT OF ACTIVITY</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="p">,</span><span class="n">x</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;go&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">Euler_Stuart_Landau</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">lamba</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">gamma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="mi">25</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Args:</span>
<span class="sd">    I: Input</span>
<span class="sd">    time: time</span>
<span class="sd">    dt: time-step</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
  <span class="n">omega</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">lamba</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">gamma</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">dx</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">lamba</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">gamma</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">dy</span>

  <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="bonus-2-1-what-is-an-oscillator">
<h2>Bonus 2.1: What is an Oscillator?<a class="headerlink" href="#bonus-2-1-what-is-an-oscillator" title="Permalink to this headline">¶</a></h2>
<p>Doelling &amp; Assaneo (2021), using the Stuart–Landau system, show different possible states of an oscilator by manipulating the <span class="math notranslate nohighlight">\(\lambda\)</span> term in the equation.
From the paper: “this qualitative change in behavior takes place at λ = 0: For λ &lt; 0, the system decays to a stable equilibrium, while for λ &gt; 0, it keeps oscillating.”</p>
<div class="section" id="interactive-demo-bonus-2-1">
<h3>Interactive Demo Bonus 2.1<a class="headerlink" href="#interactive-demo-bonus-2-1" title="Permalink to this headline">¶</a></h3>
<p>The plot below shows the estimated solution of the Stuart–Landau system with a base frequency <span class="math notranslate nohighlight">\(\omega\)</span> set to <span class="math notranslate nohighlight">\(4\times 2\pi\)</span>, <span class="math notranslate nohighlight">\(\gamma=1\)</span> and <span class="math notranslate nohighlight">\(k=25\)</span> over 3 seconds. The input to the system <span class="math notranslate nohighlight">\(s(t)\)</span> is plotted in the top panel, <span class="math notranslate nohighlight">\(x\)</span> as a function of time in the the bottom panel and on the right the phase plane plot of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. You can manipulate <span class="math notranslate nohighlight">\(\lambda\)</span> to see how the oscilations change.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>
<span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="o">/</span><span class="mi">1000</span>
<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">my_layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">&#39;450px&#39;</span>
<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
    <span class="n">lamda</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">Pop_widget</span><span class="p">(</span><span class="n">lamda</span><span class="p">):</span>
    <span class="n">s</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">Euler_Stuart_Landau</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">lamda</span><span class="p">)</span>
    <span class="n">plot_Stuart_Landa</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="bonus-2-2-not-all-oscillators-are-alike">
<h2>Bonus 2.2 : Not all oscillators are alike<a class="headerlink" href="#bonus-2-2-not-all-oscillators-are-alike" title="Permalink to this headline">¶</a></h2>
<div class="section" id="interactive-demo-bonus-2-stuart-landau-system">
<h3>Interactive Demo Bonus 2: Stuart-Landau System<a class="headerlink" href="#interactive-demo-bonus-2-stuart-landau-system" title="Permalink to this headline">¶</a></h3>
<p>The plot below shows estimated solution of the Stuart–Landau system with a base frequency <span class="math notranslate nohighlight">\(\omega\)</span> set to <span class="math notranslate nohighlight">\(4\times 2\pi\)</span>, <span class="math notranslate nohighlight">\(\lambda=1\)</span>, <span class="math notranslate nohighlight">\(\gamma=1\)</span> and <span class="math notranslate nohighlight">\(k=50\)</span> over 3 seconds the input to the system <span class="math notranslate nohighlight">\(s(t)=\sin(freq 2\pi t) \)</span> in the top panel, <span class="math notranslate nohighlight">\(x\)</span> as a function of time in the the bottom panel and on the right the phase plane plot of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>You can manipulate the frequency <span class="math notranslate nohighlight">\(freq\)</span> of the input to see how the oscilations change and for frequencies <span class="math notranslate nohighlight">\(freq\)</span> further and further from the base frequency of 4Hz the oscilations breaks down.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>
<span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="o">/</span><span class="mi">1000</span>
<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">my_layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">&#39;450px&#39;</span>
<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
    <span class="n">freq</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">Pop_widget</span><span class="p">(</span><span class="n">freq</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">freq</span> <span class="o">*</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Euler_Stuart_Landau</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">lamba</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">plot_Stuart_Landa</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="bonus-reference-2">
<h2>Bonus Reference 2<a class="headerlink" href="#bonus-reference-2" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.3001234">Doelling, K. B., &amp; Assaneo, M. F. (2021). Neural oscillations are a start toward understanding brain activity rather than the end. PLoS biology, 19(5), e3001234.</a></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials/W0D4_Calculus/student"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="W0D4_Tutorial2.html" title="previous page">Tutorial 2: Differential Equations</a>
    <a class='right-next' id="next-link" href="../../W0D5_Statistics/chapter_title.html" title="next page">Statistics</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Neuromatch<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>