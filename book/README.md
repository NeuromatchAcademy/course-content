# Jupyterbook Support

We use [jupyterbook](https://jupyterbook.org/intro.html) to create a condensed, single interface to all our course materials. This book will be autogenerated and published to [https://neuromatchacademy.github.io/course-content] in `gh-pages` branch, every time a PR is merged into the master branch.

The GitHub workflow is defined in `.github/workflows/publish-book.yml`. 

In order to build the book locally, you will need to do the following:

1. Clone course-content, precourse, and nmaci repos

`git clone https://github.com/NeuromatchAcademy/course-content.git`

`git clone https://github.com/NeuromatchAcademy/precourse.git`

`git clone https://github.com/NeuromatchAcademy/nmaci.git`

2. Install dependencies

`cd course-content`

`pip install -r ../nmaci/requirements.txt`

`pip install jupyter-book==0.10.2`

**Important:** Do not install jupyter-book 0.11 or later at this point, as there are breaking changes in how it handles the table of contents file we generate.

3. Create a symlink in the book dir to the tutorials dir. From the repo (i.e., course-content) root directory:

`ln -s tutorials book/tutorials`

`ln -s projects book/projects`

4. Concatenate precourse and course-content `materials.yml` files, and prepare repo for book building 

`cat ../precourse/tutorials/materials.yml tutorials/materials.yml > out.yml`

`mv out.yml tutorials/materials.yml`

`cp ../precourse/tutorials/W0D* tutorials/`

`python ../nmaci/scripts/generate_book.py arg`

where `arg` can take either `student` or `instructor` as a value.

This will use the modified tutorials/materials.yml to create the `_toc.yml` file in the book directory. It will also be responsible for creating any additional markdown files or modifying any tutorial notebooks specifically for book generation. 

**No changes created by this script should be committed to the repo.**

5. Build the book

`jupyter-book build book`

This will create a `book/_build` directory. You can open the `index.html` in any browser to verify the book.
