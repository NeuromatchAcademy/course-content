
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Example Data Project: the Train Illusion &#8212; Neuromatch Academy: Computational Neuroscience</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script >const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="shortcut icon" href="../../_static/nma-logo-square-4xp.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Datasets" href="../docs/datasets_overview.html" />
    <link rel="prev" title="Example Model Project: the Train Illusion" href="TrainIllusionModel.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/nma-logo-square-4xp.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Neuromatch Academy: Computational Neuroscience</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../tutorials/intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/Schedule/schedule_intro.html">
   Schedule
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/Schedule/daily_schedules.html">
     General schedule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/Schedule/shared_calendars.html">
     Shared calendars
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/Schedule/timezone_widget.html">
     Timezone widget
    </a>
   </li>
  </ul>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/TechnicalHelp/tech_intro.html">
   Technical Help
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../tutorials/TechnicalHelp/Jupyterbook.html">
     Using jupyterbook
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/TechnicalHelp/Tutorial_colab.html">
       Using Google Colab
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/TechnicalHelp/Tutorial_kaggle.html">
       Using Kaggle
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/TechnicalHelp/Discord.html">
     Using discord
    </a>
   </li>
  </ul>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/TechnicalHelp/Links_Policy.html">
   Quick links and policies
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../prereqs/ComputationalNeuroscience.html">
   Prerequisites and preparatory materials for NMA Computational Neuroscience
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Pre-reqs Refresher
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W0D0_NeuroVideoSeries/chapter_title.html">
   Neuro Video Series (W0D0)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D0_NeuroVideoSeries/student/W0D0_Tutorial1.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D0_NeuroVideoSeries/student/W0D0_Tutorial2.html">
     Human Psychophysics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D0_NeuroVideoSeries/student/W0D0_Tutorial3.html">
     Behavioral Readout
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D0_NeuroVideoSeries/student/W0D0_Tutorial4.html">
     Live in Lab
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D0_NeuroVideoSeries/student/W0D0_Tutorial5.html">
     Brain Signals: Spiking Activity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D0_NeuroVideoSeries/student/W0D0_Tutorial6.html">
     Brain Signals: LFP
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D0_NeuroVideoSeries/student/W0D0_Tutorial7.html">
     Brain Signals: EEG &amp; MEG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D0_NeuroVideoSeries/student/W0D0_Tutorial8.html">
     Brain Signals: fMRI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D0_NeuroVideoSeries/student/W0D0_Tutorial9.html">
     Brain Signals: Calcium Imaging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D0_NeuroVideoSeries/student/W0D0_Tutorial10.html">
     Stimulus Representation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D0_NeuroVideoSeries/student/W0D0_Tutorial11.html">
     Neurotransmitters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D0_NeuroVideoSeries/student/W0D0_Tutorial12.html">
     Neurons to Consciousness
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W0D1_PythonWorkshop1/chapter_title.html">
   Python Workshop 1 (W0D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D1_PythonWorkshop1/student/W0D1_Tutorial1.html">
     Tutorial: LIF Neuron Part I
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W0D2_PythonWorkshop2/chapter_title.html">
   Python Workshop 2 (W0D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D2_PythonWorkshop2/student/W0D2_Tutorial1.html">
     Tutorial 1: LIF Neuron Part II
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W0D3_LinearAlgebra/chapter_title.html">
   Linear Algebra (W0D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D3_LinearAlgebra/student/W0D3_Tutorial1.html">
     Tutorial 1: Vectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D3_LinearAlgebra/student/W0D3_Tutorial2.html">
     Tutorial 2: Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D3_LinearAlgebra/student/W0D3_Tutorial3.html">
     Bonus Tutorial: Discrete Dynamical Systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D3_LinearAlgebra/student/W0D3_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D3_LinearAlgebra/student/W0D3_DaySummary.html">
     Day Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W0D4_Calculus/chapter_title.html">
   Calculus (W0D4)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D4_Calculus/student/W0D4_Tutorial1.html">
     Tutorial 1: Differentiation and Integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D4_Calculus/student/W0D4_Tutorial2.html">
     Tutorial 2: Differential Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D4_Calculus/student/W0D4_Tutorial3.html">
     Tutorial 3: Numerical Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D4_Calculus/student/W0D4_DaySummary.html">
     Day Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W0D5_Statistics/chapter_title.html">
   Statistics (W0D5)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D5_Statistics/student/W0D5_Tutorial1.html">
     Tutorial 1: Probability Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D5_Statistics/student/W0D5_Tutorial2.html">
     Tutorial 2: Statistical Inference
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D5_Statistics/student/W0D5_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W0D5_Statistics/student/W0D5_DaySummary.html">
     Day Summary
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Intro to Modeling
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W1D1_ModelTypes/chapter_title.html">
   Model Types (W1D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D1_ModelTypes/student/W1D1_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D1_ModelTypes/student/W1D1_Tutorial1.html">
     Tutorial 1: “What” models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D1_ModelTypes/student/W1D1_Tutorial2.html">
     Tutorial 2: “How” models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D1_ModelTypes/student/W1D1_Tutorial3.html">
     Tutorial 3: “Why” models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D1_ModelTypes/student/W1D1_Tutorial4.html">
     Tutorial 4: Model Discussions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D1_ModelTypes/student/W1D1_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D1_ModelTypes/further_reading.html">
     Suggested further readings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D1_ModelTypes/student/W1D1_DaySummary.html">
     Day Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W2D1_ModelingPractice/chapter_title.html">
   Modeling Practice (W2D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D1_ModelingPractice/student/W2D1_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D1_ModelingPractice/student/W2D1_Tutorial1.html">
     Tutorial 1: Framing the Question
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D1_ModelingPractice/student/W2D1_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D1_ModelingPractice/student/W2D1_DaySummary.html">
     Day Summary
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W1D2_ModelFitting/chapter_title.html">
   Model Fitting (W1D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D2_ModelFitting/student/W1D2_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D2_ModelFitting/student/W1D2_Tutorial1.html">
     Tutorial 1: Linear regression with MSE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D2_ModelFitting/student/W1D2_Tutorial2.html">
     Tutorial 2: Linear regression with MLE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D2_ModelFitting/student/W1D2_Tutorial3.html">
     Tutorial 3: Confidence intervals and bootstrapping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D2_ModelFitting/student/W1D2_Tutorial4.html">
     Tutorial 4: Multiple linear regression and polynomial regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D2_ModelFitting/student/W1D2_Tutorial5.html">
     Tutorial 5: Model Selection: Bias-variance trade-off
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D2_ModelFitting/student/W1D2_Tutorial6.html">
     Tutorial 6: Model Selection: Cross-validation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D2_ModelFitting/student/W1D2_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D2_ModelFitting/further_reading.html">
     Suggested further readings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D2_ModelFitting/student/W1D2_DaySummary.html">
     Day Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W1D3_GeneralizedLinearModels/chapter_title.html">
   Generalized Linear Models (W1D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D3_GeneralizedLinearModels/student/W1D3_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D3_GeneralizedLinearModels/student/W1D3_Tutorial1.html">
     Tutorial 1: GLMs for Encoding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D3_GeneralizedLinearModels/student/W1D3_Tutorial2.html">
     Tutorial 2: Classifiers and regularizers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D3_GeneralizedLinearModels/student/W1D3_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D3_GeneralizedLinearModels/further_reading.html">
     Suggested further readings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D3_GeneralizedLinearModels/student/W1D3_DaySummary.html">
     Day Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W1D4_DimensionalityReduction/chapter_title.html">
   Dimensionality Reduction (W1D4)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D4_DimensionalityReduction/student/W1D4_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D4_DimensionalityReduction/student/W1D4_Tutorial1.html">
     Tutorial 1: Geometric view of data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D4_DimensionalityReduction/student/W1D4_Tutorial2.html">
     Tutorial 2: Principal Component Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D4_DimensionalityReduction/student/W1D4_Tutorial3.html">
     Tutorial 3: Dimensionality Reduction &amp; Reconstruction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D4_DimensionalityReduction/student/W1D4_Tutorial4.html">
     Tutorial 4:  Nonlinear Dimensionality Reduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D4_DimensionalityReduction/student/W1D4_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D4_DimensionalityReduction/further_reading.html">
     Suggested further readings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D4_DimensionalityReduction/student/W1D4_DaySummary.html">
     Day Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W1D5_DeepLearning/chapter_title.html">
   Deep Learning (W1D5)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D5_DeepLearning/student/W1D5_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D5_DeepLearning/student/W1D5_Tutorial1.html">
     Tutorial 1: Decoding Neural Responses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D5_DeepLearning/student/W1D5_Tutorial2.html">
     Tutorial 2: Convolutional Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D5_DeepLearning/student/W1D5_Tutorial3.html">
     Tutorial 3: Building and Evaluating Normative Encoding Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D5_DeepLearning/student/W1D5_Tutorial4.html">
     Bonus Tutorial: Diving Deeper into Decoding &amp; Encoding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D5_DeepLearning/student/W1D5_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D5_DeepLearning/further_reading.html">
     Suggested further readings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W1D5_DeepLearning/student/W1D5_DaySummary.html">
     Day Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/Bonus_Autoencoders/chapter_title.html">
   Autoencoders (Bonus)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/Bonus_Autoencoders/student/Bonus_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/Bonus_Autoencoders/student/Bonus_Tutorial1.html">
     Tutorial 1: Intro to Autoencoders
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/Bonus_Autoencoders/student/Bonus_Tutorial2.html">
     Tutorial 2: Autoencoder extensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/Bonus_Autoencoders/student/Bonus_Tutorial3.html">
     Tutorial 3: Autoencoders applications
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/Bonus_Autoencoders/student/Bonus_Outro.html">
     Outro
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/Module_WrapUps/MachineLearning.html">
   Machine Learning Wrap-Up
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Dynamical Systems
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W2D2_LinearSystems/chapter_title.html">
   Linear Systems (W2D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D2_LinearSystems/student/W2D2_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D2_LinearSystems/student/W2D2_Tutorial1.html">
     Tutorial 1: Linear dynamical systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D2_LinearSystems/student/W2D2_Tutorial2.html">
     Tutorial 2: Markov Processes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D2_LinearSystems/student/W2D2_Tutorial3.html">
     Tutorial 3: Combining determinism and stochasticity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D2_LinearSystems/student/W2D2_Tutorial4.html">
     Tutorial 4: Autoregressive models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D2_LinearSystems/student/W2D2_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D2_LinearSystems/further_reading.html">
     Suggested further readings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D2_LinearSystems/student/W2D2_DaySummary.html">
     Day Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W2D3_BiologicalNeuronModels/chapter_title.html">
   Biological Neuron Models (W2D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D3_BiologicalNeuronModels/student/W2D3_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D3_BiologicalNeuronModels/student/W2D3_Tutorial1.html">
     Tutorial 1: The Leaky Integrate-and-Fire (LIF) Neuron Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D3_BiologicalNeuronModels/student/W2D3_Tutorial2.html">
     Tutorial 2: Effects of Input Correlation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D3_BiologicalNeuronModels/student/W2D3_Tutorial3.html">
     Tutorial 3: Synaptic transmission - Models of static and dynamic synapses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D3_BiologicalNeuronModels/student/W2D3_Tutorial4.html">
     Bonus Tutorial: Spike-timing dependent plasticity (STDP)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D3_BiologicalNeuronModels/student/W2D3_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D3_BiologicalNeuronModels/further_reading.html">
     Suggested further readings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D3_BiologicalNeuronModels/student/W2D3_DaySummary.html">
     Day Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W2D4_DynamicNetworks/chapter_title.html">
   Dynamic Networks (W2D4)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D4_DynamicNetworks/student/W2D4_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D4_DynamicNetworks/student/W2D4_Tutorial1.html">
     Tutorial 1: Neural Rate Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D4_DynamicNetworks/student/W2D4_Tutorial2.html">
     Tutorial 2: Wilson-Cowan Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D4_DynamicNetworks/student/W2D4_Tutorial3.html">
     Bonus Tutorial: Extending the Wilson-Cowan Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D4_DynamicNetworks/student/W2D4_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D4_DynamicNetworks/further_reading.html">
     Suggested further readings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W2D4_DynamicNetworks/student/W2D4_DaySummary.html">
     Day Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/Module_WrapUps/DynamicalSystems.html">
   Dynamical Systems Wrap-Up
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Stochastic Processes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W3D1_BayesianDecisions/chapter_title.html">
   Bayesian Decisions (W3D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
  <label for="toctree-checkbox-20">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D1_BayesianDecisions/student/W3D1_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D1_BayesianDecisions/student/W3D1_Tutorial1.html">
     Tutorial 1: Bayes with a binary hidden state
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D1_BayesianDecisions/student/W3D1_Tutorial2.html">
     Tutorial 2: Bayesian inference and decisions with continuous hidden state
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D1_BayesianDecisions/student/W3D1_Tutorial3.html">
     Bonus Tutorial : Fitting to data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D1_BayesianDecisions/student/W3D1_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D1_BayesianDecisions/further_reading.html">
     Suggested further readings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D1_BayesianDecisions/student/W3D1_DaySummary.html">
     Day Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W3D2_HiddenDynamics/chapter_title.html">
   Hidden Dynamics (W3D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
  <label for="toctree-checkbox-21">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D2_HiddenDynamics/student/W3D2_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D2_HiddenDynamics/student/W3D2_Tutorial1.html">
     Tutorial 1: Sequential Probability Ratio Test
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D2_HiddenDynamics/student/W3D2_Tutorial2.html">
     Tutorial 2: Hidden Markov Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D2_HiddenDynamics/student/W3D2_Tutorial3.html">
     Tutorial 3: The Kalman Filter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D2_HiddenDynamics/student/W3D2_Tutorial4.html">
     Bonus Tutorial 4: The Kalman Filter, part 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D2_HiddenDynamics/student/W3D2_Tutorial5.html">
     Bonus Tutorial 5: Expectation Maximization for spiking neurons
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D2_HiddenDynamics/student/W3D2_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D2_HiddenDynamics/further_reading.html">
     Suggested further readings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D2_HiddenDynamics/student/W3D2_DaySummary.html">
     Day Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W3D3_OptimalControl/chapter_title.html">
   Optimal Control (W3D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
  <label for="toctree-checkbox-22">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D3_OptimalControl/student/W3D3_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D3_OptimalControl/student/W3D3_Tutorial1.html">
     Tutorial 1: Optimal Control for Discrete States
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D3_OptimalControl/student/W3D3_Tutorial2.html">
     Tutorial 2: Optimal Control for Continuous State
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D3_OptimalControl/student/W3D3_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D3_OptimalControl/further_reading.html">
     Suggested further readings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D3_OptimalControl/student/W3D3_DaySummary.html">
     Day Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W3D4_ReinforcementLearning/chapter_title.html">
   Reinforcement Learning (W3D4)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
  <label for="toctree-checkbox-23">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D4_ReinforcementLearning/student/W3D4_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D4_ReinforcementLearning/student/W3D4_Tutorial1.html">
     Tutorial 1: Learning to Predict
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D4_ReinforcementLearning/student/W3D4_Tutorial2.html">
     Tutorial 2: Learning to Act: Multi-Armed Bandits
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D4_ReinforcementLearning/student/W3D4_Tutorial3.html">
     Tutorial 3: Learning to Act: Q-Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D4_ReinforcementLearning/student/W3D4_Tutorial4.html">
     Tutorial 4: Model-Based Reinforcement Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D4_ReinforcementLearning/student/W3D4_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D4_ReinforcementLearning/further_reading.html">
     Suggested further readings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D4_ReinforcementLearning/student/W3D4_DaySummary.html">
     Day Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/W3D5_NetworkCausality/chapter_title.html">
   Network Causality (W3D5)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
  <label for="toctree-checkbox-24">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D5_NetworkCausality/student/W3D5_Intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D5_NetworkCausality/student/W3D5_Tutorial1.html">
     Tutorial 1: Interventions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D5_NetworkCausality/student/W3D5_Tutorial2.html">
     Tutorial 2: Correlations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D5_NetworkCausality/student/W3D5_Tutorial3.html">
     Tutorial 3: Simultaneous fitting/regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D5_NetworkCausality/student/W3D5_Tutorial4.html">
     Tutorial 4: Instrumental Variables
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D5_NetworkCausality/student/W3D5_Outro.html">
     Outro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D5_NetworkCausality/further_reading.html">
     Suggested further readings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/W3D5_NetworkCausality/student/W3D5_DaySummary.html">
     Day Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/Module_WrapUps/StochasticProcesses.html">
   Stochastic Processes Wrap-Up
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Project Booklet
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../README.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/project_guidance.html">
   Daily guide for projects
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Modeling Step-by-Step Guide
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
  <label for="toctree-checkbox-25">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="ModelingSteps_1through4.html">
     Modeling Steps 1 - 4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ModelingSteps_5through10.html">
     Modeling Steps 5 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="TrainIllusionModel.html">
     Example Model Project: the Train Illusion
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Example Data Project: the Train Illusion
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../docs/datasets_overview.html">
   Datasets
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
  <label for="toctree-checkbox-26">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../docs/neurons.html">
     Neurons
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/>
    <label for="toctree-checkbox-27">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../neurons/README.html">
       Guide
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../neurons/neurons_videos.html">
       Overview videos
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../docs/fMRI.html">
     fMRI
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/>
    <label for="toctree-checkbox-28">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../fMRI/README.html">
       Guide
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../fMRI/fMRI_videos.html">
       Overview videos
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../docs/ECoG.html">
     ECoG
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/>
    <label for="toctree-checkbox-29">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../ECoG/README.html">
       Guide
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../ECoG/ECoG_videos.html">
       Overview videos
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../docs/behavior.html">
     Behavior
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/>
    <label for="toctree-checkbox-30">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../behavior/README.html">
       Guide
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../behavior/behavior_videos.html">
       Overview videos
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../docs/theory.html">
     Theory
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/>
    <label for="toctree-checkbox-31">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../theory/README.html">
       Guide
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/project_templates.html">
   Project Templates
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../docs/project_2020_highlights.html">
   Projects 2020
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/>
  <label for="toctree-checkbox-32">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/projects_2020/neurons.html">
     Neurons
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/projects_2020/theory.html">
     Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/projects_2020/behavior.html">
     Behavior
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/projects_2020/fMRI.html">
     fMRI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/projects_2020/eeg.html">
     EEG
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/NeuromatchAcademy/course-content"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/NeuromatchAcademy/course-content/issues/new?title=Issue%20on%20page%20%2Fprojects/modelingsteps/TrainIllusionDataProject.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/projects/modelingsteps/TrainIllusionDataProject.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Example Data Project: the Train Illusion
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setup">
     Setup
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generate-data">
     Generate Data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-functions">
     Plot Functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#phenomenon">
   Phenomenon
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question">
   Question
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#background">
   Background
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ingredients">
   Ingredients
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hypotheses">
   Hypotheses
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#selected-toolkit">
   Selected toolkit
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-draft">
   Model draft
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-implementation">
   Model implementation
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-completion">
   Model completion
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-evaluation-testing">
   Model evaluation &amp; testing
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#abstract">
   Abstract
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#final-thoughts">
   Final thoughts
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Example Data Project: the Train Illusion</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Example Data Project: the Train Illusion
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setup">
     Setup
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generate-data">
     Generate Data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-functions">
     Plot Functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#phenomenon">
   Phenomenon
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question">
   Question
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#background">
   Background
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ingredients">
   Ingredients
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hypotheses">
   Hypotheses
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#selected-toolkit">
   Selected toolkit
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-draft">
   Model draft
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-implementation">
   Model implementation
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-completion">
   Model completion
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-evaluation-testing">
   Model evaluation &amp; testing
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#abstract">
   Abstract
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#final-thoughts">
   Final thoughts
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <p><a href="https://colab.research.google.com/github/NeuromatchAcademy/course-content/blob/main/projects/modelingsteps/TrainIllusionDataProject.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a>   <a href="https://kaggle.com/kernels/welcome?src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content/main/projects/modelingsteps/TrainIllusionDataProject.ipynb" target="_blank"><img alt="Open in Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg" /></a></p>
<div class="section" id="example-data-project-the-train-illusion">
<h1>Example Data Project: the Train Illusion<a class="headerlink" href="#example-data-project-the-train-illusion" title="Permalink to this headline">¶</a></h1>
<p>Marius ‘t Hart, Megan Peters, Paul Schrater, Jean Laurens, Gunnar Blohm</p>
<p><strong>Disclaimer</strong>:  this is a “toy” data neuroscience project used to demonstrate the <a class="reference external" href="https://doi.org/10.1523/ENEURO.0352-19.2019">10 step procedure of how-to-model</a>. It is not meant to be state of the art research.</p>
<p align='center'><img src='https://github.com/NeuromatchAcademy/widgets/blob/main/sponsors.png?raw=True'/></p><div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Setup</span>

<span class="c1"># for matrices and plotting:</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># for random distributions:</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span><span class="p">,</span> <span class="n">poisson</span>

<span class="c1"># for logistic regression:</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="o">!</span>pip install tqdm --quiet
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="generate-data">
<h2>Generate Data<a class="headerlink" href="#generate-data" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Generate Data</span>

<span class="k">def</span> <span class="nf">generateSpikeTrains</span><span class="p">():</span>

  <span class="n">gain</span>        <span class="o">=</span> <span class="mi">2</span>
  <span class="n">neurons</span>     <span class="o">=</span> <span class="mi">50</span>
  <span class="n">movements</span>   <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
  <span class="n">repetitions</span> <span class="o">=</span> <span class="mi">800</span>

  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>

  <span class="c1"># set up the basic parameters:</span>
  <span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">100</span>
  <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span>
  <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="o">+</span><span class="n">dt</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>                                            <span class="c1"># a time interval</span>
  <span class="n">Velocity_sigma</span> <span class="o">=</span> <span class="mf">0.5</span>                                                         <span class="c1"># std dev of the velocity profile</span>
  <span class="n">Velocity_Profile</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">Velocity_sigma</span><span class="p">)</span><span class="o">/</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">Velocity_sigma</span><span class="p">)</span> <span class="c1"># The Gaussian velocity profile, normalized to a peak of 1</span>

  <span class="c1"># set up the neuron properties:</span>
  <span class="n">Gains</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">neurons</span><span class="p">)</span> <span class="o">*</span> <span class="n">gain</span>          <span class="c1"># random sensitivity between 0 and `gain`</span>
  <span class="n">FRs</span>   <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">neurons</span><span class="p">)</span> <span class="o">*</span> <span class="mi">60</span> <span class="p">)</span> <span class="o">-</span> <span class="mi">10</span>    <span class="c1"># random base firing rate between -10 and 50</span>

  <span class="c1"># output matrix will have this shape:</span>
  <span class="n">target_shape</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">movements</span><span class="p">),</span> <span class="n">repetitions</span><span class="p">,</span> <span class="n">neurons</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Velocity_Profile</span><span class="p">)]</span>

  <span class="c1"># build matrix for spikes, first, they depend on the velocity profile:</span>
  <span class="n">Spikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">Velocity_Profile</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">Velocity_Profile</span><span class="p">)]),</span><span class="nb">len</span><span class="p">(</span><span class="n">movements</span><span class="p">)</span><span class="o">*</span><span class="n">repetitions</span><span class="o">*</span><span class="n">neurons</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">target_shape</span><span class="p">)</span>

  <span class="c1"># multiplied by gains:</span>
  <span class="n">S_gains</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">Gains</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">neurons</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">movements</span><span class="p">)</span><span class="o">*</span><span class="n">repetitions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">target_shape</span><span class="p">[:</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">Velocity_Profile</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">target_shape</span><span class="p">)</span>
  <span class="n">Spikes</span> <span class="o">=</span> <span class="n">Spikes</span> <span class="o">*</span> <span class="n">S_gains</span>

  <span class="c1"># and multiplied by the movement:</span>
  <span class="n">S_moves</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">movements</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">movements</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">repetitions</span><span class="o">*</span><span class="n">neurons</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">Velocity_Profile</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">3</span> <span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">target_shape</span><span class="p">)</span>
  <span class="n">Spikes</span> <span class="o">=</span> <span class="n">Spikes</span> <span class="o">*</span> <span class="n">S_moves</span>

  <span class="c1"># on top of a baseline firing rate:</span>
  <span class="n">S_FR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">FRs</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">neurons</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">movements</span><span class="p">)</span><span class="o">*</span><span class="n">repetitions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">target_shape</span><span class="p">[:</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">Velocity_Profile</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">target_shape</span><span class="p">)</span>
  <span class="n">Spikes</span> <span class="o">=</span> <span class="n">Spikes</span> <span class="o">+</span> <span class="n">S_FR</span>

  <span class="c1"># can not run the poisson random number generator on input lower than 0:</span>
  <span class="n">Spikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Spikes</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Spikes</span><span class="p">)</span>

  <span class="c1"># so far, these were expected firing rates per second, correct for dt:</span>
  <span class="n">Spikes</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">Spikes</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span>

  <span class="k">return</span><span class="p">(</span><span class="n">Spikes</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">subsetPerception</span><span class="p">(</span><span class="n">spikes</span><span class="p">):</span>

  <span class="n">movements</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
  <span class="n">split</span>     <span class="o">=</span> <span class="mi">400</span>
  <span class="n">subset</span>    <span class="o">=</span> <span class="mi">40</span>
  <span class="n">hwin</span>      <span class="o">=</span> <span class="mi">3</span>

  <span class="p">[</span><span class="n">num_movements</span><span class="p">,</span> <span class="n">repetitions</span><span class="p">,</span> <span class="n">neurons</span><span class="p">,</span> <span class="n">timepoints</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>

  <span class="n">decision</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">num_movements</span><span class="p">,</span> <span class="n">repetitions</span><span class="p">])</span>

  <span class="c1"># ground truth for logistic regression:</span>
  <span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">split</span><span class="p">)</span>
  <span class="n">y_test</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">repetitions</span><span class="o">-</span><span class="n">split</span><span class="p">)</span>

  <span class="n">m_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">movements</span><span class="p">,</span> <span class="n">split</span><span class="p">)</span>
  <span class="n">m_test</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">movements</span><span class="p">,</span> <span class="n">split</span><span class="p">)</span>

  <span class="c1"># reproduce the time points:</span>
  <span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">100</span>
  <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span>
  <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="o">+</span><span class="n">dt</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

  <span class="n">w_idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">hwin</span><span class="o">*</span><span class="n">dt</span><span class="p">))</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
  <span class="n">w_0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">w_idx</span><span class="p">)</span>
  <span class="n">w_1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">w_idx</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>  <span class="c1"># python...</span>

  <span class="c1"># get the total spike counts from stationary and movement trials:</span>
  <span class="n">spikes_stat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">spikes</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,:,:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">spikes_move</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">spikes</span><span class="p">[</span><span class="mi">1</span><span class="p">:,:,:,:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

  <span class="n">train_spikes_stat</span> <span class="o">=</span> <span class="n">spikes_stat</span><span class="p">[:</span><span class="n">split</span><span class="p">,:]</span>
  <span class="n">train_spikes_move</span> <span class="o">=</span> <span class="n">spikes_move</span><span class="p">[:,:</span><span class="n">split</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">neurons</span><span class="p">])</span>

  <span class="n">test_spikes_stat</span> <span class="o">=</span> <span class="n">spikes_stat</span><span class="p">[</span><span class="n">split</span><span class="p">:,:]</span>
  <span class="n">test_spikes_move</span> <span class="o">=</span> <span class="n">spikes_move</span><span class="p">[:,</span><span class="n">split</span><span class="p">:,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">neurons</span><span class="p">])</span>

  <span class="c1"># data to use to predict y:</span>
  <span class="n">x_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">train_spikes_stat</span><span class="p">,</span> <span class="n">train_spikes_move</span><span class="p">))</span>
  <span class="n">x_test</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span> <span class="n">test_spikes_stat</span><span class="p">,</span>  <span class="n">test_spikes_move</span><span class="p">))</span>

  <span class="c1"># this line creates a logistics regression model object, and immediately fits it:</span>
  <span class="n">population_model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

  <span class="c1"># solver, one of: &#39;liblinear&#39;, &#39;newton-cg&#39;, &#39;lbfgs&#39;, &#39;sag&#39;, and &#39;saga&#39;</span>
  <span class="c1"># some of those require certain other options</span>
  <span class="c1">#print(population_model.coef_)       # slope</span>
  <span class="c1">#print(population_model.intercept_)  # intercept</span>

  <span class="n">ground_truth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">population_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">))</span>
  <span class="n">ground_truth</span> <span class="o">=</span> <span class="n">ground_truth</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

  <span class="n">output</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="n">output</span><span class="p">[</span><span class="s1">&#39;perception&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ground_truth</span>
  <span class="n">output</span><span class="p">[</span><span class="s1">&#39;spikes&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="n">spikes</span><span class="p">[:,</span><span class="n">split</span><span class="p">:,:</span><span class="n">subset</span><span class="p">,:]</span>

  <span class="k">return</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">getData</span><span class="p">():</span>

  <span class="n">spikes</span> <span class="o">=</span> <span class="n">generateSpikeTrains</span><span class="p">()</span>

  <span class="n">dataset</span> <span class="o">=</span> <span class="n">subsetPerception</span><span class="p">(</span><span class="n">spikes</span><span class="o">=</span><span class="n">spikes</span><span class="p">)</span>

  <span class="k">return</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">getData</span><span class="p">()</span>
<span class="n">perception</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;perception&#39;</span><span class="p">]</span>
<span class="n">spikes</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;spikes&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-functions">
<h2>Plot Functions<a class="headerlink" href="#plot-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Plot Functions</span>

<span class="k">def</span> <span class="nf">rasterplot</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span><span class="n">movement</span><span class="p">,</span><span class="n">trial</span><span class="p">):</span>

  <span class="p">[</span><span class="n">movements</span><span class="p">,</span> <span class="n">trials</span><span class="p">,</span> <span class="n">neurons</span><span class="p">,</span> <span class="n">timepoints</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>

  <span class="n">trial_spikes</span> <span class="o">=</span> <span class="n">spikes</span><span class="p">[</span><span class="n">movement</span><span class="p">,</span><span class="n">trial</span><span class="p">,:,:]</span>

  <span class="n">trial_events</span> <span class="o">=</span> <span class="p">[((</span><span class="n">trial_spikes</span><span class="p">[</span><span class="n">x</span><span class="p">,:]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">150</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neurons</span><span class="p">)]</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">dt</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">100</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">eventplot</span><span class="p">(</span><span class="n">trial_events</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;movement: </span><span class="si">%d</span><span class="s1"> - trial: </span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">movement</span><span class="p">,</span> <span class="n">trial</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;neuron&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time [s]&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plotCrossValAccuracies</span><span class="p">(</span><span class="n">accuracies</span><span class="p">):</span>
  <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">accuracies</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">widths</span><span class="o">=</span><span class="mf">.7</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">accuracies</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">,</span>
    <span class="n">yticks</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Average test accuracy: </span><span class="si">{</span><span class="n">accuracies</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="phenomenon">
<h1>Phenomenon<a class="headerlink" href="#phenomenon" title="Permalink to this headline">¶</a></h1>
<p><em>Part of Steps 1-2</em></p>
<p>The train illusion occurs when sitting on a train and viewing another train outside the window. Suddenly, the other train <em>seems</em> to move, i.e. you experience visual motion of the other train relative to your train. But which train is actually moving?</p>
<p>Often people mix this up. In particular, they think their own train might be moving when it’s the other train that moves; or vice versa. The illusion is usually resolved once you gain vision of the surroundings that lets you disambiguate the relative motion; or if you experience strong vibrations indicating that it is indeed your own train that is in motion.</p>
</div>
<hr class="docutils" />
<div class="section" id="question">
<h1>Question<a class="headerlink" href="#question" title="Permalink to this headline">¶</a></h1>
<p><em>Part of Step 1</em></p>
<p>We assume that we have build the train illusion model (see the other example project colab). That model predicts that accumulated sensory evidence from vestibular signals determines the decision of whether self-motion is experienced or not. We now have vestibular neuron data (simulated in our case, but let’s pretend) and would like to see if that prediction holds true.</p>
<p>The data contains <span class="math notranslate nohighlight">\(N\)</span> neurons and <span class="math notranslate nohighlight">\(M\)</span> trials for each of 3 motion conditions: no self-motion, slowly accelerating self-motion and faster accelerating self-motion.</p>
<div class="amsmath math notranslate nohighlight" id="equation-199c9c89-d7f5-4260-b43d-ed9027eea334">
<span class="eqno">(466)<a class="headerlink" href="#equation-199c9c89-d7f5-4260-b43d-ed9027eea334" title="Permalink to this equation">¶</a></span>\[\begin{align}
N &amp;= 40\\
M &amp;= 400\\
\end{align}\]</div>
<p><strong>So we can ask the following question</strong>: “Does accumulated vestibular neuron activity correlate with self-motion judgements?”</p>
</div>
<div class="section" id="background">
<h1>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h1>
<p><em>Part of step 2</em></p>
<p>While it seems a well-known fact that vestibular signals are noisy, we should check if we can also find this in the literature.</p>
<p>Let’s also see what’s in our data, there should be a 4d array called <code class="docutils literal notranslate"><span class="pre">spikes</span></code> that has spike counts (positive integers), a 2d array called <code class="docutils literal notranslate"><span class="pre">perception</span></code> with self-motion judgements (0=no motion or 1=motion). Let’s see what this data looks like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">spikes</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">perception</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">perception</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3, 400, 40, 301)
(3, 400)
[0.355  0.7575 0.975 ]
</pre></div>
</div>
</div>
</div>
<p>In the <code class="docutils literal notranslate"><span class="pre">spikes</span></code> array, we see our 3 acceleration conditions (first dimension), with 400 trials each (second dimensions) and simultaneous recordings from 40 neurons (third dimension), across 3 seconds in 10 ms bins (fourth dimension). The first two dimensions are also there in the <code class="docutils literal notranslate"><span class="pre">perception</span></code> array.</p>
<p>Perfect perception would have looked like [0, 1, 1]. The average judgements are far from correct (lots of self-motion illusions) but they do make some sense: it’s closer to 0 in the no-motion condition and closer to 1 in both of the real-motion conditions.</p>
<p>The idea of our project is that the vestibular signals are noisy so that they might be mis-interpreted by the brain. Let’s see if we can reproduce the stimuli from the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">move_no</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">100</span><span class="p">),(</span><span class="mi">1</span><span class="o">/</span><span class="mi">100</span><span class="p">)),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spikes</span><span class="p">[</span><span class="n">move_no</span><span class="p">,:,:,:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;no motion&#39;</span><span class="p">,</span> <span class="s1">&#39;$1 m/s^2$&#39;</span><span class="p">,</span> <span class="s1">&#39;$2 m/s^2$&#39;</span><span class="p">][</span><span class="n">move_no</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time [s]&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;averaged spike counts&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f6bfb545bd0&gt;
</pre></div>
</div>
<img alt="../../_images/TrainIllusionDataProject_16_1.png" src="../../_images/TrainIllusionDataProject_16_1.png" />
</div>
</div>
<p>Blue is the no-motion condition, and produces flat average spike counts across the 3 s time interval. The orange and green line do show a bell-shaped curve that corresponds to the acceleration profile. But there also seems to be considerable noise: exactly what we need. Let’s see what the spike trains for a single trial look like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">move</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
  <span class="n">rasterplot</span><span class="p">(</span><span class="n">spikes</span> <span class="o">=</span> <span class="n">spikes</span><span class="p">,</span> <span class="n">movement</span> <span class="o">=</span> <span class="n">move</span><span class="p">,</span> <span class="n">trial</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/TrainIllusionDataProject_18_0.png" src="../../_images/TrainIllusionDataProject_18_0.png" />
<img alt="../../_images/TrainIllusionDataProject_18_1.png" src="../../_images/TrainIllusionDataProject_18_1.png" />
<img alt="../../_images/TrainIllusionDataProject_18_2.png" src="../../_images/TrainIllusionDataProject_18_2.png" />
</div>
</div>
<p>You can change the trial number in the bit of code above to compare what the rasterplots look like in different trials. You’ll notice that they all look kind of the same: the 3 conditions are very hard (impossible?) to distinguish by eye-balling.</p>
<p>Now that we have seen the data, let’s see if we can extract self-motion judgements from the spike counts.</p>
</div>
<hr class="docutils" />
<div class="section" id="ingredients">
<h1>Ingredients<a class="headerlink" href="#ingredients" title="Permalink to this headline">¶</a></h1>
<p><em>Part of step 3</em></p>
<p>In order to address our question we need to design an appropriate computational data analysis pipeline. We did some brainstorming and think that we need to somehow extract the self-motion judgements from the spike counts of our neurons. Based on that, our algorithm needs to make a decision: was there self motion or not? This is a classical 2-choice classification problem. We will have to transform the raw spike data into the right input for the algorithm (spike pre-processing).</p>
<p>So we determined that we probably needed the following ingredients:</p>
<ul class="simple">
<li><p>spike trains <span class="math notranslate nohighlight">\(S\)</span> of 3-second trials (10ms spike bins)</p></li>
<li><p>ground truth movement <span class="math notranslate nohighlight">\(m_r\)</span> (real) and perceived movement <span class="math notranslate nohighlight">\(m_p\)</span></p></li>
<li><p>some form of classifier <span class="math notranslate nohighlight">\(C\)</span> giving us a classification <span class="math notranslate nohighlight">\(c\)</span></p></li>
<li><p>spike pre-processing</p></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="hypotheses">
<h1>Hypotheses<a class="headerlink" href="#hypotheses" title="Permalink to this headline">¶</a></h1>
<p><em>Part of step 4</em></p>
<p>We think that noise in the signal drives whether or not people perceive self motion. Maybe the brain uses the strongest signal at peak acceleration to decide on self motion, but we actually think it is better to accumulate evidence over some period of time. We want to test this. The noise idea also means that when the signal-to-noise ratio is higher, the brain does better, and this would be in the faster acceleration condition. We want to test this too.</p>
<p>We came up with the following hypotheses focussing on specific details of our overall research question:</p>
<ul class="simple">
<li><p>Hyp 1: Accumulated vestibular spike rates explain self-motion judgements better than average spike rates around peak acceleration.</p></li>
<li><p>Hyp 2: Classification performance should be better for faster vs slower self-motion.</p></li>
</ul>
<blockquote>
<div><p>There are many other hypotheses you could come up with, but for simplicity, let’s go with those.</p>
</div></blockquote>
<p>Mathematically, we can write our hypotheses as follows (using our above ingredients):</p>
<ul class="simple">
<li><p>Hyp 1: <span class="math notranslate nohighlight">\(\mathbf{E}(c_{accum})&gt;\mathbf{E}(c_{win})\)</span></p></li>
<li><p>Hyp 2: <span class="math notranslate nohighlight">\(\mathbf{E}(c_{fast})&gt;\mathbf{E}(c_{slow})\)</span></p></li>
</ul>
<p>Where <span class="math notranslate nohighlight">\(\mathbf{E}\)</span> denotes taking the expected value (in this case the mean) of its argument: classification outcome in a given trial type.</p>
</div>
<hr class="docutils" />
<div class="section" id="selected-toolkit">
<h1>Selected toolkit<a class="headerlink" href="#selected-toolkit" title="Permalink to this headline">¶</a></h1>
<p><em>Part of step 5</em></p>
<p>We want to build some form of classification pipeline. There are many options here, but a simple decoder would be a good start. Since we will learn all about Generalized Linear Models soon, we decided to use that! From W1D4: Generalized Linear Models there were two models that looked relevant:</p>
<ul class="simple">
<li><p>Linear-Nonlinear-Poisson GLM: predict spike counts from stimulus</p></li>
<li><p>Logistic Regression: predict stimulus from spike counts</p></li>
</ul>
<p>Here we want to predict self-motion from spike counts, so we pick Logistic Regression.</p>
</div>
<hr class="docutils" />
<div class="section" id="model-draft">
<h1>Model draft<a class="headerlink" href="#model-draft" title="Permalink to this headline">¶</a></h1>
<p><em>Part of step 6</em></p>
<p>Brainstorming on the whiteboard, we came up with this set of steps:</p>
<ol class="simple">
<li><p>convert spike count data into design matrix: trials x neurons (with accumulated or windowed data)</p></li>
<li><p>get the classes each trial belongs to: stimulus (stationary / moving) or self-motion judgements (moving or not?) as a vector array</p></li>
<li><p>split data into train and test sets (200 trials each for the 3 conditions?) with an equal number of each class</p></li>
<li><p>fit logistic regression model on training set, and get predictions for test set</p></li>
</ol>
<p><img alt="picture" src="https://github.com/NeuromatchAcademy/course-content/blob/main/tutorials/static/data_analysis_step6.jpeg?raw=1" /></p>
</div>
<hr class="docutils" />
<div class="section" id="model-implementation">
<h1>Model implementation<a class="headerlink" href="#model-implementation" title="Permalink to this headline">¶</a></h1>
<p><em>Part of step 7</em></p>
<p>Below is a function that gets us the design matrix of observations X features (in this case: trials X neurons). It sums all spike counts, either across the whole time interval, or a window, specified in seconds before and after the peak acceleration at time=0 (it is the half-width of the window: <code class="docutils literal notranslate"><span class="pre">halfwin</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">m_p</span> <span class="o">=</span> <span class="n">perception</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">a_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">400</span><span class="p">)</span> <span class="c1"># for grouping in cross validation? maybe not</span>

<span class="k">def</span> <span class="nf">getDesignMatrix</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="n">motions</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">halfwin</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the design matrix and vector of classes for a logistic regression.</span>

<span class="sd">    Args:</span>
<span class="sd">        spikes (numpy.ndarray): a 4d matrix with spike counts for 1) three motion</span>
<span class="sd">        conditions, 2) 400 trials, 3) 40 neurons, 4) 301 time bins</span>
<span class="sd">        motions (list): motion conditions to include, any subset of [0,1,2]</span>
<span class="sd">        classes (list): list of length 3 * 400 with classes to use for the</span>
<span class="sd">        logistic regression</span>
<span class="sd">        halfwin (None or float): None to use the whole 3 s time interval, or a</span>
<span class="sd">        value between 0 and 1.5 seconds as the extent of the window from 0 (when</span>
<span class="sd">        acceleration peaks) in both directions.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list of numpy.ndarray): first element of the list is the design matrix</span>
<span class="sd">        of shape [trials] X [neurons], second elements is a 1d matrix to use as</span>
<span class="sd">        a vector of classes to predict from the design matrix</span>

<span class="sd">    This function can be used to get the right design matrix and set of class</span>
<span class="sd">    labels for a variety of logistic regressions we might want to do.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="c1"># select motion conditions:</span>
  <span class="n">spikes</span> <span class="o">=</span> <span class="n">spikes</span><span class="p">[</span><span class="n">motions</span><span class="p">,:,:,:]</span>
  <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])[</span><span class="n">motions</span><span class="p">,:])</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

  <span class="p">[</span><span class="n">movstims</span><span class="p">,</span> <span class="n">trials</span><span class="p">,</span> <span class="n">neurons</span><span class="p">,</span> <span class="n">timepoints</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>

  <span class="c1"># first we get the window (if any):</span>
  <span class="k">if</span> <span class="n">halfwin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">return</span><span class="p">(</span> <span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">movstims</span><span class="o">*</span><span class="n">trials</span><span class="p">,</span><span class="n">neurons</span><span class="p">]),</span> <span class="n">y</span> <span class="p">]</span> <span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">100</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="o">+</span><span class="n">dt</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
    <span class="n">win_idx</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">halfwin</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">w_0</span><span class="p">,</span> <span class="n">w_1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">win_idx</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">win_idx</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">return</span><span class="p">(</span> <span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spikes</span><span class="p">[:,:,:,</span><span class="n">w_0</span><span class="p">:</span><span class="n">w_1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">movstims</span><span class="o">*</span><span class="n">trials</span><span class="p">,</span><span class="n">neurons</span><span class="p">]),</span> <span class="n">y</span> <span class="p">]</span> <span class="p">)</span>


<span class="c1"># test the function:</span>
<span class="p">[</span><span class="n">desmat</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">getDesignMatrix</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="n">motions</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">classes</span><span class="o">=</span><span class="n">m_r</span><span class="p">)</span>
<span class="c1"># let&#39;s check the shape:</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">desmat</span><span class="p">))</span>
<span class="c1"># and let&#39;s check if the mean sum of spikes checks out:</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">mov</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">desmat</span><span class="p">[(</span><span class="n">mov</span><span class="o">*</span><span class="mi">400</span><span class="p">):((</span><span class="n">mov</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">400</span><span class="p">),:]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(800, 40)
[76.33475 77.53275 78.61975]
76.33475
77.53275
</pre></div>
</div>
</div>
</div>
<p>First, the design matrix: <code class="docutils literal notranslate"><span class="pre">desmat</span></code> has the right shape: 800 trials (for two conditions), by 40 neurons.</p>
<p>We also get the same average spike counts from our function (76.3 and 77.5) as when calculating it ‘by hand’ ([76.33475 77.53275 78.61975]).</p>
<p>This means our function <code class="docutils literal notranslate"><span class="pre">getDesignMatrix()</span></code> works correctly (unit test).</p>
<p>It also gets us the classes for each trial. We can use both judgements, <span class="math notranslate nohighlight">\(m_p\)</span>, and stimuli, <span class="math notranslate nohighlight">\(m_r\)</span>, as one vector, and <code class="docutils literal notranslate"><span class="pre">getDesignMatrix()</span></code> returns the correct subset (depending on which motion conditions are used) as the second variable.</p>
<p>We wanted to split the data into a training and test set, but we can have scikit-learn do this for us with the <code class="docutils literal notranslate"><span class="pre">cross_val_score()</span></code> function, as we saw in the GLM day:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">accuracies</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">),</span> <span class="n">X</span><span class="o">=</span><span class="n">desmat</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plotCrossValAccuracies</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span> <span class="c1"># this plotting function is copied from W1D4: Generalized Linear Models</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/TrainIllusionDataProject_30_0.png" src="../../_images/TrainIllusionDataProject_30_0.png" />
</div>
</div>
<p>We asked for 8 cross validations, which show up as the blue dots in the graph (two have the same accuracy). Prediction accuracy ranges from 56% to 72%, with the average at 65%, and the orange line is the median. Given the noisy data, that is not too bad actually.</p>
<p>But maybe it’s better to split it according to the conditions where there is motion but of different magnitude. It should work better to classify higher acceleration motion from no motion as compared to classifying the lower acceleration motion.</p>
<p>Maybe it also works better to ignore some of the noise at the beginning and end of each trial by focussing on the spikes around the maximum acceleration, using our window option. The average spike count plot above, seems to best discriminate between the three motion conditions around peak acceleration (at 0 s).</p>
<p>We also want to test if it’s possible to predict the self-motion judgements rather than the actual motion.</p>
<p>So we write a function that brings it all together:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">m_p</span> <span class="o">=</span> <span class="n">perception</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">classifyMotionFromSpikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">halfwin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">motions</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">cv</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs one logistic regression using the specified parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        spikes (numpy.ndarray): a 4d matrix with spike counts for 1) three motion</span>
<span class="sd">        conditions, 2) 400 trials, 3) 40 neurons, 4) 301 time bins</span>
<span class="sd">        classes (list): list of length 3 * 400 with classes to use for the</span>
<span class="sd">        logistic regression</span>
<span class="sd">        halfwin: None to use the whole 3 s time interval, or a value between 0</span>
<span class="sd">        and 0.750 seconds as the extent of the window from 0 (when acceleration</span>
<span class="sd">        peaks)</span>
<span class="sd">        motions (list): motion conditions to include, any subset of [0,1,2]</span>
<span class="sd">        cv (int): number of cross validations to do in logistic regression</span>

<span class="sd">    Returns:</span>
<span class="sd">        (numpy.ndarray): 1d array of shape (cv,) with prediction accuracies for</span>
<span class="sd">        each cross validation</span>

<span class="sd">    This function uses our getDesignMatrix() function according to specification</span>
<span class="sd">    and then uses cross-validated logistic regression and returns the accuracy</span>
<span class="sd">    for each run of the model.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="c1"># get the right design matrix:</span>
  <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">getDesignMatrix</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="n">motions</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="n">classes</span><span class="p">,</span> <span class="n">halfwin</span><span class="o">=</span><span class="n">halfwin</span><span class="p">)</span>

  <span class="c1"># right now, we are not using regularization:</span>
  <span class="k">return</span><span class="p">(</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">),</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">)</span> <span class="p">)</span>

<span class="n">accuracies</span> <span class="o">=</span> <span class="n">classifyMotionFromSpikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="n">m_r</span><span class="p">,</span> <span class="n">motions</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plotCrossValAccuracies</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/TrainIllusionDataProject_32_0.png" src="../../_images/TrainIllusionDataProject_32_0.png" />
</div>
</div>
<p>This is the exact same figure as before, so our function <code class="docutils literal notranslate"><span class="pre">classifyMotionFromSpikes()</span></code> also works as intended.</p>
</div>
<hr class="docutils" />
<div class="section" id="model-completion">
<h1>Model completion<a class="headerlink" href="#model-completion" title="Permalink to this headline">¶</a></h1>
<p><em>Part of step 8</em></p>
<p><strong>Can we answer our question?</strong> Question: “Does accumulated vestibular neuron activity correlate with self-motion judgements?” Yes, we can get an answer to the question by applying our analysis to predict self-motion judgements.</p>
<p><strong>Can we speak to our hypothesis?</strong> We had two hypotheses: 1) prediction is better with total accumulated spike counts than from a window around peak acceleration, and 2) prediction is better with higher acceleration as the signal-to-noise ratio increases.</p>
<p><strong>Does the model reach our goals?</strong> We want to understand if motion judgement and not true motion correlates better with vestibular neural activity.</p>
<p>Note: We have somewhat refined our goal here by explicitly contrasting true motion with motion judgements.</p>
</div>
<hr class="docutils" />
<div class="section" id="model-evaluation-testing">
<h1>Model evaluation &amp; testing<a class="headerlink" href="#model-evaluation-testing" title="Permalink to this headline">¶</a></h1>
<p><em>Part of step 9</em></p>
<p>We can now evaluate the performance of our analysis pipeline.</p>
<p>To do so, we will run the logistic regression quite a few times: on all data or split by the velocities, and then we use the data to predict the presence of real motion, or the judgements of self-motion. We repeat this for total accumulated spikes and for a window around the peak acceleration. And then we’ll plot the average classification performance in those 12 cases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">runAnalysis</span><span class="p">(</span><span class="n">spikes</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs one logistic regression using the specified parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        spikes (numpy.ndarray): a 4d matrix with spike counts for 1) three motion</span>
<span class="sd">        conditions, 2) 400 trials, 3) 40 neurons, 4) 301 time bins</span>

<span class="sd">    Returns:</span>
<span class="sd">        (numpy.ndarray): array of shape (2, 2, 3, 12), where the first dimension</span>
<span class="sd">        denotes full interval or 100 ms window, the second dimension denotes</span>
<span class="sd">        real motion or self-motion judgements, the third dimension denotes slow,</span>
<span class="sd">        fast or all data, and for each there 12 prediction accuracies for each</span>
<span class="sd">        of the 12 cross validations</span>

<span class="sd">    This function uses our classifyMotionFromSpikes()) function according to</span>
<span class="sd">    specification for all the different ways we want to classify the data and</span>
<span class="sd">    gives us the classification performance.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="c1"># variables we use for testing our analysis pipeline:</span>
  <span class="n">m_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">400</span><span class="p">)</span>
  <span class="n">m_p</span> <span class="o">=</span> <span class="n">perception</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
  <span class="n">halfwins</span>    <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.050</span><span class="p">]</span>
  <span class="n">motions</span>     <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
  <span class="n">class_sets</span>  <span class="o">=</span> <span class="p">[</span><span class="n">m_r</span><span class="p">,</span> <span class="n">m_p</span><span class="p">]</span>
  <span class="n">cv</span> <span class="o">=</span> <span class="mi">12</span>

  <span class="c1"># empty array to collect classification performance:</span>
  <span class="n">accuracies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">halfwins</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">class_sets</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">motions</span><span class="p">),</span><span class="n">cv</span><span class="p">])</span>

  <span class="k">for</span> <span class="n">halfwin_no</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">halfwins</span><span class="p">)):</span>

    <span class="n">halfwin</span> <span class="o">=</span> <span class="n">halfwins</span><span class="p">[</span><span class="n">halfwin_no</span><span class="p">]</span>
    <span class="n">lty</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">][</span><span class="n">halfwin_no</span><span class="p">]</span>
    <span class="n">leg_hw</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;accumulated&#39;</span><span class="p">,</span> <span class="s1">&#39;100 ms window&#39;</span><span class="p">][</span><span class="n">halfwin_no</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">classes_no</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">class_sets</span><span class="p">)):</span>

      <span class="n">classes</span> <span class="o">=</span> <span class="n">class_sets</span><span class="p">[</span><span class="n">classes_no</span><span class="p">]</span>
      <span class="n">leg_class</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">,</span> <span class="s1">&#39;judgements&#39;</span><span class="p">][</span><span class="n">classes_no</span><span class="p">]</span>
      <span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;purple&#39;</span><span class="p">][</span><span class="n">classes_no</span><span class="p">]</span>

      <span class="k">for</span> <span class="n">motions_no</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">motions</span><span class="p">)):</span>

        <span class="n">motion</span> <span class="o">=</span> <span class="n">motions</span><span class="p">[</span><span class="n">motions_no</span><span class="p">]</span>
        <span class="n">cond_acc</span> <span class="o">=</span> <span class="n">classifyMotionFromSpikes</span><span class="p">(</span><span class="n">spikes</span>  <span class="o">=</span> <span class="n">spikes</span><span class="p">,</span>
                                            <span class="n">classes</span> <span class="o">=</span> <span class="n">classes</span><span class="p">,</span>
                                            <span class="n">halfwin</span> <span class="o">=</span> <span class="n">halfwin</span><span class="p">,</span>
                                            <span class="n">motions</span> <span class="o">=</span> <span class="n">motion</span><span class="p">,</span>
                                            <span class="n">cv</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">accuracies</span><span class="p">[</span><span class="n">halfwin_no</span><span class="p">,</span><span class="n">classes_no</span><span class="p">,</span><span class="n">motions_no</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">cond_acc</span>

      <span class="n">m_acc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">accuracies</span><span class="p">[</span><span class="n">halfwin_no</span><span class="p">,</span><span class="n">classes_no</span><span class="p">,:,:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

  <span class="k">return</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span>

<span class="c1"># here we run the above function and store the output:</span>
<span class="n">accuracies</span> <span class="o">=</span> <span class="n">runAnalysis</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We will need to plot this output, and to simplify the code, we do that in a separate function, which we write here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plotAccuracies</span><span class="p">(</span><span class="n">accuracies</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the accuracies from our main fitting function.</span>

<span class="sd">    Args:</span>
<span class="sd">        accuarcies (numpy.ndarray): a 4d matrix with performance accuracy for</span>
<span class="sd">        1) full interval or 100 ms window, 2) real motion or self-motion</span>
<span class="sd">        judgements, 3) slow, fast or all conditions, and 4) the 12 cross</span>
<span class="sd">        validations</span>

<span class="sd">    Returns:</span>

<span class="sd">    This function plots the output of our data analysis pipeline and does not</span>
<span class="sd">    return anything.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;classification accuracy&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">3.5</span><span class="p">])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;proportion correct&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;velocity condition vs. stationary&#39;</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">halfwin_no</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>

    <span class="n">lty</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">][</span><span class="n">halfwin_no</span><span class="p">]</span>
    <span class="n">leg_hw</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;accumulated&#39;</span><span class="p">,</span> <span class="s1">&#39;100 ms window&#39;</span><span class="p">][</span><span class="n">halfwin_no</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">classes_no</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>

      <span class="n">leg_class</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">,</span> <span class="s1">&#39;judgements&#39;</span><span class="p">][</span><span class="n">classes_no</span><span class="p">]</span>
      <span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;purple&#39;</span><span class="p">][</span><span class="n">classes_no</span><span class="p">]</span>

      <span class="n">m_acc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">accuracies</span><span class="p">[</span><span class="n">halfwin_no</span><span class="p">,</span><span class="n">classes_no</span><span class="p">,:,:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">m_acc</span><span class="p">,</span> <span class="n">lty</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">leg_class</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">leg_hw</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slow ($1 m/s^2$)&#39;</span><span class="p">,</span><span class="s1">&#39;fast ($2 m/s^2$)&#39;</span><span class="p">,</span><span class="s1">&#39;both&#39;</span><span class="p">])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plotAccuracies</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/TrainIllusionDataProject_38_0.png" src="../../_images/TrainIllusionDataProject_38_0.png" />
</div>
</div>
<p>Well, that’s interesting! The logistic regression doesn’t do a perfect job, but there is information in these results.</p>
<ol class="simple">
<li><p>The dashed lines reflect predictions based on a small window of data, and they do worse than the full data set: this could mean that the brain also integrates signals across longer time frames for perception.</p></li>
<li><p>In the predictions based on accumulated spike counts, the slow movements are harder to separate from no movements than the faster movements. This is clearer when predicting real motion than when predicting self-motion judgements.</p></li>
</ol>
<p>Those were our two hypotheses, but we notice something else:</p>
<ol class="simple">
<li><p>Self-motion judgments display higher decoding accuracy than the actual motion.</p></li>
</ol>
<p>Actually, if self-motion judgements and our logistic regression use input from the same noisy sensors, it kind of makes sense that they would both give similar output. This is in line the notion that self-motion judgements can be wrong because the underlying sensory signals are noisy. Of course, this only works if we record activity from neuronal populations that contribute to self-motion judgements. On the other hand, we would also see this result if the sensory signal was not noisy and we recorded from one of several populations that contribute to self-motion judgements in a noisy way. So we need to do more research here.</p>
<p>Either way, we learned something today!</p>
</div>
<hr class="docutils" />
<div class="section" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h1>
<p><em>Part of Step 10</em></p>
<p>Let’s write a simple abstract following the guidelines.</p>
<p><strong>A. What is the phenomena?</strong> Here summarize the part of the phenomena which your model addresses.</p>
<p><em>When sitting in a stationary train and seeing the train next to them move, people may experience the “train illusion”: they feel like they are moving when they are not, or vice versa. Vestibular information can disambiguate self motion from motion of the adjacent train.</em></p>
<p><strong>B. What is the key scientific question?</strong> Clearly articulate the question which your model tries to answer.</p>
<p><em>However, it is unknown if accumulated, noisy vestibular neuron activity correlates with self-motion judgement.</em></p>
<p><strong>C. What was our hypothesis?</strong> Explain the key relationships which we relied on to simulate the phenomena.</p>
<p><em>Based on previous modeling efforts, we hypothesized that cumulative spike counts (not instantaneous) recorded from vestibular neurons can better discriminate experienced self motion judgements as opposed to true self motion.</em></p>
<p><strong>D. How did your model work?</strong> Give an overview of the model, it’s main components, and how the model works. “Here we …”</p>
<p><em>Here we use logistic regression to classify both true self motion and experienced self motion judgements from vestibular neuron activity. This was done both with the vestibular signal accumulated across the full trial and with a 100 ms window (‘instantaneous’) around peak acceleration, and with 2 different speeds compared to a no-motion condition.</em></p>
<p><strong>E. What did we find?</strong> Did the model work? Explain the key outcomes of your model evaluation.</p>
<p><em>Decoding performance for accumulated vestibular signals was higher than for instantaneous signals. Further, experienced self motion judgements could be classified better than true self motion.</em></p>
<p><strong>F. What can we conclude?</strong> Conclude as much as you can with reference to the hypothesis, within the limits of the model.</p>
<p><em>We conclude that accumulated, noisy vestibular signals during slowly-accelerating self motion may drive the train illusion.</em></p>
<p><strong>G. What are the limitations and future directions?</strong> What is left to be learned? Briefly argue the plausibility of the approach and/or what you think is essential that may have been left out.</p>
<p><em>Future research should examine how visual signals may combine with vestibular signals in real-world scenarios to causally link these sensory signals to self-motion experience and illusions.</em></p>
<p>If we put this all in one paragraph, we have our final complete abstract. But, first, do not include the letters in <em>your</em> abstract, and second, we did paraphrase the answers a little so they fit together.</p>
</div>
<div class="section" id="abstract">
<h1>Abstract<a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h1>
<p>(A) When sitting in a stationary train and seeing the train next to them move, people may experience the “train illusion”: they feel like they are moving when they are not, or vice versa. Vestibular information can disambiguate self motion from motion of the adjacent train. (B) However, it is unknown if accumulated, noisy vestibular neuron activity correlates with self-motion judgement. (C) Based on previous modeling efforts, we hypothesized that cumulative spike counts (not instantaneous) recorded from vestibular neurons can better discriminate experienced self motion judgements as opposed to true self motion. (D) Here we use logistic regression to classify both true self motion and experienced self motion judgements from vestibular neuron activity. This was done both with the vestibular signal accumulated across the full trial and with a 100 ms window (‘instantaneous’) around peak acceleration, and with 2 different speeds compared to a no-motion condition. (E) Decoding performance for accumulated vestibular signals was higher than for instantaneous signals. Further, experienced self motion judgements could be classified better than true self motion. (F) We conclude that accumulated, noisy vestibular signals during slowly-accelerating self motion may drive the train illusion. (G) Future research should model possible mechanisms by which visual signals may combine with vestibular signals to causally link these sensory signals to self-motion experience and illusions.</p>
</div>
<hr class="docutils" />
<div class="section" id="final-thoughts">
<h1>Final thoughts<a class="headerlink" href="#final-thoughts" title="Permalink to this headline">¶</a></h1>
<p>Note that the analysis pipeline we built here was extremely simple and we used artificial data on purpose. It allowed us to go through all the steps of building a data neuroscience project, and hopefully you noticed that it is not always a linear process, you will go back to different steps if you hit a roadblock somewhere.</p>
<p>There are many issues that we did not address, e.g.:</p>
<ul class="simple">
<li><p>we could have tried different decoders</p></li>
<li><p>or find the optimal window</p></li>
<li><p>what if we had more data…</p></li>
<li><p>how do different neurons contribute to the decision? And why?</p>
<ul>
<li><p>this is something that you want to explore as a neuroscientist</p></li>
</ul>
</li>
<li><p>we could have run a GLM on the neurons*time array and then analyze the weightings to see if all acceleration steps are weighted equally (perfect integration)… or not?</p></li>
<li><p>what is the role of visual motion in this phenomenon?</p></li>
</ul>
<p>However, this project is not meant to be complete, and yours doesn’t have to be either. The goal of the projects is to go through <em>the process</em> of a modeling or data science project and put into practice one or more of the toolkits you learn at NMA with your group.</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./projects/modelingsteps"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="TrainIllusionModel.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Example Model Project: the Train Illusion</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../docs/datasets_overview.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Datasets</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Neuromatch<br/>
  
      &copy; Copyright 2021.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>